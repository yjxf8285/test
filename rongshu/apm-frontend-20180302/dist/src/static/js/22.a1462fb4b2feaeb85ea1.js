/*! 2018-3-2 author:liuxiaofan */
webpackJsonp([22],{587:function(e,t,a){a(862);var r=a(54)(a(797),a(912),"data-v-4e7be2bd",null);e.exports=r.exports},608:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{chartColors:["#a8d96f","#85cae6","#fab421","#f38211","#49a778","#e66a3e","#9d6858","#83bc1c","#4d6e83","#bac1c8"]}},created:function(){$(window).on("resize",this.change)},destroyed:function(){$(window).off("resize",this.change)},methods:{change:function(){this.chart&&this.chart.resize()}}}},610:function(e,t,a){a(614);var r=a(54)(a(611),a(615),"data-v-79cbf3c8",null);e.exports=r.exports},611:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{headerHeight:50}},props:{showBorder:{required:!1,default:!1},showHeader:{required:!1,default:!1},title:{default:""},isEmpty:{default:!0},isLoading:{default:!1},height:{default:350,required:!1}}}},613:function(e,t,a){t=e.exports=a(566)(),t.push([e.i,".chart-container[data-v-79cbf3c8]{position:relative;border:0 solid;margin-bottom:16px;border-radius:2px;width:100%;height:100%}.chart-title[data-v-79cbf3c8]{width:100%;padding:0 16px;box-sizing:border-box;font-size:14px;color:#666!important}.chart-title .title-icon[data-v-79cbf3c8]{font-size:18px;margin-right:12px}.chart-placeholder[data-v-79cbf3c8]{position:relative;z-index:1;width:100%;height:100%;text-align:center}.chart-placeholder span[data-v-79cbf3c8]{position:absolute;top:50%;margin-top:-7px}.chart-header-hide[data-v-79cbf3c8]{display:none}.chart-border-hide[data-v-79cbf3c8]{border:0}",""])},614:function(e,t,a){var r=a(613);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(567)("a7f96c48",r,!0)},615:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"chart-container theme-backgroung-color-white theme-border-color-base",class:{"chart-border-hide":!e.showBorder},style:{height:e.height+"px"}},[a("div",{staticClass:"chart-title theme-font-color-base theme-background-color-normal",class:{"chart-header-hide":!e.showHeader},style:{height:e.headerHeight+"px",lineHeight:e.headerHeight+"px"}},[a("i",{staticClass:"title-icon icon ion-podium"}),e._v("\n    "+e._s(e.title)+"\n  ")]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isEmpty&&!e.isLoading,expression:"isEmpty && !isLoading"}],staticClass:"chart-placeholder theme-background-color-normal-1",style:{height:(e.showHeader?e.height-e.headerHeight:e.height)+"px"}},[a("span",{staticClass:"theme-font-color-weaken"},[e._v("暂无数据")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isEmpty,expression:"!isEmpty"}],staticClass:"chart-content",style:{height:(e.showHeader?e.height-e.headerHeight:e.height)+"px"}},[e._t("default")],2)])},staticRenderFns:[]}},628:function(e,t,a){a(638);var r=a(54)(a(636),a(643),null,null);e.exports=r.exports},636:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(35);t.default={components:{"el-tree":r.Tree},props:{datas:{type:Array,required:!0}},watch:{datas:{deep:!0,handler:function(e){this.formatData(e)}}},data:function(){return{processedData:[]}},mounted:function(){},methods:{toLinearData:function(e){var t=e||[],a=[],r=[];return function e(t){t.map(function(t){a.push(t.value),r.push(t.agentName),e(t.child)})}(t),t.timeArr=a,t.nameArr=r,t},keyRename:function(e){var t=e||[];return function e(t){t.map(function(t){t.label=t.name,t.children=t.child,e(t.child)})}(t),t},formatData:function(e){var t=this,a=[];e.map(function(e,r){var n=t.keyRename([e]),i=t.toLinearData([e]);a.push({trees:n,values:i.timeArr,names:i.nameArr})}),this.processedData=a}}}},637:function(e,t,a){t=e.exports=a(566)(),t.push([e.i,'.table-tree{max-height:350px;overflow-y:auto}.table-tree th{border:1px solid #dfe9ec;background:#eef3f6;height:40px;padding:0 18px}.table-tree td{padding:20px;border:1px solid #dfe9ec}.table-tree li{line-height:36px;height:36px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.table-tree .el-tree{border:none}.table-tree .el-tree-node__content{cursor:inherit}.table-tree .el-tree-node__content:hover{background:none}.table-tree .el-tree-node__label{max-width:700px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.table-tree .el-tree-node__label:before{content:" ";float:left;margin-top:14px;margin-right:5px;width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:10px solid #97a8be}.table-tree .el-tree-node__expand-icon{display:none}',""])},638:function(e,t,a){var r=a(637);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(567)("48293184",r,!0)},643:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table-tree"},[a("table",{staticClass:"mt20",attrs:{width:"100%"}},[e._m(0),e._v(" "),a("tbody",e._l(e.processedData,function(t,r){return a("tr",{key:r},[a("td",[a("el-tree",{attrs:{data:t.trees,"default-expand-all":!0,"expand-on-click-node":!1}})],1),e._v(" "),a("td",[a("ul",e._l(t.values,function(t,r){return a("li",{key:r},[e._v(e._s(t))])}))]),e._v(" "),a("td",[a("ul",e._l(t.names,function(t,r){return a("li",{key:r},[e._v(e._s(t))])}))])])}))])])},staticRenderFns:[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",[a("tr",[a("th",{attrs:{width:"50%"}},[e._v("方法名")]),e._v(" "),a("th",{attrs:{width:"25%"}},[e._v("执行时间(ms)")]),e._v(" "),a("th",{attrs:{width:"25%"}},[e._v("实例名")])])])}]}},750:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(91),i=r(n),o=a(140),s=r(o),l=a(608),c=r(l),d=a(610),p=r(d);t.default={name:"tn-bar",mixins:[c.default],components:{chartContainer:p.default},props:{loading:!1,queryData:{},data:{type:Array,required:!0},title:{required:!0},options:Object,link:{required:!0},isAutoHeight:!1,from:String},data:function(){return{chart:null,noData:!0,cid:"cm",formatNamesMap:{}}},mounted:function(){this.initCharts(),this.setChart()},watch:{data:{deep:!0,handler:function(e){this.setChart()}},loading:function(e){e?this.chart.showLoading({color:"#cccccc",text:" "}):this.chart.hideLoading()}},methods:{initCharts:function(){var e=this;e.chart=echarts.init(e.$refs.chart),e.chart.on("click",function(t){e.$router.push({name:e.link,query:(0,i.default)({},e.$route.query,{queryStr:e.formatNamesMap[t.dataIndex].name},e.queryData)})})},setChart:function(){var e=this,t=e.data,a=[],r=[],n=[],o=[],l=[],c=[];if(_.isEmpty(t))e.noData=!0;else{e.noData=!1,t.map(function(i,s){var d=i.name.replace(/[\n\r]/g," ").replace(/\s+/g," ").substring(0,60);d=i.name.length>=60?d+"...":d,a.push(i.name),c.push(d),e.formatNamesMap[t.length-s-1]=i,r.push(i.max),n.push(i.min),o.push(i.avg),l.push(i.count)});for(var d=0;d<5;d++);var p={color:["#aed5f2"],tooltip:{trigger:"axis",axisPointer:{lineStyle:{opacity:0}},confine:!0,formatter:function(t,a,r){var n="";return t.map(function(t){var a=e.formatNamesMap[t.dataIndex];if(a){var r=a.max,i=a.min,o=a.avg,l=a.count,c=r?window.$$apm.locale.max+": "+r+"ms<br/>":"",d=i?window.$$apm.locale.min+": "+i+"ms<br/>":"",p=o?window.$$apm.locale.avg+": "+s.default.toDecimal(o,3)+"ms<br/>":"",f=l?window.$$apm.locale.count+": "+l+"<br/>":"";n+=c+d+p+f}}),n}},xAxis:{show:!0,type:"log",name:"",axisLabel:{show:!1}},yAxis:{show:!0,type:"category",data:c.reverse(),axisLabel:{show:!1}},series:[{name:"平均",type:"bar",barMaxWidth:c.length<=5?20*c.length+"%":"100%",barMinHeight:15,barCategoryGap:"30%",itemStyle:{},label:{normal:{show:!0,textStyle:{color:"#333"},position:"insideLeft",formatter:function(e,t,a){return e.name},offset:[0,-2]}},data:o.reverse()}]},f=(0,i.default)(p,this.options);this.chart.setOption((0,i.default)({},f),!0)}}}}},760:function(e,t,a){t=e.exports=a(566)(),t.push([e.i,".chart[data-v-72d1fadb],.topn-bar[data-v-72d1fadb]{height:100%}",""])},765:function(e,t,a){var r=a(760);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(567)("708e7f7e",r,!0)},770:function(e,t,a){a(765);var r=a(54)(a(750),a(775),"data-v-72d1fadb",null);e.exports=r.exports},775:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"topn-bar"},[a("chart-container",{attrs:{title:e.title,isLoading:e.loading,isEmpty:e.noData,isBig:!1,isAutoHeight:e.isAutoHeight}},[a("div",{ref:"chart",staticClass:"chart"})])],1)},staticRenderFns:[]}},797:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(35),i=a(770),o=r(i),s=a(628),l=r(s);t.default={name:"app-database-tn-slow-detail",components:{"el-dropdown":n.Dropdown,"el-dropdown-menu":n.DropdownMenu,"el-dropdown-item":n.DropdownItem,"el-button":n.Button,"el-table":n.Table,"el-table-column":n.TableColumn,"el-tabs":n.Tabs,"el-tab-pane":n.TabPane,"el-tag":n.Tag,TnBar:o.default,tableTree:l.default},mounted:function(){var e=this;this.currentSy=this.$root.eventBus.getCurSystem(),this.$root.eventBus.$on("system-or-time-change",function(t){e.currentSy=t.curSystem})},data:function(){return{webAffair:[],webAffairLoading:{},webAffairPaginator:{currentPage:0,total:10,pageCount:0},pivotalWebAffair:[],pivotalWebAffairLoading:{},pivotalWebAffairPaginator:{currentPage:0,total:10,pageCount:0},dataBase:[],dataBaseLoading:{},dataBasePaginator:{currentPage:0,total:10,pageCount:0},currentSy:{},sys:[]}},watch:{currentSy:function(e){this.getWebAffair(e.id),this.getPivotalWebAffair(e.id),this.getDataBase(e.id)}},methods:{getWebAffair:function(e){var t=this,a=0,r=[],i=[],o="";this.api.getWebAffair({data:{systemId:e,page:t.webAffairPaginator.currentPage,size:t.webAffairPaginator.total},beforeSend:function(){t.webAffairLoading=n.Loading.service({target:t.$refs.webAffairContainer})},success:function(e){t.webAffairLoading.close(),0===e.code?e.data?(a=e.data.count,e.data.list.map(function(e,t){e.list.map(function(e,t){switch(e.name){case"one-month":o="一个月";break;case"fourteen-day":o="14天";break;case"seven-day":o="7天";break;case"yesterday":o="昨天"}i.push({avg:e.avg,error:e.error,max:e.max,name:o,rpm:e.tps})}),r.push({info:e.info,name:e.name,list:i}),i=[]})):(a=0,r=[]):(a=0,r=[],n.Message.error("获取数据失败！！！")),t.webAffairPaginator.pageCount=a,t.webAffair=r},error:function(){t.webAffairLoading.close(),n.Message.error("服务器错误！！！")}})},getPivotalWebAffair:function(e,t){var a=this,r=0,i=[],o=[],s="";this.api.getPivotalWebAffair({data:{systemId:e,page:a.pivotalWebAffairPaginator.currentPage,size:a.pivotalWebAffairPaginator.total},beforeSend:function(){t&&(a.pivotalWebAffairLoading=n.Loading.service({target:a.$refs.pivotalWebAffairContainer}))},success:function(e){t&&a.pivotalWebAffairContainer.close(),0===e.code?e.data?(r=e.data.count,e.data.list.map(function(e,t){e.list.map(function(e,t){switch(e.name){case"one-month":s="一个月";break;case"fourteen-day":s="14天";break;case"seven-day":s="7天";break;case"yesterday":s="昨天"}o.push({avg:e.avg,error:e.error,max:e.max,name:s,rpm:e.tps})}),i.push({info:e.info,name:e.name,list:o}),o=[]})):(r=0,i=[]):(n.Message.error("获取数据失败！！！"),r=0,i=[]),a.webAffairPaginator.pageCount=r,a.pivotalWebAffair=i},error:function(){t&&a.pivotalWebAffairContainer.close(),n.Message.error("服务器错误！！！")}})},getDataBase:function(e,t){var a=this,r=0,i=[],o=[],s="";this.api.getDataBase({data:{systemId:e,page:a.dataBasePaginator.currentPage,size:a.dataBasePaginator.total},beforeSend:function(){t&&(a.dataBaseLoading=n.Loading.service({target:a.$refs.dataBaseContainer}))},success:function(e){t&&a.dataBaseContainer.close(),0===e.code?e.data?(r=e.data.count,e.data.list.map(function(e,t){e.list.map(function(e,t){switch(e.name){case"one-month":s="一个月";break;case"fourteen-day":s="14天";break;case"seven-day":s="7天";break;case"yesterday":s="昨天"}o.push({avg:e.avg,error:e.error,max:e.max,name:s,rpm:e.tps})}),i.push({info:e.info,name:e.name,list:o}),o=[]})):(r=0,i=[]):(r=0,i=[],n.Message.error("获取数据失败！！！")),a.webAffairPaginator.pageCount=r,a.dataBase=i},error:function(){t&&a.dataBaseContainer.close(),n.Message.error("服务器错误！！！")}})}}}},828:function(e,t,a){t=e.exports=a(566)(),t.push([e.i,".report[data-v-4e7be2bd]{float:left;width:100%;height:100%;overflow-y:auto}.search-input-container[data-v-4e7be2bd]{display:inline-block;width:300px;margin-left:40px}.sql[data-v-4e7be2bd]{margin:20px 0 40px;padding:0 20px;font-size:14px;font-style:italic}.query-bar[data-v-4e7be2bd]{padding:8px 10px;box-shadow:1px 1px 5px #ccc;margin-bottom:20px}.sys-selector[data-v-4e7be2bd]{margin-right:20px}.table-container[data-v-4e7be2bd]{float:left;width:100%}.table-container .table-box[data-v-4e7be2bd]{float:left;width:100%;margin-top:20px}.table-container .table-box .name[data-v-4e7be2bd]{margin-top:0}.table-container .table-box .name .tag[data-v-4e7be2bd]{word-break:break-all;white-space:inherit;font-size:13px;line-height:19px;height:auto}.table-container .table-box .table[data-v-4e7be2bd]{width:100%;margin-top:20px}.table-container .table-box[data-v-4e7be2bd]:first-child{margin-top:0}.table-container .table-prompt[data-v-4e7be2bd]{width:100%;font-size:12px;padding:10px 0;text-align:center}.tag[data-v-4e7be2bd]{white-space:normal}.operation[data-v-4e7be2bd]{height:41px;border-bottom:1px solid;padding:0 10px;margin-bottom:10px;box-sizing:border-box;text-align:right}.tabs[data-v-4e7be2bd]{margin-bottom:10px}",""])},862:function(e,t,a){var r=a(828);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a(567)("67088718",r,!0)},912:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"report"},[a("div",{staticClass:"common-container"},[a("el-tabs",{staticClass:"tabs"},[a("el-tab-pane",{attrs:{label:"Web事务"}},[a("div",{staticClass:"content",staticStyle:{"margin-top":"-15px"}},[a("div",{ref:"webAffairContainer",staticClass:"table-container"},[e._l(e.webAffair,function(t){return a("div",{key:t.name,staticClass:"table-box"},[a("h4",{staticClass:"name"},[a("el-tag",{staticClass:"tag"},[e._v(e._s(t.name))])],1),e._v(" "),a("el-table",{staticClass:"table",attrs:{data:t.list,stripe:""}},[a("el-table-column",{attrs:{prop:"name",label:"时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"avg",label:"平均响应时间(ms)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"max",label:"最长响应时间(ms)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"rpm",label:"吞吐量(rpm)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"error",label:"错误率"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.error))]),e._v("%\n\n                  ")]}}])})],1)],1)}),e._v(" "),0==e.webAffair.length?a("div",{staticClass:"table-prompt"},[e._v("暂无数据")]):e._e()],2)])]),e._v(" "),a("el-tab-pane",{attrs:{label:"关键Web事务"}},[a("div",{staticClass:"content",staticStyle:{"margin-top":"-15px"}},[a("div",{ref:"pivotalWebAffairContainer",staticClass:"table-container"},[e._l(e.pivotalWebAffair,function(t){return a("div",{key:t.name,staticClass:"table-box"},[a("h4",{staticClass:"name"},[a("el-tag",[e._v(e._s(t.name))])],1),e._v(" "),a("el-table",{staticClass:"table",attrs:{data:t.list,stripe:""}},[a("el-table-column",{attrs:{prop:"name",label:"时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"avg",label:"平均响应时间(ms)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"max",label:"最长响应时间(ms)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"rpm",label:"吞吐量(rpm)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"error",label:"错误率"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.error))]),e._v("%\n\n                  ")]}}])})],1)],1)}),e._v(" "),0==e.pivotalWebAffair.length?a("div",{staticClass:"table-prompt"},[e._v("暂无数据")]):e._e()],2)])]),e._v(" "),a("el-tab-pane",{attrs:{label:"数据库"}},[a("div",{staticClass:"content",staticStyle:{"margin-top":"-15px"}},[a("div",{ref:"dataBaseContainer",staticClass:"table-container"},[e._l(e.dataBase,function(t){return a("div",{key:t.name,staticClass:"table-box"},[a("h4",{staticClass:"name"},[a("el-tag",{staticClass:"tag"},[e._v(e._s(t.name))])],1),e._v(" "),a("el-table",{staticClass:"table",attrs:{data:t.list,stripe:""}},[a("el-table-column",{attrs:{prop:"name",label:"时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"avg",label:"平均响应时间(ms)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"max",label:"最长响应时间(ms)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"rpm",label:"吞吐量(rpm)"}}),e._v(" "),a("el-table-column",{attrs:{prop:"error",label:"错误率"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.error))]),e._v("%\n\n                  ")]}}])})],1)],1)}),e._v(" "),0==e.dataBase.length?a("div",{staticClass:"table-prompt"},[e._v("暂无数据")]):e._e()],2)])])],1)],1)])},staticRenderFns:[]}}});