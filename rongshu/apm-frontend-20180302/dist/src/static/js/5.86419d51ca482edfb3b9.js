/*! 2018-3-2 author:liuxiaofan */
webpackJsonp([5],{217:function(t,e,r){r(871);var a=r(54)(r(790),r(922),"data-v-74932f80",null);t.exports=a.exports},608:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{chartColors:["#a8d96f","#85cae6","#fab421","#f38211","#49a778","#e66a3e","#9d6858","#83bc1c","#4d6e83","#bac1c8"]}},created:function(){$(window).on("resize",this.change)},destroyed:function(){$(window).off("resize",this.change)},methods:{change:function(){this.chart&&this.chart.resize()}}}},609:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=r(140),i=function(t){return t&&t.__esModule?t:{default:t}}(a);e.default={data:function(){return{topBarQueryData:{}}},props:{},watch:{},computed:{appId:function(){return this.topBarQueryData.system.id},startTime:function(){return Number(this.topBarQueryData.time.startTime)},endTime:function(){return i.default.cutEndTime(Number(this.topBarQueryData.time.endTime))},aggrInterval:function(){return i.default.intervalToGranularity(this.endTime-this.startTime)},interval:function(){return""}},methods:{}}},659:function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=r(201),n=a(i),o=r(140),s=a(o),c=r(608),l=a(c);e.default={mixins:[l.default],props:{optionData:{type:Object,default:{}}},data:function(){return{defOption:{}}},computed:{noData:function(){return(0,n.default)(this.optionData).length<=0}},watch:{optionData:{deep:!0,handler:function(t){this.resetDefData(),this.renderChart()}}},mounted:function(){},methods:{resetDefData:function(){this.defOption={color:this.chartColors,legend:{orient:"vertical",x:"200",y:"middle",data:[],formatter:function(t){return t}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},series:[{name:"容忍度",type:"pie",radius:["50%","70%"],center:["40%","50%"],label:{normal:{show:!1,position:"center"},emphasis:{show:!1,textStyle:{fontSize:"30",fontWeight:"bold"}}},labelLine:{normal:{show:!1}},data:[]}]}},renderChart:function(){this.chart||(this.chart=echarts.init(this.$refs.chart)),this.chart.resize();var t=s.default.extend({},this.defOption,this.optionData);this.chart.setOption(t,!0),0===t.series[0].data.length&&this.chart.clear()}}}},672:function(t,e,r){e=t.exports=r(566)(),e.push([t.i,".chart[data-v-3ab9747e]{height:100%;display:flex;align-items:center;justify-content:center}",""])},674:function(t,e,r){var a=r(672);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);r(567)("2f744798",a,!0)},676:function(t,e,r){r(674);var a=r(54)(r(659),r(677),"data-v-3ab9747e",null);t.exports=a.exports},677:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"chart",staticClass:"chart"},[r("i",{staticClass:"el-icon-loading"})])},staticRenderFns:[]}},679:function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=r(201),n=a(i),o=r(140),s=a(o),c=r(608),l=a(c);e.default={name:"chart-area-graph",mixins:[l.default],props:{optionData:{type:Object,default:{}}},data:function(){return{defOption:{}}},computed:{noData:function(){return(0,n.default)(this.optionData).length<=0}},watch:{optionData:{deep:!0,handler:function(t){this.resetDefData(),this.renderChart()}}},methods:{resetDefData:function(){this.defOption={noDataLoadingOption:{text:"暂无数据",effect:"bubble",effectOption:{effect:{n:0}}},tooltip:{trigger:"axis"},color:{type:"radial",x:.5,y:.5,r:.5,colorStops:[{offset:0,color:"red"},{offset:1,color:"blue"}],globalCoord:!1},grid:{top:"5",left:"10",right:"15",bottom:"8",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value",splitLine:{show:!1}},series:[{name:"",type:"line",smooth:!0,sampling:"average",hoverAnimation:!0,itemStyle:{normal:{color:this.chartColors[0]}},areaStyle:{normal:{}},data:[]}]}},renderChart:function(){if(this.chart||(this.chart=echarts.init(this.$refs.chart)),this.noData)this.chart.clear();else{this.chart.resize();var t=s.default.extend(this.defOption,this.optionData);this.chart.setOption(t,!0)}}}}},700:function(t,e,r){e=t.exports=r(566)(),e.push([t.i,".chart[data-v-65382739]{height:100%;display:flex;align-items:center;justify-content:center}",""])},713:function(t,e,r){var a=r(700);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);r(567)("d97534de",a,!0)},718:function(t,e,r){r(713);var a=r(54)(r(679),r(729),"data-v-65382739",null);t.exports=a.exports},729:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"chart",staticClass:"chart"},[r("i",{staticClass:"el-icon-loading"})])},staticRenderFns:[]}},790:function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=r(146),n=a(i),o=r(140),s=a(o),c=r(718),l=a(c),d=r(676),u=a(d),h=r(35),f=r(609),p=a(f);e.default={name:"error",components:{ChartPie:u.default,ChartAreaGraph:l.default,"el-input":h.Input,"el-pagination":h.Pagination,"el-table":h.Table,"el-tooltip":h.Tooltip,"el-table-column":h.TableColumn,"el-button":h.Button},mixins:[p.default],mounted:function(){},data:function(){return{searchName:"",errListData:[],errListDataTotal:0,pageIndex:0,errorListloading:!0,sortField:"startTime",sortOrder:"desc",topNErrorOption:{},errorSectionsOption:{},errorSectionsOverview:{errorNum:0,errorPerMinute:0},topBarData:[],fiterBarData:[],filterListData:[]}},computed:{errorArray:function(){return this.fiterBarData.find(function(t){return"errorArray"===t.itemId})&&this.fiterBarData.find(function(t){return"errorArray"===t.itemId}).infoData.map(function(t){return t.value})||[]},instanceArray:function(){return this.fiterBarData.find(function(t){return"instanceArray"===t.itemId})&&this.fiterBarData.find(function(t){return"instanceArray"===t.itemId}).infoData.map(function(t){return t.value})||[]}},methods:{topbarChange:function(t){this.topBarQueryData=t,this.getErrorSummaryData(),this.getErrorListData(),this.getErrorSectionsData(),this.getErrorTopNData()},filterbarChange:function(t){this.fiterBarData=t,this.getErrorListData(),this.getErrorSectionsData(),this.getErrorTopNData()},handleSearchErrList:function(){this.getErrorListData()},goToNextPage:function(t,e){this.$root.eventBus.openTab({name:t,options:{traceId:t,appId:this.$root.eventBus.getCurSystem().id||"",queryStr:e}})},handleCurrentChange:function(t){this.pageIndex=t-1,this.getErrorListData()},sortChange:function(t){this.sortField=t.prop||"startTime","ascending"===t.order&&(this.sortOrder="asc"),"descending"===t.order&&(this.sortOrder="desc"),this.getErrorListData()},getErrorSummaryData:function(){var t=this;this.api.getErrorSummary({data:{condition:{startTime:this.startTime,endTime:this.endTime,appId:this.appId}}}).then(function(e){if(0===e.code){var r=e.data.errorArray.map(function(t){return{id:t,name:t}});t.filterListData=[{text:"错误类型",type:1,disable:!1,itemId:"errorArray",listData:r},{text:"实例",type:1,disable:!1,itemId:"instanceArray",listData:e.data.instanceArray}]}})},getErrorListData:function(){var t=this;this.errorListloading=!0,this.api.getErrorList({data:{condition:{startTime:this.startTime,endTime:this.endTime,appId:this.appId,searchKey:this.searchName,instanceArray:this.instanceArray,errorArray:this.errorArray},page:{index:this.pageIndex,size:10},sort:{field:this.sortField,order:this.sortOrder}}}).then(function(e){0===e.code&&(e.data.errorArray.map(function(t){t.startTime=s.default.formatDate(t.startTime)}),t.errListData=e.data.errorArray,t.errListDataTotal=e.data.totalSize)}).always(function(e){t.errorListloading=!1})},getErrorSectionsData:function(){var t=this;this.api.getErrorSections({data:{condition:{startTime:this.startTime,endTime:this.endTime,appId:this.appId,granularity:this.aggrInterval,instanceArray:this.instanceArray,errorArray:this.errorArray}}}).then(function(e){if(0===e.code){t.errorSectionsOverview={errorNum:e.data.overview.errorNum,errorPerMinute:e.data.overview.errorPerMinute};var r=e.data.sectionArray||[],a=r.map(function(t){return s.default.formatDate(t.startTime,2)}),i=r.map(function(t){return t.errorNum});t.errorSectionsOption={formatter:function(t,e,a){var i="";return t.map(function(t){var e=r[t.dataIndex];e&&(i="\n                      标题：错误<br>\n                      时间："+s.default.formatDate(e.startTime,2)+"<br>\n                      错误数："+e.errorNum+"<br>\n                      错误/分钟："+e.errorPerMinute+"<br>\n                      ")}),i},xAxis:{data:a},series:[{data:i}]}}})},getErrorTopNData:function(){var t=this;this.api.getErrorTopN({data:{condition:{startTime:this.startTime,endTime:this.endTime,appId:this.appId,instanceArray:this.instanceArray,errorArray:this.errorArray},topN:5}}).then(function(e){if(0===e.code){var r=[];r=e.data.otherError>0?[].concat((0,n.default)(e.data.topNErrorArray),[{num:e.data.otherError,name:"其他"}]):e.data.topNErrorArray,t.topNErrorOption={legend:{orient:"vertical",x:"340",y:"middle",data:r.map(function(t){return t.name}),formatter:function(t){return t}},series:[{name:"错误信息",data:r.map(function(t){return{value:t.num,name:t.name}})}]}}})}}}},837:function(t,e,r){e=t.exports=r(566)(),e.push([t.i,".error .multiple[data-v-74932f80]{display:flex}.error .multiple .l[data-v-74932f80]{flex:1}.error .multiple .r[data-v-74932f80]{width:540px}.error .multiple .r .content[data-v-74932f80]{border-left:1px solid #dcdcdc}.error .search-input[data-v-74932f80]{float:right;width:200px;margin:11px}.error .chart-wrap[data-v-74932f80]{height:300px}",""])},871:function(t,e,r){var a=r(837);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);r(567)("2e86e886",a,!0)},922:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"error"},[r("top-bar",{attrs:{title:"错误"},on:{barChange:t.topbarChange}}),t._v(" "),r("FilterBarComplex",{staticStyle:{"margin-top":"1px"},attrs:{filterList:t.filterListData},on:{fbarChange:t.filterbarChange}}),t._v(" "),r("div",{staticClass:"common-container multiple"},[r("div",{staticClass:"l"},[r("div",{staticClass:"header-title"},[r("i",{staticClass:"title-icon icon ion-podium"}),t._v(" "),r("span",{staticClass:"title-name"},[t._v("错误数趋势")]),t._v(" "),r("div",{staticClass:"right-info"},[r("span",[t._v(t._s(t.errorSectionsOverview.errorNum)+" 次")]),t._v(" "),r("span",[t._v(t._s(t.errorSectionsOverview.errorPerMinute)+" 错误/分钟")])])]),t._v(" "),r("div",{staticClass:"content"},[r("div",{staticClass:"chart-wrap"},[r("ChartAreaGraph",{attrs:{optionData:t.errorSectionsOption}})],1)])]),t._v(" "),r("div",{staticClass:"r"},[t._m(0),t._v(" "),r("div",{staticClass:"content"},[r("div",{staticClass:"chart-wrap"},[r("ChartPie",{attrs:{optionData:t.topNErrorOption}})],1)])])]),t._v(" "),r("div",{staticClass:"common-container"},[r("div",{staticClass:"header-title"},[r("i",{staticClass:"title-icon icon ion-stats-bars"}),t._v(" "),r("span",{staticClass:"title-name"},[t._v("错误列表")]),t._v(" "),r("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入名称",size:"small"},on:{change:t.handleSearchErrList},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}})],1),t._v(" "),r("div",{staticClass:"content"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.errorListloading,expression:"errorListloading"}],attrs:{data:t.errListData},on:{"sort-change":t.sortChange}},[r("el-table-column",{attrs:{prop:"name",label:"事务"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("a",{staticClass:"theme-font-color-primary",attrs:{href:"javascript:void(0);"},on:{click:function(r){t.goToNextPage(e.row.traceId,e.row.name)}}},[t._v(t._s(e.row.name))])]}}])}),t._v(" "),r("el-table-column",{attrs:{prop:"startTime",label:"发生时间",sortable:"custom"}}),t._v(" "),r("el-table-column",{attrs:{prop:"errorName",label:"错误类型"}}),t._v(" "),r("el-table-column",{attrs:{prop:"tierName",label:"Tier"}}),t._v(" "),r("el-table-column",{attrs:{prop:"instance",label:"实例"}})],1),t._v(" "),r("div",{staticClass:"pag-wrap"},[r("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":10,total:t.errListDataTotal},on:{"current-change":t.handleCurrentChange}})],1)],1)])],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"header-title",staticStyle:{"border-left":"solid 1px #dcdcdc"}},[r("i",{staticClass:"title-icon icon ion-document-text"}),t._v(" "),r("span",{staticClass:"title-name"},[t._v("错误信息（TOP 5）")])])}]}}});