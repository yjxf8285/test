/*! 2018-3-2 author:liuxiaofan */
webpackJsonp([40],{604:function(e,t,a){a(878);var i=a(54)(a(813),a(932),"data-v-c40abd24",null);e.exports=i.exports},813:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(91),r=function(e){return e&&e.__esModule?e:{default:e}}(i),o=a(35),n=a(202);t.default={name:"tier-list",components:{"el-button":o.Button,"el-table":o.Table,"el-table-column":o.TableColumn,"el-input":o.Input,"el-radio-group":o.RadioGroup,"el-radio":o.Radio,"el-form":o.Form,"el-form-item":o.FormItem,"el-dialog":o.Dialog,"el-pagination":o.Pagination,"el-breadcrumb":o.Breadcrumb,"el-breadcrumb-item":o.BreadcrumbItem},mounted:function(){this.getTierTypes(),this.getTierList(),this.searchName=this.$route.query.tierFilterName},data:function(){return{currTier:{},originTierList:[],searchName:"",createDialogVisible:!1,createForm:{name:"",tierType:1,TierTypes:[],description:""},creatingLoading:!1,createRules:{name:[{required:!0,message:"请输入Tier名称",trigger:"blur"},{max:80,message:"Tier名称不能超过80个字符",trigger:"blur"},{validator:n.nameValidator,trigger:"blur"}]},downloadDialogVisible:!1}},computed:{tierList:function(){var e=this;return this.originTierList.filter(function(t){return"__browser__"!==t.name&&(!e.searchName||-1!==t.name.indexOf(e.searchName))})}},watch:{searchName:function(e){e&&this.$router.push({query:(0,r.default)({},this.$route.query,{applicationFilterName:this.searchName})})}},methods:{create:function(){var e=this,t=this;t.$refs.createForm.validate(function(a){a&&t.api.createTier({data:(0,r.default)({applicationId:t.$route.query.applicationId,tier_type:e.createForm.tierType},t.createForm),beforeSend:function(){t.creatingLoading=!0},complete:function(){t.creatingLoading=!1},success:function(e){t.createDialogVisible=!1,0===e.code?((0,o.Notification)({title:"创建成功",type:"success"}),t.getTierList(),t.createForm.name="",t.createForm.description=""):(0,o.Notification)({title:"创建失败",message:e.message,type:"error"})}})})},getTierTypes:function(){var e=this;this.api.getTierType().then(function(t){0===t.code&&(e.createForm.TierTypes=t.data)})},getTierList:function(){var e=this,t=null;e.api.getTierListByApplicationId({data:{applicationId:e.$route.query.applicationId},beforeSend:function(){t=o.Loading.service({target:e.$refs.tableContainer})},complete:function(){t.close(),t=null},success:function(t){0===t.code&&(e.originTierList=t.data)}})},downloadInstance:function(e){window.open(window.$$apm.outerRemoteHost+"/agent/downloadAgent?applicationId="+this.$route.query.applicationId+"&tierId="+e.id+"&type="+e.tierType)}}}},844:function(e,t,a){t=e.exports=a(566)(),t.push([e.i,".search-input[data-v-c40abd24]{position:relative;width:250px}.paginator[data-v-c40abd24]{margin-top:10px;text-align:right}.downloadUrls[data-v-c40abd24]{text-align:center}.breadcrumb[data-v-c40abd24]{display:inline-block;position:relative;bottom:-7px}.right-info[data-v-c40abd24]{margin-top:10px}",""])},878:function(e,t,a){var i=a(844);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a(567)("153c2bbc",i,!0)},932:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"common-container"},[a("div",{staticClass:"header-title"},[a("span",{staticClass:"title-name"},[a("el-breadcrumb",{staticClass:"breadcrumb"},[a("el-breadcrumb-item",{attrs:{to:{name:"settings-app-list",query:{applicationFilterName:e.$route.query.applicationFilterName}}}},[a("span",[e._v(e._s(e.$route.query.applicationName))])]),e._v(" "),a("el-breadcrumb-item",[e._v("tier列表")])],1)],1),e._v(" "),a("div",{staticClass:"right-info"},[a("div",{staticClass:"theme-border-color-base"},[a("el-button",{staticClass:"add-btn",attrs:{icon:"ion-plus-round",type:"primary",size:"small"},on:{click:function(t){e.createDialogVisible=!0}}}),e._v(" "),a("el-input",{staticClass:"search-input",attrs:{placeholder:"请输入Tier名称","prefix-icon":"el-icon-search",size:"small"},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}})],1)])]),e._v(" "),a("div",{staticClass:"tier-list content"},[a("div",{ref:"tableContainer"},[a("el-table",{staticClass:"list-table",staticStyle:{width:"100%"},attrs:{data:e.tierList}},[a("el-table-column",{attrs:{label:"Tier"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("router-link",{staticClass:"theme-font-color-primary",attrs:{to:{name:"settings-instance-list",query:Object.assign({},{tierId:t.row.id,tierType:t.row.tierType,tierName:t.row.name,tierFilterName:e.searchName},e.$route.query)}}},[a("span",[e._v(e._s(t.row.name))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"tierTypeName",label:"类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"instanceTotal",label:"实例数量"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){e.downloadInstance(t.row)}}},[e._v("下载新探针")])]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加Tier",visible:e.createDialogVisible},on:{"update:visible":function(t){e.createDialogVisible=t}}},[a("el-form",{ref:"createForm",attrs:{model:e.createForm,rules:e.createRules}},[a("el-form-item",{attrs:{label:"名称",prop:"name"}},[a("el-input",{model:{value:e.createForm.name,callback:function(t){e.$set(e.createForm,"name",t)},expression:"createForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型"}},[a("el-radio-group",{model:{value:e.createForm.tierType,callback:function(t){e.$set(e.createForm,"tierType",t)},expression:"createForm.tierType"}},e._l(e.createForm.TierTypes,function(t,i){return a("el-radio",{key:i,attrs:{label:t.type}},[e._v(e._s(t.name)+"\n              ")])}))],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{prop:"description",maxlength:80},model:{value:e.createForm.description,callback:function(t){e.$set(e.createForm,"description",t)},expression:"createForm.description"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.createDialogVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.creatingLoading},on:{click:e.create}},[e._v("确定")])],1)],1)],1)])},staticRenderFns:[]}}});