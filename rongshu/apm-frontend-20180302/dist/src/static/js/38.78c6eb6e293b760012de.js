/*! 2018-3-2 author:liuxiaofan */
webpackJsonp([38],{589:function(t,e,a){a(861);var i=a(54)(a(798),a(911),"data-v-42a52798",null);t.exports=i.exports},609:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(140),n=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default={data:function(){return{topBarQueryData:{}}},props:{},watch:{},computed:{appId:function(){return this.topBarQueryData.system.id},startTime:function(){return Number(this.topBarQueryData.time.startTime)},endTime:function(){return n.default.cutEndTime(Number(this.topBarQueryData.time.endTime))},aggrInterval:function(){return n.default.intervalToGranularity(this.endTime-this.startTime)},interval:function(){return""}},methods:{}}},798:function(t,e,a){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=a(91),r=i(n),o=a(35),s=a(609),l=i(s);e.default={name:"threaddump",components:{"el-table":o.Table,"el-table-column":o.TableColumn,"el-button":o.Button,"el-slider":o.Slider,"el-pagination":o.Pagination,"el-switch":o.Switch},mixins:[l.default],data:function(){return{sysLoading:!1,isFirst:!0,reports:[],intervalNum:1,autoRefresh:!0,paginator:{currentPage:1,total:0,pageCount:10}}},computed:{instanceId:function(){return this.$route.query.instanceToken||""}},methods:{barChange:function(t){this.topBarQueryData=t,this.queryData={appId:this.appId,startTime:this.startTime,endTime:this.endTime,aggrInterval:this.aggrInterval},this.getThreaddumpList()},startAnalysis:function(){var t=this;t.instanceId&&t.api.startAnalysis({data:{condition:{appId:t.appId,interval:t.intervalNum}},success:function(e){e.success?((0,o.Notification)({title:"操作成功",type:"success"}),t.getThreaddumpList()):(0,o.Notification)({title:"操作失败",message:e.message,type:"error"})}})},getThreaddumpList:function(){var t=this,e=null;String(t.appId)&&t.api.getThreaddumpList({data:{condition:this.queryData,page:{index:t.paginator.currentPage-1,size:t.paginator.pageCount}},beforeSend:function(){e=o.Loading.service({target:t.$refs.reportListContainer})},complete:function(){e.close()}}).done(function(e){e.success&&(t.reports=e.data.page_data,t.paginator.total=e.data.total_count)})},intervalFormatter:function(t,e,a){return t.interval/6e4},handleView:function(t,e){this.$router.push({name:"tier-threaddump-report",query:(0,r.default)({},this.$route.query,{condition:(0,r.default)({},this.queryData,{id:e.id,agent_name:e.agent_name||"",start_time:e.start_time||"",interval:e.intervalNum||""})})})},handleCancel:function(t,e){var a=this;a.api.cancelAnalysis({data:{condition:{id:e.id}},success:function(t){0===t.code?((0,o.Notification)({title:"操作成功",type:"success"}),a.getThreaddumpList()):(0,o.Notification)({title:"操作失败，请稍后重试",message:t.message,type:"error"})}})},handleDelete:function(t,e){var a=this;a.api.deleteAnalysis({data:{condition:{id:e.id}},success:function(t){0===t.code?((0,o.Notification)({title:"操作成功",type:"success"}),a.getThreaddumpList()):(0,o.Notification)({title:"操作失败，请稍后重试",message:t.message,type:"error"})}})},togglePage:function(t){this.paginator.currentPage=t,this.getThreaddumpList()}}}},827:function(t,e,a){e=t.exports=a(566)(),e.push([t.i,".threaddump .table-title[data-v-42a52798]{padding-bottom:10px;margin-top:30px;border-bottom:1px solid;font-size:16px;font-weight:400}.threaddump .dump-bar[data-v-42a52798]{height:52px;padding:24px;box-sizing:border-box;text-align:left}.threaddump .sys-selector[data-v-42a52798]{margin-right:20px}.threaddump .duration-container[data-v-42a52798]{margin:0 10px;display:inline-block;width:200px}.threaddump .label[data-v-42a52798]{position:relative;top:-14px}.threaddump .auto-container[data-v-42a52798]{position:relative;display:inline-block;margin-left:15px;top:-14px}.threaddump .pos-fix[data-v-42a52798]{position:relative;top:-14px}.threaddump .pagination[data-v-42a52798]{float:right;margin-top:5px}.threaddump .refresh-button[data-v-42a52798]{margin-left:15px}.threaddump .instance-list[data-v-42a52798]{max-height:400px;overflow-y:auto}",""])},861:function(t,e,a){var i=a(827);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(567)("c613e072",i,!0)},911:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"threaddump"},[a("top-bar",{on:{barChange:t.barChange}}),t._v(" "),a("div",{staticClass:"common-container"},[a("div",{staticClass:"dump-bar"},[a("span",{staticClass:"label"},[t._v("剖析时长：")]),t._v(" "),a("div",{staticClass:"duration-container"},[a("el-slider",{attrs:{step:1,min:1,max:10,"format-tooltip":function(t){return t+"分钟"},"show-stops":""},model:{value:t.intervalNum,callback:function(e){t.intervalNum=e},expression:"intervalNum"}})],1),t._v(" "),a("el-button",{staticClass:"pos-fix",attrs:{type:"primary",size:"small",disabled:!t.instanceId},on:{click:t.startAnalysis}},[t._v("开始剖析")])],1),t._v(" "),a("div",{ref:"reportListContainer",staticClass:"content",staticStyle:{position:"relative"}},[a("el-table",{attrs:{data:t.reports,stripe:""}},[a("el-table-column",{attrs:{prop:"submit_time",label:"提交时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"agent_name",label:"实例"}}),t._v(" "),a("el-table-column",{attrs:{prop:"intervalNum",formatter:t.intervalFormatter,label:"剖析时长(min)"}}),t._v(" "),a("el-table-column",{attrs:{prop:"status_name",label:"状态"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.status<=1?a("el-button",{attrs:{size:"small"},on:{click:function(a){t.handleCancel(e.$index,e.row)}}},[t._v("取消")]):t._e(),t._v(" "),e.row.status>=2?a("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(a){t.handleDelete(e.$index,e.row)}}},[t._v("删除")]):t._e(),t._v(" "),2==e.row.status?a("el-button",{attrs:{size:"small"},on:{click:function(a){t.handleView(e.$index,e.row)}}},[t._v("查看报告")]):t._e()]}}])})],1),t._v(" "),a("div",{staticClass:"pag-wrap"},[a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.paginator.total>0,expression:"paginator.total > 0"}],attrs:{layout:"total, prev, pager, next","page-size":t.paginator.pageSize,"current-page":t.paginator.currentPage,total:t.paginator.total},on:{"current-change":t.togglePage}})],1)],1)])],1)},staticRenderFns:[]}}});