/*! 2018-3-2 author:liuxiaofan */
webpackJsonp([3],{213:function(t,e,a){a(872);var i=a(54)(a(787),a(923),"data-v-75acb281",null);t.exports=i.exports},608:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{chartColors:["#a8d96f","#85cae6","#fab421","#f38211","#49a778","#e66a3e","#9d6858","#83bc1c","#4d6e83","#bac1c8"]}},created:function(){$(window).on("resize",this.change)},destroyed:function(){$(window).off("resize",this.change)},methods:{change:function(){this.chart&&this.chart.resize()}}}},609:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(140),r=function(t){return t&&t.__esModule?t:{default:t}}(i);e.default={data:function(){return{topBarQueryData:{}}},props:{},watch:{},computed:{appId:function(){return this.topBarQueryData.system.id},startTime:function(){return Number(this.topBarQueryData.time.startTime)},endTime:function(){return r.default.cutEndTime(Number(this.topBarQueryData.time.endTime))},aggrInterval:function(){return r.default.intervalToGranularity(this.endTime-this.startTime)},interval:function(){return""}},methods:{}}},616:function(t,e,a){a(623);var i=a(54)(a(619),a(629),"data-v-2a8bfc5e",null);t.exports=i.exports},617:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"node-link",data:function(){return{$link:null,sangle:0,tangle:0,length:0,arrowLength:8,arrowHeight:4,arrowMargin:50,startArrowData:"",endArrowData:"",playArrowData:"",stopArrowData:"",playArrowP1:"",playArrowP2:"",playArrowP3:"",playTime:3e3}},props:{data:{default:function(){return{}}},change:0,showTextFlag:!0,play:!1,dragFlag:!1,radius:{default:35},innerRadius:23,attachmentRadius:15,update:0},watch:{update:function(t){this.destroy(),this.rerender()},change:function(t){this.rerender()},play:function(t){if(this.dragFlag)return void this.stopArrowAnimation();t?this.playArrowAnimation():this.stopArrowAnimation()},dragFlag:function(t){t&&this.stopArrowAnimation()}},methods:{render:function(){this.renderLink()},rerender:function(){this.render()},destroy:function(){this.$link&&$(this.$link[0][0]).children().remove(),this.$link=null,this.sangle=0,this.tangle=0,this.length=0},renderLink:function(){var t=this.data;if(this.$link||(this.$link=d3.select(this.$refs.g)),this.csource=this.getCircleCenter(t.source),this.ctarget=this.getCircleCenter(t.target),this.csource&&!this.csource.hide&&this.ctarget&&!this.ctarget.hide){this.sangle=this.calAngle(this.csource,this.ctarget),this.tangle=this.sangle+Math.PI,t.source.symbol?(this.csource.x+=this.radius/2*Math.cos(this.sangle),this.csource.y+=this.radius/2*Math.sin(this.sangle)):(this.csource.x+=this.radius*Math.cos(this.sangle),this.csource.y+=this.radius*Math.sin(this.sangle)),t.target.symbol?(this.ctarget.x+=this.radius/2*Math.cos(this.tangle),this.ctarget.y+=this.radius/2*Math.sin(this.tangle)):(this.ctarget.x+=this.radius*Math.cos(this.tangle),this.ctarget.y+=this.radius*Math.sin(this.tangle));var e=this.needBezer(),a=this.getNodeSpace();if(this.bezerX=1===e?(this.csource.x+this.ctarget.x)/2:this.csource.x-a*this.radius,this.bezerY=1===e?this.csource.y-a*this.radius:(this.csource.y+this.ctarget.y)/2,e&&!this.data.notNeedBezerFlag)this.$link.select("path.bezer").empty()?this.$link.append("path").attr("d","M"+this.csource.x+","+this.csource.y+" Q"+this.bezerX+","+this.bezerY+" "+this.ctarget.x+","+this.ctarget.y).attr("class","bezer"):$(this.$link.select("path.bezer")[0][0]).remove();else{this.$link.select("line").empty()?this.$link.append("line").attr("x1",this.csource.x).attr("y1",this.csource.y).attr("x2",this.ctarget.x).attr("y2",this.ctarget.y):this.$link.select("line").attr("x1",this.csource.x).attr("y1",this.csource.y).attr("x2",this.ctarget.x).attr("y2",this.ctarget.y);var i=this.$link.select("path.bezer");i.empty()||$(i[0][0]).remove()}"MQ"!==t.source.type&&"MQ"!==t.target.type||this.$link.classed("dash",!0),e&&!this.data.notNeedBezerFlag?this.drawBezerArrow(this.csource,this.ctarget,{x:this.bezerX,y:this.bezerY}):this.drawLineArrow(this.csource,this.ctarget);var r=this.$link.select("text.line-text"),s=this.$link.select("text.line-text .adsFlowMapTextShadow"),o=this.$link.select("text.line-text .real");r.empty()&&(r=this.$link.append("text").attr("class","line-text"),s=r.append("tspan").attr("class","adsFlowMapTextShadow").style("text-anchor","middle").text(this.data.label),o=r.append("tspan").attr("class","real").text(this.data.label));var n=(this.csource.x+this.ctarget.x)/2,h=(this.csource.y+this.ctarget.y)/2;if(e&&!this.data.notNeedBezerFlag){var l=this.getBeZerPoint(this.csource,this.ctarget,{x:this.bezerX,y:this.bezerY},.5);r&&(r.attr("x",l.x).attr("y",l.y),s.attr("x",l.x).attr("y",l.y),o.attr("x",l.x).attr("y",l.y))}else r&&(r.attr("x",n).attr("y",h+3),s.attr("x",n).attr("y",h+3),o.attr("x",n).attr("y",h+3)),this.csource.x,this.ctarget.x;this.showTextFlag?r&&r.classed("hide",!1):r&&r.classed("hide",!0)}},drawLineArrow:function(t,e){var a,i,r,s,o,n,h,l,d,c,u,p,f,g;t.x===e.x?(i={x:t.x,y:t.y<e.y?t.y+this.arrowMargin:t.y-this.arrowMargin},r={x:t.x,y:t.y<e.y?t.y+this.arrowMargin-this.arrowLength:t.y-this.arrowMargin+this.arrowLength},s={x:t.x+this.arrowHeight,y:r.y},o={x:t.x-this.arrowHeight,y:r.y},h={x:t.x,y:t.y<e.y?e.y-this.arrowMargin:e.y+this.arrowMargin},n={x:t.x,y:t.y<e.y?e.y-this.arrowMargin+this.arrowLength:e.y+this.arrowMargin-this.arrowLength},l={x:t.x+this.arrowHeight,y:h.y},d={x:t.x-this.arrowHeight,y:h.y},this.playArrowP1={x:t.x,y:t.y<e.y?t.y+this.arrowLength:t.y-this.arrowLength},c={x:t.x,y:t.y},this.playArrowP2={x:t.x+this.arrowHeight,y:c.y},this.playArrowP3={x:t.x-this.arrowHeight,y:c.y},u={x:e.x,y:e.y},p={x:e.x,y:t.y<e.y?e.y-this.arrowLength:e.y+this.arrowLength},f={x:e.x+this.arrowHeight,y:p.y},g={x:e.x-this.arrowHeight,y:p.y}):t.y===e.y?(i={x:t.x<e.x?t.x+this.arrowMargin:t.x-this.arrowMargin,y:t.y},r={x:t.x<e.x?t.x+this.arrowMargin-this.arrowLength:t.x-this.arrowMargin+this.arrowLength,y:t.y},s={x:r.x,y:t.y+this.arrowHeight},o={x:r.x,y:t.y-this.arrowHeight},n={x:t.x<e.x?e.x-this.arrowMargin+this.arrowLength:e.x+this.arrowMargin-this.arrowLength,y:e.y},h={x:t.x<e.x?e.x-this.arrowMargin:e.x+this.arrowMargin,y:e.y},l={x:h.x,y:e.y+this.arrowHeight},d={x:h.x,y:e.y-this.arrowHeight},this.playArrowP1={x:t.x<e.x?t.x+this.arrowLength:t.x-this.arrowLength,y:t.y},c={x:t.x,y:t.y},this.playArrowP2={x:c.x,y:t.y+this.arrowHeight},this.playArrowP3={x:c.x,y:t.y-this.arrowHeight},u={x:e.x,y:e.y},p={x:t.x<e.x?e.x-this.arrowLength:e.x+this.arrowLength,y:e.y},f={x:p.x,y:e.y+this.arrowHeight},g={x:p.x,y:e.y-this.arrowHeight}):(a=this.getlinek(t,e),i=this.getPointByLine(a,this.arrowMargin,t,t.x<e.x?1:-1),r=this.getPointByLine(a,this.arrowMargin-this.arrowLength,t,t.x<e.x?1:-1),s=this.getPointByLine(-1/a,this.arrowHeight,r,1),o=this.getPointByLine(-1/a,this.arrowHeight,r,-1),n=this.getPointByLine(a,-this.arrowMargin+this.arrowLength,e,t.x<e.x?1:-1),h=this.getPointByLine(a,-this.arrowMargin,e,t.x<e.x?1:-1),l=this.getPointByLine(-1/a,this.arrowHeight,h,1),d=this.getPointByLine(-1/a,this.arrowHeight,h,-1),this.playArrowP1=this.getPointByLine(a,this.arrowLength,t,t.x<e.x?1:-1),c={x:t.x,y:t.y},this.playArrowP2=this.getPointByLine(-1/a,this.arrowHeight,c,1),this.playArrowP3=this.getPointByLine(-1/a,this.arrowHeight,c,-1),u={x:e.x,y:e.y},p=this.getPointByLine(a,this.arrowLength,e,t.x<e.x?-1:1),f=this.getPointByLine(-1/a,this.arrowHeight,p,1),g=this.getPointByLine(-1/a,this.arrowHeight,p,-1)),this.createArrow(i,s,o,"startArrow"),this.createArrow(n,l,d,"endArrow"),this.createArrow(this.playArrowP1,this.playArrowP2,this.playArrowP3,"playArrow"),this.stopArrowData=this.getArrowData(u,f,g)},drawBezerArrow:function(t,e,a){var i=this.getBeZerLength(t,e,a),r=this.getBeZerPoint(t,e,a,this.arrowMargin/i),s=this.getBeZerPoint(t,e,a,(this.arrowMargin-this.arrowLength)/i),o=this.getlinek(s,r),n=this.getPointByLine(-1/o,this.arrowHeight,s,1),h=this.getPointByLine(-1/o,this.arrowHeight,s,-1),l=this.getBeZerPoint(t,e,a,(i-this.arrowMargin+this.arrowLength)/i),d=this.getBeZerPoint(t,e,a,(i-this.arrowMargin)/i),c=this.getlinek(d,l),u=this.getPointByLine(-1/c,this.arrowHeight,d,1),p=this.getPointByLine(-1/c,this.arrowHeight,d,-1);this.playArrowP1=this.getBeZerPoint(t,e,a,this.arrowLength/i);var f=t;this.playArrowP2=this.getPointByLine(-1/o,this.arrowHeight,f,1),this.playArrowP3=this.getPointByLine(-1/o,this.arrowHeight,f,-1),this.createArrow(r,n,h,"startArrow"),this.createArrow(l,u,p,"endArrow"),this.createArrow(this.playArrowP1,this.playArrowP2,this.playArrowP3,"playArrow")},getBezerArrowPoint:function(t,e,a,i){var r=this.getBeZerLength(t,e,a),s=this.getBeZerPoint(t,e,a,(i*r+this.arrowLength)/r),o=this.getBeZerPoint(t,e,a,i),n=this.getlinek(o,s);return[s,this.getPointByLine(-1/n,this.arrowHeight,o,1),this.getPointByLine(-1/n,this.arrowHeight,o,-1)]},createArrow:function(t,e,a,i){var r=this.$link.select("path.arrow."+i);return r.empty()&&(r=this.$link.append("path").attr("class","arrow "+i)),this[i+"Data"]=this.getArrowData(t,e,a),r.attr("d",this[i+"Data"]),r},getArrowData:function(t,e,a){return"M"+t.x+" "+t.y+" L"+e.x+" "+e.y+" L"+a.x+" "+a.y+" Z"},getlinek:function(t,e){return e.x!==t.x&&(e.y-t.y)/(e.x-t.x)},getPointByLine:function(t,e,a,i){return!1===t?{x:a.x,y:a.y-i*e}:{x:a.x+i*(e/Math.sqrt(Math.pow(t,2)+1)),y:a.y+i*(t*e/Math.sqrt(Math.pow(t,2)+1))}},getBeZerPoint:function(t,e,a,i){return{x:Math.pow(1-i,2)*t.x+2*i*(1-i)*a.x+Math.pow(i,2)*e.x,y:Math.pow(1-i,2)*t.y+2*i*(1-i)*a.y+Math.pow(i,2)*e.y}},getBeZerLength:function(t,e,a){var i=t.x-2*a.x+e.x,r=t.y-2*a.y+e.y,s=2*a.x-2*t.x,o=2*a.y-2*t.y,n=4*(i*i+r*r),h=4*(i*s+r*o),l=s*s+o*o;return 1/(8*Math.pow(n,1.5))*(2*Math.sqrt(n)*(2*n*1*Math.sqrt(1*n*1+1*h+l)+h*(Math.sqrt(1*n*1+1*h+l)-Math.sqrt(l)))+(h*h-4*n*l)*(Math.log(h+2*Math.sqrt(n*l))-Math.log(h+2*n*1+2*Math.sqrt(n)*Math.sqrt(1*n*1+1*h+l))))},needBezer:function(){var t=this.isSameLineNotSide();return t||0},getNodeSpace:function(){var t=parseInt(this.data.source.domId.substr(5,2)),e=parseInt(this.data.source.domId.substr(8,2)),a=parseInt(this.data.target.domId.substr(5,2)),i=parseInt(this.data.target.domId.substr(8,2));return t===a&&e+1!==i&&e-1!==i?Math.abs(i-e):e===i&&t+1!==a&&t-1!==a?Math.abs(a-t):0},isSameLineNotSide:function(){var t=parseInt(this.data.source.domId.substr(5,2)),e=parseInt(this.data.source.domId.substr(8,2)),a=parseInt(this.data.target.domId.substr(5,2)),i=parseInt(this.data.target.domId.substr(8,2));return t===a&&e+1!==i&&e-1!==i?2:e===i&&t+1!==a&&t-1!==a?1:0},calAngle:function(t,e){var a=Math.atan((e.y-t.y)/(e.x-t.x));return a=t.x>e.x?Math.PI+a:a},getCircleCenter:function(t){var e=d3.select("g.node."+t.domId);if(e&&e.attr("transform")){var a=this.getOffsetByTransform(e.attr("transform"));if(t.symbol){var i=e.select(".node-core").attr("width");return a.x+=i/2,a.y+=i/2,a}return a}},getOffsetByTransform:function(t){var e=t.indexOf("translate"),a=t.substr(e+9),i=a.indexOf("("),r=a.indexOf(")");a=a.substr(i+1,r-i-1);var s=a.split(",");return 2!==s.length&&(s=a.split(" ")),{x:parseInt(s[0]),y:parseInt(s[1])}},showText:function(){$(".line-text",this.$link[0][0]).show()},hideText:function(){$(".line-text",this.$link[0][0]).hide()},playArrowAnimation:function(){var t=this.createArrow(this.playArrowP1,this.playArrowP2,this.playArrowP3,"playArrow"),e=this;if(this.hideArrow(),$("path.playArrow",this.$link[0][0]).show(),this.needBezer()&&!this.data.notNeedBezerFlag){this.arr=[];for(var a=e.playTime/1e3*60,i=0;i<a;i++){var r=e.getBezerArrowPoint(e.csource,e.ctarget,{x:e.bezerX,y:e.bezerY},i/a);this.arr.push(e.getArrowData(r[0],r[1],r[2]))}t.transition().duration(this.playTime).ease("linear").each("end",function(){t.attr("d",e.playArrowData),e.playArrowAnimation()}).attrTween("d",this.dTween)}else t.transition().duration(this.playTime).ease("linear").each("end",function(){t.attr("d",e.playArrowData),e.playArrowAnimation()}).attr("d",this.stopArrowData)},dTween:function(){var t=d3.scale.quantize().domain([0,1]).range(this.arr);return function(e){return t(e)}},stopArrowAnimation:function(){var t=this.$link.select(".playArrow");this.showArrow(),t.transition().remove(),this.createArrow(this.playArrowP1,this.playArrowP2,this.playArrowP3,"playArrow"),$(t[0][0]).hide()},hideArrow:function(){$("path.startArrow",this.$link[0][0]).hide(),$("path.endArrow",this.$link[0][0]).hide()},showArrow:function(){$("path.startArrow",this.$link[0][0]).show(),$("path.endArrow",this.$link[0][0]).show()}},created:function(){},mounted:function(){this.render(),this.$emit("onLinkFinished",this.data)},updated:function(){}}},618:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"topo-node",data:function(){return{$node:null,arc:null,pie:null,offsetX:0,offsetY:0}},props:{colors:{default:function(){return{normal:"#a9d86e",slow:"#86cae4",very_slow:"#fcb322",error:"#f58210",warning:"#86cae4",normality:"#86cae4",intolerance:"#f58210",healthy:"#a9d86e",crossApp:"#8b97a3"}}},attachmentRadius:{default:15},attachmentColor:{default:"#338cff"},attachmentTextOffset:{default:function(){return{x:2,y:3}}},attachmentSummary:{default:function(){return{show:!0,formatter:function(){},position:"left"}}},radius:{default:35},scale:{default:1},innerRadius:{default:22},bigFont:{default:function(){return{color:"#3e3d39",size:14}}},smallFont:{default:function(){return{color:"#3e3d39",size:12}}},data:{default:function(){return{}}},spaceCircleColor:{default:"white"},update:0},watch:{update:function(t){this.data.hide||(this.destroy(),this.render())},scale:function(t){this.scaleChange(t)}},methods:{render:function(){this.data.hide||(this.createNode(),this.renderNode())},destroy:function(){this.$node&&$(this.$node[0][0]).children().remove(),this.$node=null,this.arc=null,this.pie=null},createNode:function(){this.$node||(this.$node=d3.select(this.$refs.g).attr("transform","translate("+(this.radius+this.data.x)+","+(this.radius+this.data.y)+")"))},renderNode:function(){this.data.symbol?this.renderImg():(this.renderPie(),this.data.crossApp||this.renderAttachment())},renderPie:function(){var t=this.getPie(),e=this.getArc();this.data.crossApp&&(this.data.status=[{value:1,name:"crossApp"}]);var a=this.$node.selectAll("path.arc").data(t(this.data.status)),i=this.colors;a.enter().append("path").attr("class","arc node-core").attr("fill",function(t,e){return i[t.data.name]}),a.transition().attrTween("d",function(t){var a=this.__current__;a||(a={startAngle:0,endAngle:0});var i=d3.interpolate(a,t);return this.__current__=i(1),function(t){return e(i(t))}}),this.$node.append("circle").attr("cx",0).attr("cy",0).attr("r",this.innerRadius).attr("fill",this.spaceCircleColor),this.data.crossApp||this.$node.append("text").attr("class","instances").attr("text-anchor","middle").attr("y",5).text((this.data.activeInstances?this.data.activeInstances:0)+"/"+(this.data.instances?this.data.instances:0)),this.$node.append("text").attr("class","pie-name").attr("y",this.radius+15).attr("fill",this.smallFont.color).style("text-anchor","middle").text(this.data.showName),this.data.crossApp||this.renderSummary(this.$node,this.radius)},renderImg:function(){var t=2*this.radius*(2/3);this.$node.append("image").attr("class","node-core").attr("width",t).attr("height",t).attr("xlink:href",this.resolveImgUrl(this.data.symbol)),this.$node.append("text").attr("class","pie-name").attr("y",t+10).attr("fill",this.smallFont.color).style("text-anchor","middle").attr("transform","translate("+t/2+")").text(this.data.showName),this.renderSummary(this.$node,t,1*t/3)},renderSummary:function(t,e,a){if(this.attachmentSummary.show){var i=this.attachmentSummary.formatter(this.data);if(i instanceof Array&&i.length>0){var r=t.append("text").attr("class","pie-summary").attr("x",e).attr("fill",this.smallFont.color);i.forEach(function(t){r.append("tspan").attr("x",e+10).attr("class","adsFlowMapTextShadow").attr("dy",13).text(t),r.append("tspan").attr("x",e+10).text(t)});var s=13*i.length;a?r.attr("y",a):r.attr("y",-s/2)}}},renderAttachment:function(){var t=-this.radius,e=this.radius-this.attachmentRadius;this.$node.append("circle").attr("class","attachement").attr("fill",this.attachmentColor).attr("cx",t).attr("cy",e).attr("r",this.attachmentRadius),this.$node.append("text").attr("class","attachement-text").attr("fill","white").attr("x",t-this.attachmentRadius+2).attr("y",e+3).text(this.data.serverName)},getArc:function(){return this.arc?this.arc:(this.arc=d3.svg.arc().outerRadius(this.radius).innerRadius(this.innerRadius),this.arc)},getPie:function(){return this.pie?this.pie:(this.pie=d3.layout.pie().value(function(t){return t.value}),this.pie)},resolveImgUrl:function(t){var e=t.indexOf("image://");return e>=0?t.substr(e+8):t},addEvent:function(){var t=this;this.$node.call(d3.behavior.drag().on("drag",function(){d3.event.sourceEvent.offsetX===t.offsetX&&d3.event.sourceEvent.offsetY===t.offsetY||(t.dragFlag||setTimeout(function(){t.dragFlag=!0},200),d3.select(this).attr("transform",function(t){return"translate("+d3.event.x+", "+d3.event.y+")"}),t.data.x=d3.event.x,t.data.y=d3.event.y,t.$emit("onNodeMove",t.data))}).on("dragstart",function(e){t.offsetX=d3.event.sourceEvent.offsetX,t.offsetY=d3.event.sourceEvent.offsetY,d3.event.sourceEvent.stopPropagation(),t.$emit("onMouseDown",t.data,d3.event.sourceEvent)}).on("dragend",function(){t.offsetX=0,t.offsetY=0,t.$emit("onMouseUp",t.data,d3.event.sourceEvent,t.dragFlag),t.dragFlag=!1}))},parseTransform:function(t){t=t.substr(10),t=t.substr(0,t.length-1);var e=t.split(",");return e&&2===e.length||(e=t.split(" ")),e[0]=parseFloat(e[0]),e[1]=parseFloat(e[1]),e},scaleChange:function(t){},onEnterNode:function(t){this.$emit("onEnterNode",this.data,t)},onLeaveNode:function(t){this.$emit("onLeaveNode",this.data,t)}},mounted:function(){this.data.hide||(this.render(),this.addEvent())}}},619:function(t,e,a){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=a(627),s=i(r),o=a(626),n=i(o),h=a(35);e.default={name:"topo",components:{TopoNode:s.default,TopoLink:n.default,"el-button":h.Button,"el-table":h.Table,"el-table-column":h.TableColumn,"el-input":h.Input,"el-form":h.Form,"el-form-item":h.FormItem,"el-dialog":h.Dialog,"el-pagination":h.Pagination,"el-breadcrumb":h.Breadcrumb,"el-breadcrumb-item":h.BreadcrumbItem,"el-switch":h.Switch,"el-tooltip":h.Tooltip,"el-tag":h.Tag,"el-checkbox":h.Checkbox},data:function(){return{lineTextFlag:!0,bezerFlag:!0,linkFinishedNum:0,scale:this.data.scale||1,translate:[0,0],scaleScales:null,pixelScales:null,maxMargin:0,sliderTop:1,scaleRange:[.35,3],topo_z:null,updateNode:0,updateLink:0,tooltip:{show:!1,left:0,top:0,delay:0},nodeDetailVisible:!1,modal:!1,tierList:[]}},props:{data:{default:function(){return{}}},radius:{default:35},innerRadius:23,attachmentRadius:15,update:0,attachmentSummary:{show:!0,formatter:function(t){},position:"left"},fullbtnDisplay:{default:!0},setFullScreen:{default:!1}},watch:{data:function(t){t.scale&&(this.scaleRange[0]<t.scale&&(this.scaleRange[0]=t.scale),this.scale=t.scale),(t.offsetLeft||t.offsetTop)&&(this.translate[0]=t.offsetLeft?t.offsetLeft:0,this.translate[1]=t.offsetTop?t.offsetTop:0,d3.select(this.$refs["topo-container"]).attr("transform","translate("+this.translate+") scale("+[this.scale,this.scale]+")"),this.topo_z.translate(this.translate))},update:function(t){this.updateNode=t,this.updateLink=t,this.zoom(this.scale)},scale:function(t){this.zoom(t)},sliderTop:function(t){this.setSliderTop(t)},setFullScreen:function(t){t&&this.fullScreen(),this.$emit("onFullScreenChange",t)}},methods:{resetContainer:function(){d3.select(this.$refs["topo-container"]).attr("transform","translate(0, 0) scale(1)")},render:function(){var t=this,e=$(t.$refs.slider).height(),a=$(t.$refs["slider-thumb"]).height();this.maxMargin=e-a;var i=t.scaleRange[1],r=t.scaleRange[0],s=this.maxMargin;this.scaleScales=t.getScaleRelation(1,s,i,r),this.pixelScales=t.getScaleRelation(i,r,1,s),this.computeSliderTop(),$(this.$refs.fullscreen).hover(function(){$(this).attr("src","/static/images/maximize_blue.svg")},function(){$(this).attr("src","/static/images/maximize_gray.svg")})},adjustLink:function(){var t=$(this.$refs["topo-container"]);$("g.link",this.$refs["topo-svg"]).each(function(e,a){$(a).remove(),t.prepend(a)})},addEvent:function(){var t=this;this.topo_z=d3.behavior.zoom().scaleExtent(t.scaleRange).on("zoom",this.zoom),d3.select(t.$refs["topo-svg"]).call(this.topo_z).on("dblclick.zoom",null),this.dispatch=d3.dispatch("mousewheel"),this.dispatch.on("mousewheel",this.zoom),window.addEventListener("resize",function(){t.fullstatus&&t.fullScreen()})},zoom:function(t,e){var a=t||d3.event.scale,i=this;a>.88?(this.lineTextFlag=!0,setTimeout(function(){$(".line-text",i.$refs["topo-svg"]).show(),$(".pie-summary",i.$refs["topo-svg"]).show(),$(".attachement-text",i.$refs["topo-svg"]).show(),$(".attachement",i.$refs["topo-svg"]).show()},100)):(setTimeout(function(){$(".line-text",i.$refs["topo-svg"]).hide(),$(".pie-summary",i.$refs["topo-svg"]).hide(),$(".attachement-text",i.$refs["topo-svg"]).hide(),$(".attachement",i.$refs["topo-svg"]).hide()},100),this.lineTextFlag=!1),a>.68?setTimeout(function(){$(".pie-name",i.$refs["topo-svg"]).show()},100):setTimeout(function(){$(".pie-name",i.$refs["topo-svg"]).hide()},100);var r=d3.transform(d3.select(i.$refs["topo-container"]).attr("transform"));if(this.scale!==a||t||(this.translate=[r.translate[0],r.translate[1]]),this.tooltip.show=!1,!d3.event&&e){d3.select(i.$refs["topo-container"]).attr("transform","scale("+[a,a]+")");var s=i.$refs["topo-container"].getBoundingClientRect(),o=[this.translate[0]+(this.data.scale-a)*(s.width/2)/a,this.translate[1]+(this.data.scale-a)*(s.height/2)/a];d3.select(i.$refs["topo-container"]).attr("transform","translate("+o+") scale("+[a,a]+")"),this.topo_z.translate(o)}else d3.select(i.$refs["topo-container"]).attr("transform","translate("+(d3.event?d3.event.translate:r.translate)+") scale("+[a,a]+")"),this.topo_z.translate(d3.event?d3.event.translate:r.translate);this.scale=a,this.topo_z.scale(this.scale),this.computeSliderTop()},setSliderTop:function(t){$(this.$refs["slider-thumb"]).css("margin-top",t+"px")},computeSliderTop:function(){this.sliderTop=this.pixelScales[0]*this.scale+this.pixelScales[1],this.sliderTop=this.sliderTop<1?1:this.sliderTop,this.sliderTop=this.sliderTop>this.maxMargin?this.maxMargin:this.sliderTop},computeScale:function(){return this.scaleScales[0]*this.sliderTop+this.scaleScales[1]},onNodeMove:function(t,e){if(this.data.links){t.drillDown&&1*new Date-this.tooltip.delay>100&&(this.tooltip.show=!1,this.tooltip.delay=1*new Date);this.getLinksByNode(t).forEach(function(t,e){t.change++,t.notNeedBezerFlag=!0}),this.$emit("onNodeMove",t,e)}},onMouseDown:function(t,e){if(this.data.links){this.getLinksByNode(t).forEach(function(t,e){t.dragFlag=!0}),this.$emit("onMouseDownNode",t,e)}},onMouseUp:function(t,e,a){if(this.data.links){this.getLinksByNode(t).forEach(function(t,e){t.dragFlag=!1}),a||this.$emit("onMouseUpNode",t,e),!a&&t.list&&t.list.length>1&&(this.tierList=t.list,this.nodeDetailVisible=!0)}},onLinkFinished:function(t,e){this.linkFinishedNum++,this.linkFinishedNum===this.data.links.length&&(this.adjustLink(),this.linkFinishedNum=0),this.$emit("onLinkFinished",t,e)},closeDialog:function(){this.nodeDetailVisible=!1},onEnterNode:function(t,e){if(e=e||window.event,this.data.links){var a=e.target.getBoundingClientRect(),i=$(this.$refs["topo-svg"]).offset();t.drillDown&&(this.tooltip.left=a.left-i.left+a.width/20*this.scale,this.tooltip.top=a.top-i.top-$(this.$refs.tooltip).height()-10,this.tooltip.show=!0,this.tooltip.delay=1*new Date);this.getLinksByNode(t).forEach(function(t,e){t.play=!0}),this.$emit("onEnterNode",t,e)}},parseTransform:function(t){if(t){t=t.substr(10),t=t.substr(0,t.length-1);var e=t.split(",");return e&&2===e.length||(e=t.split(" ")),e[0]=parseFloat(e[0]),e[1]=parseFloat(e[1]),e}},onLeaveNode:function(t,e){if(this.data.links){t.drillDown&&1*new Date-this.tooltip.delay>100&&(this.tooltip.show=!1,this.tooltip.delay=1*new Date);this.getLinksByNode(t).forEach(function(t,e){t.play=!1}),this.$emit("onLeaveNode",t,e)}},onSliderDown:function(t){var e=this,a=t.clientY;document.onmousemove=function(t){var i=t.clientY-a;e.sliderTop+=i,e.sliderTop=e.sliderTop<1?1:e.sliderTop,e.sliderTop=e.sliderTop>e.maxMargin?e.maxMargin:e.sliderTop;var r=e.computeScale();a=t.clientY,e.dispatch&&e.dispatch.mousewheel(r,!0)},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null}},fullScreen:function(t){var e=$("body").width(),a=$("body").height();$(this.$refs.topo).width(e),$(this.$refs.topo).height(a),$(this.$refs.topo).addClass("full"),$(this.$refs.fullscreen).hide(),$(this.$refs.restore).show(),this.fullstatus=!0},restore:function(t){$(this.$refs.topo).width("100%"),$(this.$refs.topo).height("100%"),$(this.$refs.topo).removeClass("full"),$(t.target).hide(),$(this.$refs.fullscreen).show(),this.$emit("onFullScreenChange",!1),this.fullstatus=!1},getScaleRelation:function(t,e,a,i){return[(i-a)/(e-t),a-t*(i-a)/(e-t)]},getLinksByNode:function(t){for(var e=[],a=0;a<this.data.links.length;a++){var i=this.data.links[a];i.source.domId!==t.domId&&i.target.domId!==t.domId||e.push(i)}return e}},created:function(){},mounted:function(){this.render(),this.addEvent()},updated:function(){var t=this,e=this.$refs.topo.clientHeight,a=parseInt($(t.$refs.slider).css("top")),i=e-2*a;e<=0||(e<2*a+$(t.$refs.slider).height()&&($(t.$refs.slider).height(i),this.render()),$(t.$refs.slider).show())}}},620:function(t,e,a){e=t.exports=a(566)(),e.push([t.i,"@keyframes down{0%{transform:translateY(0)}20%{transform:translateY(-2px)}50%{transform:translateY(2px)}75%{transform:translateY(1px)}to{transform:translateY(0)}}.topo.full[data-v-2a8bfc5e]{position:fixed;top:0;left:0;right:0;bottom:0;z-index:1000;background:#fff}.topo[data-v-2a8bfc5e]{width:100%;height:100%;position:relative;moz-user-select:-moz-none;-moz-user-select:none;-o-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.topo svg[data-v-2a8bfc5e]{width:100%;height:100%}.topo svg g.node[data-v-2a8bfc5e]:hover{cursor:pointer}.tooltip[data-v-2a8bfc5e]{position:absolute;float:left;left:-100000px;top:-100000;background-color:#fff;border-radius:5px;box-shadow:1px 1px 1px 1px #ccc;line-height:22px;padding:5px 10px}.tooltip i[data-v-2a8bfc5e]{font-size:18px;display:inline-block;vertical-align:middle;margin-bottom:2px;border-bottom:2px solid #ccc;box-sizing:border-box}.tooltip.show i[data-v-2a8bfc5e]{animation:down .5s ease-in;animation-delay:.5s;animation-iteration-count:2}.fade-enter-active[data-v-2a8bfc5e]{transition:all .5s ease}.fade-leave-active[data-v-2a8bfc5e]{transition:all 0s ease}.fade-enter[data-v-2a8bfc5e],.fade-leave-active[data-v-2a8bfc5e]{opacity:0}.topo .slider[data-v-2a8bfc5e]{width:10px;height:200px;position:absolute;top:50px;left:15px;background:#f5f5f5;border:1px solid #d7d7d7;border-radius:12px;display:none}.topo .slider .slider-thumb[data-v-2a8bfc5e]{width:12px;height:12px;border-radius:12px;background:#9aa3b2;margin-left:-2px;margin-top:1px;box-shadow:2px 2px 2px 2px hsla(0,0%,100%,.8);cursor:pointer}.topo .toolbar[data-v-2a8bfc5e]{position:absolute;top:10px;right:10px}.topo .toolbar img[data-v-2a8bfc5e]{cursor:pointer}.topo .toolbar .restore[data-v-2a8bfc5e]{display:none}",""])},621:function(t,e,a){e=t.exports=a(566)(),e.push([t.i,'.link line{stroke:#2693ff;stroke-width:1}.link.dash line{stroke-dasharray:3}.link line:hover{stroke-width:2}.hide,.link path.arrow.playArrow{display:none}.link path.bezer{fill:none;stroke:#2693ff;stroke-width:1}.link.dash path.bezer{stroke-dasharray:3}.link path.bezer:hover{stroke-width:2}.link path.arrow{fill:#2693ff}.link .line-text{font-size:10px;font-weight:"normal";font-style:"-apple-system,Microsoft Yahei,system-ui,BlinkMacSystemFont,Open Sans,Hiragino Sans GB,sans-serif";color:"#000"}.adsFlowMapTextShadow{stroke:#fff;stroke-width:4px;stroke-opacity:.8;fill:#fff;fill-opacity:1;font-size:10px}.real{text-anchor:middle;font-size:10px}',""])},622:function(t,e,a){e=t.exports=a(566)(),e.push([t.i,".instances{font-size:18px}.adsFlowMapTextShadow{stroke:#fff;stroke-width:4px;stroke-opacity:.8;fill:#fff;fill-opacity:1}.pie-summary{font-size:10px}",""])},623:function(t,e,a){var i=a(620);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(567)("ab196eaa",i,!0)},624:function(t,e,a){var i=a(621);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(567)("0417ee2e",i,!0)},625:function(t,e,a){var i=a(622);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(567)("812a4628",i,!0)},626:function(t,e,a){a(624);var i=a(54)(a(617),a(630),null,null);t.exports=i.exports},627:function(t,e,a){a(625);var i=a(54)(a(618),a(631),null,null);t.exports=i.exports},629:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"topo",staticClass:"topo"},[a("svg",{ref:"topo-svg",staticClass:"topo-svg"},[a("g",{ref:"topo-container",staticClass:"topo-container"},[t._l(t.data.nodes,function(e){return t.data.nodes?a("topo-node",{key:e.domId,attrs:{data:e,radius:t.radius,innerRadius:t.innerRadius,attachmentRadius:t.attachmentRadius,attachmentSummary:t.attachmentSummary,update:t.updateNode,scale:t.scale},on:{onNodeMove:t.onNodeMove,"!onEnterNode":function(e){t.onEnterNode(e)},"!onLeaveNode":function(e){t.onLeaveNode(e)},onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp}}):t._e()}),t._v(" "),t._l(t.data.links,function(e){return t.data.links?a("topo-link",{key:e.id,attrs:{data:e,change:e.change,showTextFlag:t.lineTextFlag,bezerFlag:t.bezerFlag,play:e.play,dragFlag:e.dragFlag,update:t.updateLink,radius:t.radius,scale:t.scale},on:{onLinkFinished:t.onLinkFinished}}):t._e()})],2)]),t._v(" "),a("transition",{attrs:{name:"fade"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.tooltip.show,expression:"tooltip.show"}],ref:"tooltip",staticClass:"tooltip",class:{show:t.tooltip.show},style:{left:t.tooltip.left+"px",top:t.tooltip.top+"px"}},[a("i",{staticClass:"icon ion-android-arrow-down theme-font-color-primary",staticStyle:{"font-size":"20px"}}),t._v("点击下钻\n        ")])]),t._v(" "),a("div",{ref:"slider",staticClass:"slider"},[a("div",{ref:"slider-thumb",staticClass:"slider-thumb",on:{mousedown:t.onSliderDown}})]),t._v(" "),a("div",{ref:"toolbar",staticClass:"toolbar"},[t.fullbtnDisplay?a("img",{ref:"fullscreen",staticClass:"fullscreen",attrs:{src:"/static/images/maximize_gray.svg"},on:{click:t.fullScreen}}):t._e(),t._v(" "),a("img",{ref:"restore",staticClass:"restore",attrs:{src:"/static/images/minimize_gray.svg"},on:{click:t.restore}})]),t._v(" "),a("el-dialog",{attrs:{width:"60%",title:"节点详情","modal-append-to-body":t.modal,visible:t.nodeDetailVisible},on:{"update:visible":function(e){t.nodeDetailVisible=e}}},[a("el-table",{staticClass:"list-table",staticStyle:{width:"100%"},attrs:{data:t.tierList,"max-height":"400","default-sort":{prop:"elapsedTime",order:"descending"}}},[a("el-table-column",{attrs:{prop:"tiersName",label:"调用者Tier"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",label:"远程调用",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"elapsedTime",label:"平均响应时间(ms)",sortable:""}})],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.closeDialog}},[t._v("确定")])],1)],1)],1)},staticRenderFns:[]}},630:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("g",{ref:"g",staticClass:"link",class:t.data.id})},staticRenderFns:[]}},631:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("g",{ref:"g",staticClass:"node",class:t.data.domId,on:{mouseenter:t.onEnterNode,mouseleave:t.onLeaveNode}})},staticRenderFns:[]}},644:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){this.root=null,this.data={},this.nodes=null,this.links=null,this.col=0,this.row=0,this.hspace=250,this.vspace=50,this.type="",this.cell={width:100,height:100},this.offsetWidth=0,this.offsetHeight=0,this.rootWidth=0,this.rootHeight=0,this.map={}};i.prototype.init=function(){this.row=0,this.col=0,this.hspace=250,this.vspace=50,this.type="",this.cell={width:100,height:100},this.offsetWidth=0,this.offsetHeight=0,this.rootWidth=this.root.offsetWidth,this.rootHeight=this.root.offsetHeight},i.prototype.layout=function(t,e,a){t&&(this.root=t,this.data=e,this.nodes=e.nodes,this.links=e.links,this.type=a||"grid",this.init(),this.parseNodes(),this.adjust(),this.calNodesLocation(),this.calScale())},i.prototype.parseNodes=function(){if(this.root&&this.nodes){for(var t={},e=0;e<this.nodes.length;e++){var a=this.nodes[e];t[a.group]||(this.col++,t[a.group]=0),t[a.group]=t[a.group]+1,this.row<t[a.group]&&(this.row=t[a.group])}this.map=t}},i.prototype.calNodesLocation=function(){if(this.root&&this.nodes)for(var t=0;t<this.nodes.length;t++){var e=this.nodes[t],a=this.getGrid(e);e.x=a[0]*(this.hspace+this.cell.width),e.y=a[1]*(this.vspace+this.cell.height)+(e.innerRadius?e.innerRadius:0)}},i.prototype.calScale=function(){for(var t=1;;){var e=this.rootWidth-(this.col*this.cell.width+(this.col-1)*this.hspace)*t,a=this.rootHeight-(this.row*this.cell.height+(this.row-1)*this.vspace)*t;if(e>=0&&a>=0)break;t=.87;break}this.data.scale=t},i.prototype.adjust=function(){this.offsetWidth=this.rootWidth-this.col*this.cell.width-(this.col-1)*this.hspace,this.offsetHeight=this.rootHeight-this.row*this.cell.height-(this.row-1)*this.vspace,this.offsetWidth=this.offsetWidth<0?0:this.offsetWidth/3,this.offsetHeight=this.offsetHeight<0?0:this.offsetHeight/2,this.data.offsetLeft=this.offsetWidth,this.data.offsetTop=this.offsetHeight},i.prototype.getGrid=function(t){return[parseInt(t.domId.substr(5,2)),parseInt(t.domId.substr(8,2))]},e.default=i},679:function(t,e,a){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=a(201),s=i(r),o=a(140),n=i(o),h=a(608),l=i(h);e.default={name:"chart-area-graph",mixins:[l.default],props:{optionData:{type:Object,default:{}}},data:function(){return{defOption:{}}},computed:{noData:function(){return(0,s.default)(this.optionData).length<=0}},watch:{optionData:{deep:!0,handler:function(t){this.resetDefData(),this.renderChart()}}},methods:{resetDefData:function(){this.defOption={noDataLoadingOption:{text:"暂无数据",effect:"bubble",effectOption:{effect:{n:0}}},tooltip:{trigger:"axis"},color:{type:"radial",x:.5,y:.5,r:.5,colorStops:[{offset:0,color:"red"},{offset:1,color:"blue"}],globalCoord:!1},grid:{top:"5",left:"10",right:"15",bottom:"8",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:[]},yAxis:{type:"value",splitLine:{show:!1}},series:[{name:"",type:"line",smooth:!0,sampling:"average",hoverAnimation:!0,itemStyle:{normal:{color:this.chartColors[0]}},areaStyle:{normal:{}},data:[]}]}},renderChart:function(){if(this.chart||(this.chart=echarts.init(this.$refs.chart)),this.noData)this.chart.clear();else{this.chart.resize();var t=n.default.extend(this.defOption,this.optionData);this.chart.setOption(t,!0)}}}}},681:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:{barData:{type:Array,validator:function(t){return t.length<5},default:[3,3,3]}},data:function(){return{colorsF:["#a8d96f","#85cae6","#fab421","#f38211"],colorsT:["#a8d96f","#85cae6","#f38211"]}},computed:{titleCount:function(){return new Function("return "+this.barData.join("+"))()},percents:function(){var t=this;return this.barData.map(function(e){return e>0?e/t.titleCount*100:0})}}}},700:function(t,e,a){e=t.exports=a(566)(),e.push([t.i,".chart[data-v-65382739]{height:100%;display:flex;align-items:center;justify-content:center}",""])},704:function(t,e,a){e=t.exports=a(566)(),e.push([t.i,".percent-bar[data-v-dd29795a]{background:#eee;display:flex}.percent-bar .item[data-v-dd29795a]{height:6px}",""])},713:function(t,e,a){var i=a(700);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(567)("d97534de",i,!0)},717:function(t,e,a){var i=a(704);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(567)("0df310b5",i,!0)},718:function(t,e,a){a(713);var i=a(54)(a(679),a(729),"data-v-65382739",null);t.exports=i.exports},720:function(t,e,a){a(717);var i=a(54)(a(681),a(733),"data-v-dd29795a",null);t.exports=i.exports},729:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"chart",staticClass:"chart"},[a("i",{staticClass:"el-icon-loading"})])},staticRenderFns:[]}},733:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"percent-bar"},[t._l(t.percents,function(e,i){return 3===t.percents.length?a("div",{key:i,staticClass:"item",style:{width:e+"%",background:t.colorsT[i]}}):t._e()}),t._v(" "),t._l(t.percents,function(e,i){return 4===t.percents.length?a("div",{key:i,staticClass:"item",style:{width:e+"%",background:t.colorsF[i]}}):t._e()})],2)},staticRenderFns:[]}},787:function(t,e,a){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=a(140),s=i(r),o=a(616),n=i(o),h=a(644),l=i(h),d=a(720),c=i(d),u=a(718),p=i(u),f=a(609),g=i(f);e.default={components:{ChartAreaGraph:p.default,PercentBar:c.default,Topo:n.default},mixins:[g.default],data:function(){return{attachmentSummary:{show:!0,formatter:function(t){var e=[];switch(t.type){case"USER":t.elapsedTime&&e.push(t.elapsedTime+" ms(100%)"),t.error&&e.push(t.error+" errors");break;case"SERVER":t.elapsedTime&&e.push(s.default.toDecimal(t.elapsedTime)+" ms");var a=t.rpm;e.push(a+" rpm"),t.epm&&e.push(t.epm+" epm")}return e},position:"left"},update:0,topoData:{},topoHeight:"400px",indicatorData:{h:{countData:[0,0,0],perventData:[0,0,0]},t:{countData:[0,0,0],perventData:[0,0,0]},u:{countData:[0,0,0,0],perventData:[0,0,0,0]}},chartDataResponse:{avgResponseTime:0,apdex:0,optionData:{}},chartDataThroughput:{requestCount:0,rpm:0,optionData:{}},chartDataError:{errorCount:0,epm:0,optionData:{}}}},computed:{},mounted:function(){this.fixTopoHeight(),$(window).on("resize",this.fixTopoHeight)},methods:{barChange:function(t){this.topBarQueryData=t,this.getDashboardIndicatorData(),this.getDashboardresponsetimetrendData(),this.getDashboardresponthroughputtrendData(),this.getDashboarderrorcounttrendData(),this.getTopoData()},fixTopoHeight:function(){var t=$(".main-content").height(),e=$(".bottom-charts").height(),a=$(".filter-bar").height(),i=t-e-a-96;i<400&&(i=400),this.topoHeight=i},getDashboarderrorcounttrendData:function(){var t=this;this.api.getDashboarderrorcounttrend({data:{condition:{appId:this.appId,startTime:this.startTime,endTime:this.endTime,interval:this.interval,aggrInterval:this.aggrInterval}}}).then(function(e){if(0===e.code){var a=e.data.errorCountTrendRows||[],i=a.map(function(t){return s.default.formatDate(t.time,2)}),r=a.map(function(t){return t.errorCount});i.length<=0?t.chartDataError.optionData={}:t.chartDataError={errorCount:e.data.errorCount,epm:s.default.toDecimal(e.data.epm),errorRate:s.default.toDecimal(e.data.errorRate)||0,optionData:{formatter:function(t,e,i){var r="";return t.map(function(t){var e=a[t.dataIndex];e&&(r="\n                      标题："+e.title+"<br>\n                      时间："+s.default.formatDate(e.time,2)+"<br>\n                      错误数："+e.errorCount+"<br>\n                      错误／分钟："+s.default.toDecimal(e.epm)+"<br>\n                      请求次数："+e.requestCount+"<br>\n                      ")}),r},xAxis:{data:i},series:[{data:r}]}}}})},getDashboardresponthroughputtrendData:function(){var t=this;this.api.getDashboardresponthroughputtrend({data:{condition:{appId:this.appId,startTime:this.startTime,endTime:this.endTime,interval:this.interval,aggrInterval:this.aggrInterval}}}).then(function(e){if(0===e.code){var a=e.data.throughputTrendRows||[],i=a.map(function(t){return s.default.formatDate(t.time,2)}),r=a.map(function(t){return t.rpm});i.length<=0?t.chartDataThroughput.optionData={}:t.chartDataThroughput={requestCount:e.data.requestCount,rpm:s.default.toDecimal(e.data.rpm),optionData:{formatter:function(t,e,i){var r="";return t.map(function(t){var e=a[t.dataIndex];e&&(r="\n                      标题："+e.title+"<br>\n                      时间："+s.default.formatDate(e.time,2)+"<br>\n                      吞吐率："+e.rpm+"<br>\n                      请求次数："+e.requestCount+"<br>\n                      ")}),r},xAxis:{data:i},series:[{data:r}]}}}})},getDashboardresponsetimetrendData:function(){var t=this;this.api.getDashboardresponsetimetrend({data:{condition:{appId:this.appId,startTime:this.startTime,endTime:this.endTime,interval:this.interval,aggrInterval:this.aggrInterval}}}).then(function(e){if(0===e.code){var a=e.data.responseTimeTrendRowList||[],i=a.map(function(t){return s.default.formatDate(t.time,2)}),r=a.map(function(t){return t.responseTime});i.length<=0?t.chartDataResponse.optionData={}:t.chartDataResponse={avgResponseTime:e.data.avgResponseTime,apdex:e.data.apdex,optionData:{formatter:function(t,e,i){var r="";return t.map(function(t){var e=a[t.dataIndex];e&&(r="\n                      标题："+e.title+"<br>\n                      时间："+s.default.formatDate(e.time,2)+"<br>\n                      响应时间："+e.responseTime+"<br>\n                      最大值："+e.maxResponseTime+"<br>\n                      最小值："+e.minResponseTime+"<br>\n                      请求次数："+e.requestCount+"<br>\n                      ")}),r},xAxis:{data:i},series:[{data:r}]}}}})},getDashboardIndicatorData:function(){var t=this;this.api.getDashboardIndicator({data:{condition:{appId:this.appId,startTime:this.startTime,endTime:this.endTime}}}).then(function(e){if(0===e.code){var a=e.data.dashboardNodeHealthIndicator.dashboardNodeHealthIndicatorPair,i=s.default.toPercentageP([a.healthyCount,a.normalCount,a.intoleranceCount]),r=e.data.dashboardTransactionHealthIndicator.dashboardTransactionHealthIndicatorPair,o=s.default.toPercentageP([r.healthyCount,r.normalCount,r.intoleranceCount]),n=e.data.dashboardUserExperienceIndicator.dashboardUserExperienceIndicatorPair,h=[n.normalCountProportion,n.slowCountProportion,n.verySlowProportion,n.errorProportion];t.indicatorData={h:{countData:[a.healthyCount,a.normalCount,a.intoleranceCount],perventData:i},t:{countData:[r.healthyCount,r.normalCount,r.intoleranceCount],perventData:o},u:{countData:[n.normalCountProportion,n.slowCountProportion,n.verySlowProportion,n.errorProportion],perventData:h}}}})},getTopoData:function(){var t=this,e=this;this.api.getdashboardtopology({data:{condition:{appId:this.appId,startTime:this.startTime,endTime:this.endTime}}}).then(function(a){if(0===a.code){a.data.links.map(function(t,e){"USER"===t.source.type?t.label="":t.label=t.elapsedTime+" ms"}),a.data.nodes.map(function(t,e){"USER"===t.type&&(t.elapsedTime=""),t.health&&(t.status=[{value:1,name:s.default.handleHealthy(t.health).Status}])}),t.topoData=a.data;(new l.default).layout($(".topo-box")[0],t.topoData),setTimeout(function(){e.update++},50)}})}}}},838:function(t,e,a){e=t.exports=a(566)(),e.push([t.i,".dashboard[data-v-75acb281]{padding-bottom:10px}.dashboard .first-section[data-v-75acb281]{display:flex}.dashboard .first-section .l[data-v-75acb281]{flex:1;margin-right:24px}.dashboard .first-section .r[data-v-75acb281]{width:33.4%}.dashboard .first-section .r .r-box[data-v-75acb281]{margin:24px 24px 24px 0}.dashboard .first-section .r .info-box-wrap[data-v-75acb281]{height:100%;display:flex;flex-direction:column}.dashboard .first-section .r .info-box[data-v-75acb281]{flex:1;border-bottom:1px solid #e1e1e1;padding:24px;display:flex;flex-direction:column;justify-content:center}.dashboard .first-section .r .info-box .title-base[data-v-75acb281]{font-size:14px;padding-bottom:10px}.dashboard .first-section .r .info-box .chart-area[data-v-75acb281]{display:flex}.dashboard .first-section .r .info-box .chart-area .item-bar[data-v-75acb281]{height:12px;background:#ff1f1f}.dashboard .first-section .r .info-box .chart-area .item-bar.green-bar[data-v-75acb281]{background:#5bd4c7}.dashboard .first-section .r .info-box .chart-area .item-bar.orange-bar[data-v-75acb281]{background:#fc9}.dashboard .first-section .r .info-box .chart-area .item-bar.red-bar[data-v-75acb281]{background:#ff1f1f}.dashboard .first-section .r .info-box .text-area[data-v-75acb281]{margin-top:6px}.dashboard .topo-box[data-v-75acb281]{margin:24px;margin-right:0;background:#fff;border:1px solid #e1e1e1}.dashboard .bottom-charts[data-v-75acb281]{margin-left:24px;display:flex}.dashboard .bottom-charts .l[data-v-75acb281]{flex:1;display:flex}.dashboard .bottom-charts .r[data-v-75acb281]{width:34%}.dashboard .bottom-charts .item-chart[data-v-75acb281]{margin:0 24px 0 0;background:#fff;flex:1;border:1px solid #e1e1e1}.dashboard .bottom-charts .item-chart .chart-warp[data-v-75acb281]{padding-top:20px;height:180px}",""])},872:function(t,e,a){var i=a(838);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a(567)("13625d3a",i,!0)},923:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard"},[a("top-bar",{attrs:{title:"仪表盘"},on:{barChange:t.barChange}}),t._v(" "),a("div",{staticClass:"first-section"},[a("div",{staticClass:"l",style:{height:t.topoHeight+"px"}},[a("div",{staticClass:"topo-box",style:{height:t.topoHeight+"px"}},[a("topo",{attrs:{data:t.topoData,update:t.update,attachmentSummary:t.attachmentSummary}})],1)]),t._v(" "),a("div",{staticClass:"r"},[a("div",{staticClass:"common-container r-box",style:{height:t.topoHeight+"px"}},[t._m(0),t._v(" "),a("div",{staticClass:"info-box-wrap",style:{height:t.topoHeight-52+"px"}},[a("div",{staticClass:"info-box"},[a("div",{staticClass:"title-base"},[t._v("节点健康")]),t._v(" "),a("div",{staticClass:"chart-box"},[a("PercentBar",{attrs:{barData:t.indicatorData.h.perventData}}),t._v(" "),a("div",{staticClass:"text-area"},[a("span",[t._v("健康："+t._s(t.indicatorData.h.countData[0])+"；一般："+t._s(t.indicatorData.h.countData[1])+"；不容忍："+t._s(t.indicatorData.h.countData[2]))])])],1)]),t._v(" "),a("div",{staticClass:"info-box"},[a("div",{staticClass:"title-base"},[t._v("事务健康")]),t._v(" "),a("div",{staticClass:"chart-box"},[a("PercentBar",{attrs:{barData:t.indicatorData.t.perventData}}),t._v(" "),a("div",{staticClass:"text-area"},[a("span",[t._v("健康："+t._s(t.indicatorData.t.countData[0])+"；一般："+t._s(t.indicatorData.t.countData[1])+"；不容忍："+t._s(t.indicatorData.t.countData[2]))])])],1)]),t._v(" "),a("div",{staticClass:"info-box",staticStyle:{border:"none"}},[a("div",{staticClass:"title-base"},[t._v("用户体验")]),t._v(" "),a("div",{staticClass:"chart-box"},[a("PercentBar",{attrs:{barData:t.indicatorData.u.perventData}}),t._v(" "),a("div",{staticClass:"text-area"},[a("span",[t._v("正常："+t._s(t.indicatorData.u.countData[0])+" %；缓慢："+t._s(t.indicatorData.u.countData[1])+" %；非常慢："+t._s(t.indicatorData.u.countData[2])+" %; 错误："+t._s(t.indicatorData.u.countData[3])+" %")])])],1)])])])])]),t._v(" "),a("div",{staticClass:"bottom-charts"},[a("div",{staticClass:"l"},[a("div",{staticClass:"common-container item-chart"},[a("div",{staticClass:"header-title"},[a("span",{staticClass:"title-name"},[t._v("响应时间(ms)："+t._s(t.chartDataResponse.avgResponseTime))]),t._v(" "),a("div",{staticClass:"right-info"},[a("span",[t._v("Apdex："+t._s(t.chartDataResponse.apdex)+" ")])])]),t._v(" "),a("div",{staticClass:"chart-warp"},[a("ChartAreaGraph",{attrs:{optionData:t.chartDataResponse.optionData}})],1)]),t._v(" "),a("div",{staticClass:"common-container item-chart"},[a("div",{staticClass:"header-title"},[a("span",{staticClass:"title-name"},[t._v("请求数："+t._s(t.chartDataThroughput.requestCount))]),t._v(" "),a("div",{staticClass:"right-info"},[a("span",[t._v(t._s(t.chartDataThroughput.rpm)+" rpm")])])]),t._v(" "),a("div",{staticClass:"chart-warp"},[a("ChartAreaGraph",{attrs:{optionData:t.chartDataThroughput.optionData}})],1)])]),t._v(" "),a("div",{staticClass:"r"},[a("div",{staticClass:"common-container item-chart"},[a("div",{staticClass:"header-title"},[a("span",[t._v("错误数："+t._s(t.chartDataError.errorCount)+" ")]),t._v(" "),a("span",{staticClass:"fc-red ml40"},[t._v(t._s(t.chartDataError.errorRate)+"%")]),t._v(" "),a("div",{staticClass:"right-info"},[a("span",[t._v(t._s(t.chartDataError.epm)+" epm")])])]),t._v(" "),a("div",{staticClass:"chart-warp"},[a("ChartAreaGraph",{attrs:{optionData:t.chartDataError.optionData}})],1)])])])],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"header-title"},[a("i",{staticClass:"title-icon icon ion-stats-bars"}),t._v(" "),a("span",{staticClass:"title-name"},[t._v("统计")])])}]}}});