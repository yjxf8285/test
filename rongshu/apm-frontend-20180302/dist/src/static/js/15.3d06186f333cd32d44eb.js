/*! 2018-3-2 author:liuxiaofan */
webpackJsonp([15],{576:function(t,e,i){i(708);var a=i(54)(i(690),i(724),"data-v-2525a2c1",null);t.exports=a.exports},606:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(35);e.default={data:function(){return{loading:!1,loadingInstance:null}},mounted:function(){this.$refs.loadingContainer||console.warn("你使用了loadingMixin，但没有指定ref=loadingContainer的DOM节点，系统会自动在body上启用加载效果",this)},watch:{loading:function(t){t?this.loadingInstance=a.Loading.service({target:this.$refs.loadingContainer}):this.loadingInstance&&(this.loadingInstance.close(),this.loadingInstance=null)}}}},607:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{needReload:!0}},props:{options:{type:Object,default:{}},selected:{type:Boolean,default:!1}},watch:{options:{deep:!0,handler:function(t){console.log(t),this.needReload=!0,this.selected&&this._reload()}},selected:function(t){t&&this._reload()}},methods:{_reload:function(){this.needReload&&(this.reload(),this.needReload=!1)}}}},612:function(t,e,i){"use strict";function a(t){var e,i;this.promise=new t(function(t,a){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=a}),this.resolve=r(e),this.reject=r(i)}var r=i(203);t.exports.f=function(t){return new a(t)}},616:function(t,e,i){i(623);var a=i(54)(i(619),i(629),"data-v-2a8bfc5e",null);t.exports=a.exports},617:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"node-link",data:function(){return{$link:null,sangle:0,tangle:0,length:0,arrowLength:8,arrowHeight:4,arrowMargin:50,startArrowData:"",endArrowData:"",playArrowData:"",stopArrowData:"",playArrowP1:"",playArrowP2:"",playArrowP3:"",playTime:3e3}},props:{data:{default:function(){return{}}},change:0,showTextFlag:!0,play:!1,dragFlag:!1,radius:{default:35},innerRadius:23,attachmentRadius:15,update:0},watch:{update:function(t){this.destroy(),this.rerender()},change:function(t){this.rerender()},play:function(t){if(this.dragFlag)return void this.stopArrowAnimation();t?this.playArrowAnimation():this.stopArrowAnimation()},dragFlag:function(t){t&&this.stopArrowAnimation()}},methods:{render:function(){this.renderLink()},rerender:function(){this.render()},destroy:function(){this.$link&&$(this.$link[0][0]).children().remove(),this.$link=null,this.sangle=0,this.tangle=0,this.length=0},renderLink:function(){var t=this.data;if(this.$link||(this.$link=d3.select(this.$refs.g)),this.csource=this.getCircleCenter(t.source),this.ctarget=this.getCircleCenter(t.target),this.csource&&!this.csource.hide&&this.ctarget&&!this.ctarget.hide){this.sangle=this.calAngle(this.csource,this.ctarget),this.tangle=this.sangle+Math.PI,t.source.symbol?(this.csource.x+=this.radius/2*Math.cos(this.sangle),this.csource.y+=this.radius/2*Math.sin(this.sangle)):(this.csource.x+=this.radius*Math.cos(this.sangle),this.csource.y+=this.radius*Math.sin(this.sangle)),t.target.symbol?(this.ctarget.x+=this.radius/2*Math.cos(this.tangle),this.ctarget.y+=this.radius/2*Math.sin(this.tangle)):(this.ctarget.x+=this.radius*Math.cos(this.tangle),this.ctarget.y+=this.radius*Math.sin(this.tangle));var e=this.needBezer(),i=this.getNodeSpace();if(this.bezerX=1===e?(this.csource.x+this.ctarget.x)/2:this.csource.x-i*this.radius,this.bezerY=1===e?this.csource.y-i*this.radius:(this.csource.y+this.ctarget.y)/2,e&&!this.data.notNeedBezerFlag)this.$link.select("path.bezer").empty()?this.$link.append("path").attr("d","M"+this.csource.x+","+this.csource.y+" Q"+this.bezerX+","+this.bezerY+" "+this.ctarget.x+","+this.ctarget.y).attr("class","bezer"):$(this.$link.select("path.bezer")[0][0]).remove();else{this.$link.select("line").empty()?this.$link.append("line").attr("x1",this.csource.x).attr("y1",this.csource.y).attr("x2",this.ctarget.x).attr("y2",this.ctarget.y):this.$link.select("line").attr("x1",this.csource.x).attr("y1",this.csource.y).attr("x2",this.ctarget.x).attr("y2",this.ctarget.y);var a=this.$link.select("path.bezer");a.empty()||$(a[0][0]).remove()}"MQ"!==t.source.type&&"MQ"!==t.target.type||this.$link.classed("dash",!0),e&&!this.data.notNeedBezerFlag?this.drawBezerArrow(this.csource,this.ctarget,{x:this.bezerX,y:this.bezerY}):this.drawLineArrow(this.csource,this.ctarget);var r=this.$link.select("text.line-text"),s=this.$link.select("text.line-text .adsFlowMapTextShadow"),n=this.$link.select("text.line-text .real");r.empty()&&(r=this.$link.append("text").attr("class","line-text"),s=r.append("tspan").attr("class","adsFlowMapTextShadow").style("text-anchor","middle").text(this.data.label),n=r.append("tspan").attr("class","real").text(this.data.label));var o=(this.csource.x+this.ctarget.x)/2,l=(this.csource.y+this.ctarget.y)/2;if(e&&!this.data.notNeedBezerFlag){var h=this.getBeZerPoint(this.csource,this.ctarget,{x:this.bezerX,y:this.bezerY},.5);r&&(r.attr("x",h.x).attr("y",h.y),s.attr("x",h.x).attr("y",h.y),n.attr("x",h.x).attr("y",h.y))}else r&&(r.attr("x",o).attr("y",l+3),s.attr("x",o).attr("y",l+3),n.attr("x",o).attr("y",l+3)),this.csource.x,this.ctarget.x;this.showTextFlag?r&&r.classed("hide",!1):r&&r.classed("hide",!0)}},drawLineArrow:function(t,e){var i,a,r,s,n,o,l,h,c,d,u,p,f,g;t.x===e.x?(a={x:t.x,y:t.y<e.y?t.y+this.arrowMargin:t.y-this.arrowMargin},r={x:t.x,y:t.y<e.y?t.y+this.arrowMargin-this.arrowLength:t.y-this.arrowMargin+this.arrowLength},s={x:t.x+this.arrowHeight,y:r.y},n={x:t.x-this.arrowHeight,y:r.y},l={x:t.x,y:t.y<e.y?e.y-this.arrowMargin:e.y+this.arrowMargin},o={x:t.x,y:t.y<e.y?e.y-this.arrowMargin+this.arrowLength:e.y+this.arrowMargin-this.arrowLength},h={x:t.x+this.arrowHeight,y:l.y},c={x:t.x-this.arrowHeight,y:l.y},this.playArrowP1={x:t.x,y:t.y<e.y?t.y+this.arrowLength:t.y-this.arrowLength},d={x:t.x,y:t.y},this.playArrowP2={x:t.x+this.arrowHeight,y:d.y},this.playArrowP3={x:t.x-this.arrowHeight,y:d.y},u={x:e.x,y:e.y},p={x:e.x,y:t.y<e.y?e.y-this.arrowLength:e.y+this.arrowLength},f={x:e.x+this.arrowHeight,y:p.y},g={x:e.x-this.arrowHeight,y:p.y}):t.y===e.y?(a={x:t.x<e.x?t.x+this.arrowMargin:t.x-this.arrowMargin,y:t.y},r={x:t.x<e.x?t.x+this.arrowMargin-this.arrowLength:t.x-this.arrowMargin+this.arrowLength,y:t.y},s={x:r.x,y:t.y+this.arrowHeight},n={x:r.x,y:t.y-this.arrowHeight},o={x:t.x<e.x?e.x-this.arrowMargin+this.arrowLength:e.x+this.arrowMargin-this.arrowLength,y:e.y},l={x:t.x<e.x?e.x-this.arrowMargin:e.x+this.arrowMargin,y:e.y},h={x:l.x,y:e.y+this.arrowHeight},c={x:l.x,y:e.y-this.arrowHeight},this.playArrowP1={x:t.x<e.x?t.x+this.arrowLength:t.x-this.arrowLength,y:t.y},d={x:t.x,y:t.y},this.playArrowP2={x:d.x,y:t.y+this.arrowHeight},this.playArrowP3={x:d.x,y:t.y-this.arrowHeight},u={x:e.x,y:e.y},p={x:t.x<e.x?e.x-this.arrowLength:e.x+this.arrowLength,y:e.y},f={x:p.x,y:e.y+this.arrowHeight},g={x:p.x,y:e.y-this.arrowHeight}):(i=this.getlinek(t,e),a=this.getPointByLine(i,this.arrowMargin,t,t.x<e.x?1:-1),r=this.getPointByLine(i,this.arrowMargin-this.arrowLength,t,t.x<e.x?1:-1),s=this.getPointByLine(-1/i,this.arrowHeight,r,1),n=this.getPointByLine(-1/i,this.arrowHeight,r,-1),o=this.getPointByLine(i,-this.arrowMargin+this.arrowLength,e,t.x<e.x?1:-1),l=this.getPointByLine(i,-this.arrowMargin,e,t.x<e.x?1:-1),h=this.getPointByLine(-1/i,this.arrowHeight,l,1),c=this.getPointByLine(-1/i,this.arrowHeight,l,-1),this.playArrowP1=this.getPointByLine(i,this.arrowLength,t,t.x<e.x?1:-1),d={x:t.x,y:t.y},this.playArrowP2=this.getPointByLine(-1/i,this.arrowHeight,d,1),this.playArrowP3=this.getPointByLine(-1/i,this.arrowHeight,d,-1),u={x:e.x,y:e.y},p=this.getPointByLine(i,this.arrowLength,e,t.x<e.x?-1:1),f=this.getPointByLine(-1/i,this.arrowHeight,p,1),g=this.getPointByLine(-1/i,this.arrowHeight,p,-1)),this.createArrow(a,s,n,"startArrow"),this.createArrow(o,h,c,"endArrow"),this.createArrow(this.playArrowP1,this.playArrowP2,this.playArrowP3,"playArrow"),this.stopArrowData=this.getArrowData(u,f,g)},drawBezerArrow:function(t,e,i){var a=this.getBeZerLength(t,e,i),r=this.getBeZerPoint(t,e,i,this.arrowMargin/a),s=this.getBeZerPoint(t,e,i,(this.arrowMargin-this.arrowLength)/a),n=this.getlinek(s,r),o=this.getPointByLine(-1/n,this.arrowHeight,s,1),l=this.getPointByLine(-1/n,this.arrowHeight,s,-1),h=this.getBeZerPoint(t,e,i,(a-this.arrowMargin+this.arrowLength)/a),c=this.getBeZerPoint(t,e,i,(a-this.arrowMargin)/a),d=this.getlinek(c,h),u=this.getPointByLine(-1/d,this.arrowHeight,c,1),p=this.getPointByLine(-1/d,this.arrowHeight,c,-1);this.playArrowP1=this.getBeZerPoint(t,e,i,this.arrowLength/a);var f=t;this.playArrowP2=this.getPointByLine(-1/n,this.arrowHeight,f,1),this.playArrowP3=this.getPointByLine(-1/n,this.arrowHeight,f,-1),this.createArrow(r,o,l,"startArrow"),this.createArrow(h,u,p,"endArrow"),this.createArrow(this.playArrowP1,this.playArrowP2,this.playArrowP3,"playArrow")},getBezerArrowPoint:function(t,e,i,a){var r=this.getBeZerLength(t,e,i),s=this.getBeZerPoint(t,e,i,(a*r+this.arrowLength)/r),n=this.getBeZerPoint(t,e,i,a),o=this.getlinek(n,s);return[s,this.getPointByLine(-1/o,this.arrowHeight,n,1),this.getPointByLine(-1/o,this.arrowHeight,n,-1)]},createArrow:function(t,e,i,a){var r=this.$link.select("path.arrow."+a);return r.empty()&&(r=this.$link.append("path").attr("class","arrow "+a)),this[a+"Data"]=this.getArrowData(t,e,i),r.attr("d",this[a+"Data"]),r},getArrowData:function(t,e,i){return"M"+t.x+" "+t.y+" L"+e.x+" "+e.y+" L"+i.x+" "+i.y+" Z"},getlinek:function(t,e){return e.x!==t.x&&(e.y-t.y)/(e.x-t.x)},getPointByLine:function(t,e,i,a){return!1===t?{x:i.x,y:i.y-a*e}:{x:i.x+a*(e/Math.sqrt(Math.pow(t,2)+1)),y:i.y+a*(t*e/Math.sqrt(Math.pow(t,2)+1))}},getBeZerPoint:function(t,e,i,a){return{x:Math.pow(1-a,2)*t.x+2*a*(1-a)*i.x+Math.pow(a,2)*e.x,y:Math.pow(1-a,2)*t.y+2*a*(1-a)*i.y+Math.pow(a,2)*e.y}},getBeZerLength:function(t,e,i){var a=t.x-2*i.x+e.x,r=t.y-2*i.y+e.y,s=2*i.x-2*t.x,n=2*i.y-2*t.y,o=4*(a*a+r*r),l=4*(a*s+r*n),h=s*s+n*n;return 1/(8*Math.pow(o,1.5))*(2*Math.sqrt(o)*(2*o*1*Math.sqrt(1*o*1+1*l+h)+l*(Math.sqrt(1*o*1+1*l+h)-Math.sqrt(h)))+(l*l-4*o*h)*(Math.log(l+2*Math.sqrt(o*h))-Math.log(l+2*o*1+2*Math.sqrt(o)*Math.sqrt(1*o*1+1*l+h))))},needBezer:function(){var t=this.isSameLineNotSide();return t||0},getNodeSpace:function(){var t=parseInt(this.data.source.domId.substr(5,2)),e=parseInt(this.data.source.domId.substr(8,2)),i=parseInt(this.data.target.domId.substr(5,2)),a=parseInt(this.data.target.domId.substr(8,2));return t===i&&e+1!==a&&e-1!==a?Math.abs(a-e):e===a&&t+1!==i&&t-1!==i?Math.abs(i-t):0},isSameLineNotSide:function(){var t=parseInt(this.data.source.domId.substr(5,2)),e=parseInt(this.data.source.domId.substr(8,2)),i=parseInt(this.data.target.domId.substr(5,2)),a=parseInt(this.data.target.domId.substr(8,2));return t===i&&e+1!==a&&e-1!==a?2:e===a&&t+1!==i&&t-1!==i?1:0},calAngle:function(t,e){var i=Math.atan((e.y-t.y)/(e.x-t.x));return i=t.x>e.x?Math.PI+i:i},getCircleCenter:function(t){var e=d3.select("g.node."+t.domId);if(e&&e.attr("transform")){var i=this.getOffsetByTransform(e.attr("transform"));if(t.symbol){var a=e.select(".node-core").attr("width");return i.x+=a/2,i.y+=a/2,i}return i}},getOffsetByTransform:function(t){var e=t.indexOf("translate"),i=t.substr(e+9),a=i.indexOf("("),r=i.indexOf(")");i=i.substr(a+1,r-a-1);var s=i.split(",");return 2!==s.length&&(s=i.split(" ")),{x:parseInt(s[0]),y:parseInt(s[1])}},showText:function(){$(".line-text",this.$link[0][0]).show()},hideText:function(){$(".line-text",this.$link[0][0]).hide()},playArrowAnimation:function(){var t=this.createArrow(this.playArrowP1,this.playArrowP2,this.playArrowP3,"playArrow"),e=this;if(this.hideArrow(),$("path.playArrow",this.$link[0][0]).show(),this.needBezer()&&!this.data.notNeedBezerFlag){this.arr=[];for(var i=e.playTime/1e3*60,a=0;a<i;a++){var r=e.getBezerArrowPoint(e.csource,e.ctarget,{x:e.bezerX,y:e.bezerY},a/i);this.arr.push(e.getArrowData(r[0],r[1],r[2]))}t.transition().duration(this.playTime).ease("linear").each("end",function(){t.attr("d",e.playArrowData),e.playArrowAnimation()}).attrTween("d",this.dTween)}else t.transition().duration(this.playTime).ease("linear").each("end",function(){t.attr("d",e.playArrowData),e.playArrowAnimation()}).attr("d",this.stopArrowData)},dTween:function(){var t=d3.scale.quantize().domain([0,1]).range(this.arr);return function(e){return t(e)}},stopArrowAnimation:function(){var t=this.$link.select(".playArrow");this.showArrow(),t.transition().remove(),this.createArrow(this.playArrowP1,this.playArrowP2,this.playArrowP3,"playArrow"),$(t[0][0]).hide()},hideArrow:function(){$("path.startArrow",this.$link[0][0]).hide(),$("path.endArrow",this.$link[0][0]).hide()},showArrow:function(){$("path.startArrow",this.$link[0][0]).show(),$("path.endArrow",this.$link[0][0]).show()}},created:function(){},mounted:function(){this.render(),this.$emit("onLinkFinished",this.data)},updated:function(){}}},618:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"topo-node",data:function(){return{$node:null,arc:null,pie:null,offsetX:0,offsetY:0}},props:{colors:{default:function(){return{normal:"#a9d86e",slow:"#86cae4",very_slow:"#fcb322",error:"#f58210",warning:"#86cae4",normality:"#86cae4",intolerance:"#f58210",healthy:"#a9d86e",crossApp:"#8b97a3"}}},attachmentRadius:{default:15},attachmentColor:{default:"#338cff"},attachmentTextOffset:{default:function(){return{x:2,y:3}}},attachmentSummary:{default:function(){return{show:!0,formatter:function(){},position:"left"}}},radius:{default:35},scale:{default:1},innerRadius:{default:22},bigFont:{default:function(){return{color:"#3e3d39",size:14}}},smallFont:{default:function(){return{color:"#3e3d39",size:12}}},data:{default:function(){return{}}},spaceCircleColor:{default:"white"},update:0},watch:{update:function(t){this.data.hide||(this.destroy(),this.render())},scale:function(t){this.scaleChange(t)}},methods:{render:function(){this.data.hide||(this.createNode(),this.renderNode())},destroy:function(){this.$node&&$(this.$node[0][0]).children().remove(),this.$node=null,this.arc=null,this.pie=null},createNode:function(){this.$node||(this.$node=d3.select(this.$refs.g).attr("transform","translate("+(this.radius+this.data.x)+","+(this.radius+this.data.y)+")"))},renderNode:function(){this.data.symbol?this.renderImg():(this.renderPie(),this.data.crossApp||this.renderAttachment())},renderPie:function(){var t=this.getPie(),e=this.getArc();this.data.crossApp&&(this.data.status=[{value:1,name:"crossApp"}]);var i=this.$node.selectAll("path.arc").data(t(this.data.status)),a=this.colors;i.enter().append("path").attr("class","arc node-core").attr("fill",function(t,e){return a[t.data.name]}),i.transition().attrTween("d",function(t){var i=this.__current__;i||(i={startAngle:0,endAngle:0});var a=d3.interpolate(i,t);return this.__current__=a(1),function(t){return e(a(t))}}),this.$node.append("circle").attr("cx",0).attr("cy",0).attr("r",this.innerRadius).attr("fill",this.spaceCircleColor),this.data.crossApp||this.$node.append("text").attr("class","instances").attr("text-anchor","middle").attr("y",5).text((this.data.activeInstances?this.data.activeInstances:0)+"/"+(this.data.instances?this.data.instances:0)),this.$node.append("text").attr("class","pie-name").attr("y",this.radius+15).attr("fill",this.smallFont.color).style("text-anchor","middle").text(this.data.showName),this.data.crossApp||this.renderSummary(this.$node,this.radius)},renderImg:function(){var t=2*this.radius*(2/3);this.$node.append("image").attr("class","node-core").attr("width",t).attr("height",t).attr("xlink:href",this.resolveImgUrl(this.data.symbol)),this.$node.append("text").attr("class","pie-name").attr("y",t+10).attr("fill",this.smallFont.color).style("text-anchor","middle").attr("transform","translate("+t/2+")").text(this.data.showName),this.renderSummary(this.$node,t,1*t/3)},renderSummary:function(t,e,i){if(this.attachmentSummary.show){var a=this.attachmentSummary.formatter(this.data);if(a instanceof Array&&a.length>0){var r=t.append("text").attr("class","pie-summary").attr("x",e).attr("fill",this.smallFont.color);a.forEach(function(t){r.append("tspan").attr("x",e+10).attr("class","adsFlowMapTextShadow").attr("dy",13).text(t),r.append("tspan").attr("x",e+10).text(t)});var s=13*a.length;i?r.attr("y",i):r.attr("y",-s/2)}}},renderAttachment:function(){var t=-this.radius,e=this.radius-this.attachmentRadius;this.$node.append("circle").attr("class","attachement").attr("fill",this.attachmentColor).attr("cx",t).attr("cy",e).attr("r",this.attachmentRadius),this.$node.append("text").attr("class","attachement-text").attr("fill","white").attr("x",t-this.attachmentRadius+2).attr("y",e+3).text(this.data.serverName)},getArc:function(){return this.arc?this.arc:(this.arc=d3.svg.arc().outerRadius(this.radius).innerRadius(this.innerRadius),this.arc)},getPie:function(){return this.pie?this.pie:(this.pie=d3.layout.pie().value(function(t){return t.value}),this.pie)},resolveImgUrl:function(t){var e=t.indexOf("image://");return e>=0?t.substr(e+8):t},addEvent:function(){var t=this;this.$node.call(d3.behavior.drag().on("drag",function(){d3.event.sourceEvent.offsetX===t.offsetX&&d3.event.sourceEvent.offsetY===t.offsetY||(t.dragFlag||setTimeout(function(){t.dragFlag=!0},200),d3.select(this).attr("transform",function(t){return"translate("+d3.event.x+", "+d3.event.y+")"}),t.data.x=d3.event.x,t.data.y=d3.event.y,t.$emit("onNodeMove",t.data))}).on("dragstart",function(e){t.offsetX=d3.event.sourceEvent.offsetX,t.offsetY=d3.event.sourceEvent.offsetY,d3.event.sourceEvent.stopPropagation(),t.$emit("onMouseDown",t.data,d3.event.sourceEvent)}).on("dragend",function(){t.offsetX=0,t.offsetY=0,t.$emit("onMouseUp",t.data,d3.event.sourceEvent,t.dragFlag),t.dragFlag=!1}))},parseTransform:function(t){t=t.substr(10),t=t.substr(0,t.length-1);var e=t.split(",");return e&&2===e.length||(e=t.split(" ")),e[0]=parseFloat(e[0]),e[1]=parseFloat(e[1]),e},scaleChange:function(t){},onEnterNode:function(t){this.$emit("onEnterNode",this.data,t)},onLeaveNode:function(t){this.$emit("onLeaveNode",this.data,t)}},mounted:function(){this.data.hide||(this.render(),this.addEvent())}}},619:function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(627),s=a(r),n=i(626),o=a(n),l=i(35);e.default={name:"topo",components:{TopoNode:s.default,TopoLink:o.default,"el-button":l.Button,"el-table":l.Table,"el-table-column":l.TableColumn,"el-input":l.Input,"el-form":l.Form,"el-form-item":l.FormItem,"el-dialog":l.Dialog,"el-pagination":l.Pagination,"el-breadcrumb":l.Breadcrumb,"el-breadcrumb-item":l.BreadcrumbItem,"el-switch":l.Switch,"el-tooltip":l.Tooltip,"el-tag":l.Tag,"el-checkbox":l.Checkbox},data:function(){return{lineTextFlag:!0,bezerFlag:!0,linkFinishedNum:0,scale:this.data.scale||1,translate:[0,0],scaleScales:null,pixelScales:null,maxMargin:0,sliderTop:1,scaleRange:[.35,3],topo_z:null,updateNode:0,updateLink:0,tooltip:{show:!1,left:0,top:0,delay:0},nodeDetailVisible:!1,modal:!1,tierList:[]}},props:{data:{default:function(){return{}}},radius:{default:35},innerRadius:23,attachmentRadius:15,update:0,attachmentSummary:{show:!0,formatter:function(t){},position:"left"},fullbtnDisplay:{default:!0},setFullScreen:{default:!1}},watch:{data:function(t){t.scale&&(this.scaleRange[0]<t.scale&&(this.scaleRange[0]=t.scale),this.scale=t.scale),(t.offsetLeft||t.offsetTop)&&(this.translate[0]=t.offsetLeft?t.offsetLeft:0,this.translate[1]=t.offsetTop?t.offsetTop:0,d3.select(this.$refs["topo-container"]).attr("transform","translate("+this.translate+") scale("+[this.scale,this.scale]+")"),this.topo_z.translate(this.translate))},update:function(t){this.updateNode=t,this.updateLink=t,this.zoom(this.scale)},scale:function(t){this.zoom(t)},sliderTop:function(t){this.setSliderTop(t)},setFullScreen:function(t){t&&this.fullScreen(),this.$emit("onFullScreenChange",t)}},methods:{resetContainer:function(){d3.select(this.$refs["topo-container"]).attr("transform","translate(0, 0) scale(1)")},render:function(){var t=this,e=$(t.$refs.slider).height(),i=$(t.$refs["slider-thumb"]).height();this.maxMargin=e-i;var a=t.scaleRange[1],r=t.scaleRange[0],s=this.maxMargin;this.scaleScales=t.getScaleRelation(1,s,a,r),this.pixelScales=t.getScaleRelation(a,r,1,s),this.computeSliderTop(),$(this.$refs.fullscreen).hover(function(){$(this).attr("src","/static/images/maximize_blue.svg")},function(){$(this).attr("src","/static/images/maximize_gray.svg")})},adjustLink:function(){var t=$(this.$refs["topo-container"]);$("g.link",this.$refs["topo-svg"]).each(function(e,i){$(i).remove(),t.prepend(i)})},addEvent:function(){var t=this;this.topo_z=d3.behavior.zoom().scaleExtent(t.scaleRange).on("zoom",this.zoom),d3.select(t.$refs["topo-svg"]).call(this.topo_z).on("dblclick.zoom",null),this.dispatch=d3.dispatch("mousewheel"),this.dispatch.on("mousewheel",this.zoom),window.addEventListener("resize",function(){t.fullstatus&&t.fullScreen()})},zoom:function(t,e){var i=t||d3.event.scale,a=this;i>.88?(this.lineTextFlag=!0,setTimeout(function(){$(".line-text",a.$refs["topo-svg"]).show(),$(".pie-summary",a.$refs["topo-svg"]).show(),$(".attachement-text",a.$refs["topo-svg"]).show(),$(".attachement",a.$refs["topo-svg"]).show()},100)):(setTimeout(function(){$(".line-text",a.$refs["topo-svg"]).hide(),$(".pie-summary",a.$refs["topo-svg"]).hide(),$(".attachement-text",a.$refs["topo-svg"]).hide(),$(".attachement",a.$refs["topo-svg"]).hide()},100),this.lineTextFlag=!1),i>.68?setTimeout(function(){$(".pie-name",a.$refs["topo-svg"]).show()},100):setTimeout(function(){$(".pie-name",a.$refs["topo-svg"]).hide()},100);var r=d3.transform(d3.select(a.$refs["topo-container"]).attr("transform"));if(this.scale!==i||t||(this.translate=[r.translate[0],r.translate[1]]),this.tooltip.show=!1,!d3.event&&e){d3.select(a.$refs["topo-container"]).attr("transform","scale("+[i,i]+")");var s=a.$refs["topo-container"].getBoundingClientRect(),n=[this.translate[0]+(this.data.scale-i)*(s.width/2)/i,this.translate[1]+(this.data.scale-i)*(s.height/2)/i];d3.select(a.$refs["topo-container"]).attr("transform","translate("+n+") scale("+[i,i]+")"),this.topo_z.translate(n)}else d3.select(a.$refs["topo-container"]).attr("transform","translate("+(d3.event?d3.event.translate:r.translate)+") scale("+[i,i]+")"),this.topo_z.translate(d3.event?d3.event.translate:r.translate);this.scale=i,this.topo_z.scale(this.scale),this.computeSliderTop()},setSliderTop:function(t){$(this.$refs["slider-thumb"]).css("margin-top",t+"px")},computeSliderTop:function(){this.sliderTop=this.pixelScales[0]*this.scale+this.pixelScales[1],this.sliderTop=this.sliderTop<1?1:this.sliderTop,this.sliderTop=this.sliderTop>this.maxMargin?this.maxMargin:this.sliderTop},computeScale:function(){return this.scaleScales[0]*this.sliderTop+this.scaleScales[1]},onNodeMove:function(t,e){if(this.data.links){t.drillDown&&1*new Date-this.tooltip.delay>100&&(this.tooltip.show=!1,this.tooltip.delay=1*new Date);this.getLinksByNode(t).forEach(function(t,e){t.change++,t.notNeedBezerFlag=!0}),this.$emit("onNodeMove",t,e)}},onMouseDown:function(t,e){if(this.data.links){this.getLinksByNode(t).forEach(function(t,e){t.dragFlag=!0}),this.$emit("onMouseDownNode",t,e)}},onMouseUp:function(t,e,i){if(this.data.links){this.getLinksByNode(t).forEach(function(t,e){t.dragFlag=!1}),i||this.$emit("onMouseUpNode",t,e),!i&&t.list&&t.list.length>1&&(this.tierList=t.list,this.nodeDetailVisible=!0)}},onLinkFinished:function(t,e){this.linkFinishedNum++,this.linkFinishedNum===this.data.links.length&&(this.adjustLink(),this.linkFinishedNum=0),this.$emit("onLinkFinished",t,e)},closeDialog:function(){this.nodeDetailVisible=!1},onEnterNode:function(t,e){if(e=e||window.event,this.data.links){var i=e.target.getBoundingClientRect(),a=$(this.$refs["topo-svg"]).offset();t.drillDown&&(this.tooltip.left=i.left-a.left+i.width/20*this.scale,this.tooltip.top=i.top-a.top-$(this.$refs.tooltip).height()-10,this.tooltip.show=!0,this.tooltip.delay=1*new Date);this.getLinksByNode(t).forEach(function(t,e){t.play=!0}),this.$emit("onEnterNode",t,e)}},parseTransform:function(t){if(t){t=t.substr(10),t=t.substr(0,t.length-1);var e=t.split(",");return e&&2===e.length||(e=t.split(" ")),e[0]=parseFloat(e[0]),e[1]=parseFloat(e[1]),e}},onLeaveNode:function(t,e){if(this.data.links){t.drillDown&&1*new Date-this.tooltip.delay>100&&(this.tooltip.show=!1,this.tooltip.delay=1*new Date);this.getLinksByNode(t).forEach(function(t,e){t.play=!1}),this.$emit("onLeaveNode",t,e)}},onSliderDown:function(t){var e=this,i=t.clientY;document.onmousemove=function(t){var a=t.clientY-i;e.sliderTop+=a,e.sliderTop=e.sliderTop<1?1:e.sliderTop,e.sliderTop=e.sliderTop>e.maxMargin?e.maxMargin:e.sliderTop;var r=e.computeScale();i=t.clientY,e.dispatch&&e.dispatch.mousewheel(r,!0)},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null}},fullScreen:function(t){var e=$("body").width(),i=$("body").height();$(this.$refs.topo).width(e),$(this.$refs.topo).height(i),$(this.$refs.topo).addClass("full"),$(this.$refs.fullscreen).hide(),$(this.$refs.restore).show(),this.fullstatus=!0},restore:function(t){$(this.$refs.topo).width("100%"),$(this.$refs.topo).height("100%"),$(this.$refs.topo).removeClass("full"),$(t.target).hide(),$(this.$refs.fullscreen).show(),this.$emit("onFullScreenChange",!1),this.fullstatus=!1},getScaleRelation:function(t,e,i,a){return[(a-i)/(e-t),i-t*(a-i)/(e-t)]},getLinksByNode:function(t){for(var e=[],i=0;i<this.data.links.length;i++){var a=this.data.links[i];a.source.domId!==t.domId&&a.target.domId!==t.domId||e.push(a)}return e}},created:function(){},mounted:function(){this.render(),this.addEvent()},updated:function(){var t=this,e=this.$refs.topo.clientHeight,i=parseInt($(t.$refs.slider).css("top")),a=e-2*i;e<=0||(e<2*i+$(t.$refs.slider).height()&&($(t.$refs.slider).height(a),this.render()),$(t.$refs.slider).show())}}},620:function(t,e,i){e=t.exports=i(566)(),e.push([t.i,"@keyframes down{0%{transform:translateY(0)}20%{transform:translateY(-2px)}50%{transform:translateY(2px)}75%{transform:translateY(1px)}to{transform:translateY(0)}}.topo.full[data-v-2a8bfc5e]{position:fixed;top:0;left:0;right:0;bottom:0;z-index:1000;background:#fff}.topo[data-v-2a8bfc5e]{width:100%;height:100%;position:relative;moz-user-select:-moz-none;-moz-user-select:none;-o-user-select:none;-khtml-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.topo svg[data-v-2a8bfc5e]{width:100%;height:100%}.topo svg g.node[data-v-2a8bfc5e]:hover{cursor:pointer}.tooltip[data-v-2a8bfc5e]{position:absolute;float:left;left:-100000px;top:-100000;background-color:#fff;border-radius:5px;box-shadow:1px 1px 1px 1px #ccc;line-height:22px;padding:5px 10px}.tooltip i[data-v-2a8bfc5e]{font-size:18px;display:inline-block;vertical-align:middle;margin-bottom:2px;border-bottom:2px solid #ccc;box-sizing:border-box}.tooltip.show i[data-v-2a8bfc5e]{animation:down .5s ease-in;animation-delay:.5s;animation-iteration-count:2}.fade-enter-active[data-v-2a8bfc5e]{transition:all .5s ease}.fade-leave-active[data-v-2a8bfc5e]{transition:all 0s ease}.fade-enter[data-v-2a8bfc5e],.fade-leave-active[data-v-2a8bfc5e]{opacity:0}.topo .slider[data-v-2a8bfc5e]{width:10px;height:200px;position:absolute;top:50px;left:15px;background:#f5f5f5;border:1px solid #d7d7d7;border-radius:12px;display:none}.topo .slider .slider-thumb[data-v-2a8bfc5e]{width:12px;height:12px;border-radius:12px;background:#9aa3b2;margin-left:-2px;margin-top:1px;box-shadow:2px 2px 2px 2px hsla(0,0%,100%,.8);cursor:pointer}.topo .toolbar[data-v-2a8bfc5e]{position:absolute;top:10px;right:10px}.topo .toolbar img[data-v-2a8bfc5e]{cursor:pointer}.topo .toolbar .restore[data-v-2a8bfc5e]{display:none}",""])},621:function(t,e,i){e=t.exports=i(566)(),e.push([t.i,'.link line{stroke:#2693ff;stroke-width:1}.link.dash line{stroke-dasharray:3}.link line:hover{stroke-width:2}.hide,.link path.arrow.playArrow{display:none}.link path.bezer{fill:none;stroke:#2693ff;stroke-width:1}.link.dash path.bezer{stroke-dasharray:3}.link path.bezer:hover{stroke-width:2}.link path.arrow{fill:#2693ff}.link .line-text{font-size:10px;font-weight:"normal";font-style:"-apple-system,Microsoft Yahei,system-ui,BlinkMacSystemFont,Open Sans,Hiragino Sans GB,sans-serif";color:"#000"}.adsFlowMapTextShadow{stroke:#fff;stroke-width:4px;stroke-opacity:.8;fill:#fff;fill-opacity:1;font-size:10px}.real{text-anchor:middle;font-size:10px}',""])},622:function(t,e,i){e=t.exports=i(566)(),e.push([t.i,".instances{font-size:18px}.adsFlowMapTextShadow{stroke:#fff;stroke-width:4px;stroke-opacity:.8;fill:#fff;fill-opacity:1}.pie-summary{font-size:10px}",""])},623:function(t,e,i){var a=i(620);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i(567)("ab196eaa",a,!0)},624:function(t,e,i){var a=i(621);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i(567)("0417ee2e",a,!0)},625:function(t,e,i){var a=i(622);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i(567)("812a4628",a,!0)},626:function(t,e,i){i(624);var a=i(54)(i(617),i(630),null,null);t.exports=a.exports},627:function(t,e,i){i(625);var a=i(54)(i(618),i(631),null,null);t.exports=a.exports},628:function(t,e,i){i(638);var a=i(54)(i(636),i(643),null,null);t.exports=a.exports},629:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"topo",staticClass:"topo"},[i("svg",{ref:"topo-svg",staticClass:"topo-svg"},[i("g",{ref:"topo-container",staticClass:"topo-container"},[t._l(t.data.nodes,function(e){return t.data.nodes?i("topo-node",{key:e.domId,attrs:{data:e,radius:t.radius,innerRadius:t.innerRadius,attachmentRadius:t.attachmentRadius,attachmentSummary:t.attachmentSummary,update:t.updateNode,scale:t.scale},on:{onNodeMove:t.onNodeMove,"!onEnterNode":function(e){t.onEnterNode(e)},"!onLeaveNode":function(e){t.onLeaveNode(e)},onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp}}):t._e()}),t._v(" "),t._l(t.data.links,function(e){return t.data.links?i("topo-link",{key:e.id,attrs:{data:e,change:e.change,showTextFlag:t.lineTextFlag,bezerFlag:t.bezerFlag,play:e.play,dragFlag:e.dragFlag,update:t.updateLink,radius:t.radius,scale:t.scale},on:{onLinkFinished:t.onLinkFinished}}):t._e()})],2)]),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.tooltip.show,expression:"tooltip.show"}],ref:"tooltip",staticClass:"tooltip",class:{show:t.tooltip.show},style:{left:t.tooltip.left+"px",top:t.tooltip.top+"px"}},[i("i",{staticClass:"icon ion-android-arrow-down theme-font-color-primary",staticStyle:{"font-size":"20px"}}),t._v("点击下钻\n        ")])]),t._v(" "),i("div",{ref:"slider",staticClass:"slider"},[i("div",{ref:"slider-thumb",staticClass:"slider-thumb",on:{mousedown:t.onSliderDown}})]),t._v(" "),i("div",{ref:"toolbar",staticClass:"toolbar"},[t.fullbtnDisplay?i("img",{ref:"fullscreen",staticClass:"fullscreen",attrs:{src:"/static/images/maximize_gray.svg"},on:{click:t.fullScreen}}):t._e(),t._v(" "),i("img",{ref:"restore",staticClass:"restore",attrs:{src:"/static/images/minimize_gray.svg"},on:{click:t.restore}})]),t._v(" "),i("el-dialog",{attrs:{width:"60%",title:"节点详情","modal-append-to-body":t.modal,visible:t.nodeDetailVisible},on:{"update:visible":function(e){t.nodeDetailVisible=e}}},[i("el-table",{staticClass:"list-table",staticStyle:{width:"100%"},attrs:{data:t.tierList,"max-height":"400","default-sort":{prop:"elapsedTime",order:"descending"}}},[i("el-table-column",{attrs:{prop:"tiersName",label:"调用者Tier"}}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"远程调用",sortable:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"elapsedTime",label:"平均响应时间(ms)",sortable:""}})],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.closeDialog}},[t._v("确定")])],1)],1)],1)},staticRenderFns:[]}},630:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("g",{ref:"g",staticClass:"link",class:t.data.id})},staticRenderFns:[]}},631:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("g",{ref:"g",staticClass:"node",class:t.data.domId,on:{mouseenter:t.onEnterNode,mouseleave:t.onLeaveNode}})},staticRenderFns:[]}},632:function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},633:function(t,e,i){var a=i(55),r=i(66),s=i(612);t.exports=function(t,e){if(a(t),r(e)&&e.constructor===t)return e;var i=s.f(t);return(0,i.resolve)(e),i.promise}},634:function(t,e,i){var a=i(55),r=i(203),s=i(25)("species");t.exports=function(t,e){var i,n=a(t).constructor;return void 0===n||void 0==(i=a(n)[s])?e:r(i)}},635:function(t,e,i){var a,r,s,n=i(141),o=i(665),l=i(206),h=i(142),c=i(36),d=c.process,u=c.setImmediate,p=c.clearImmediate,f=c.MessageChannel,g=c.Dispatch,v=0,m={},y=function(){var t=+this;if(m.hasOwnProperty(t)){var e=m[t];delete m[t],e()}},x=function(t){y.call(t.data)};u&&p||(u=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return m[++v]=function(){o("function"==typeof t?t:Function(t),e)},a(v),v},p=function(t){delete m[t]},"process"==i(92)(d)?a=function(t){d.nextTick(n(y,t,1))}:g&&g.now?a=function(t){g.now(n(y,t,1))}:f?(r=new f,s=r.port2,r.port1.onmessage=x,a=n(s.postMessage,s,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(a=function(t){c.postMessage(t+"","*")},c.addEventListener("message",x,!1)):a="onreadystatechange"in h("script")?function(t){l.appendChild(h("script")).onreadystatechange=function(){l.removeChild(this),y.call(t)}}:function(t){setTimeout(n(y,t,1),0)}),t.exports={set:u,clear:p}},636:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(35);e.default={components:{"el-tree":a.Tree},props:{datas:{type:Array,required:!0}},watch:{datas:{deep:!0,handler:function(t){this.formatData(t)}}},data:function(){return{processedData:[]}},mounted:function(){},methods:{toLinearData:function(t){var e=t||[],i=[],a=[];return function t(e){e.map(function(e){i.push(e.value),a.push(e.agentName),t(e.child)})}(e),e.timeArr=i,e.nameArr=a,e},keyRename:function(t){var e=t||[];return function t(e){e.map(function(e){e.label=e.name,e.children=e.child,t(e.child)})}(e),e},formatData:function(t){var e=this,i=[];t.map(function(t,a){var r=e.keyRename([t]),s=e.toLinearData([t]);i.push({trees:r,values:s.timeArr,names:s.nameArr})}),this.processedData=i}}}},637:function(t,e,i){e=t.exports=i(566)(),e.push([t.i,'.table-tree{max-height:350px;overflow-y:auto}.table-tree th{border:1px solid #dfe9ec;background:#eef3f6;height:40px;padding:0 18px}.table-tree td{padding:20px;border:1px solid #dfe9ec}.table-tree li{line-height:36px;height:36px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.table-tree .el-tree{border:none}.table-tree .el-tree-node__content{cursor:inherit}.table-tree .el-tree-node__content:hover{background:none}.table-tree .el-tree-node__label{max-width:700px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.table-tree .el-tree-node__label:before{content:" ";float:left;margin-top:14px;margin-right:5px;width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:10px solid #97a8be}.table-tree .el-tree-node__expand-icon{display:none}',""])},638:function(t,e,i){var a=i(637);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i(567)("48293184",a,!0)},643:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"table-tree"},[i("table",{staticClass:"mt20",attrs:{width:"100%"}},[t._m(0),t._v(" "),i("tbody",t._l(t.processedData,function(e,a){return i("tr",{key:a},[i("td",[i("el-tree",{attrs:{data:e.trees,"default-expand-all":!0,"expand-on-click-node":!1}})],1),t._v(" "),i("td",[i("ul",t._l(e.values,function(e,a){return i("li",{key:a},[t._v(t._s(e))])}))]),t._v(" "),i("td",[i("ul",t._l(e.names,function(e,a){return i("li",{key:a},[t._v(t._s(e))])}))])])}))])])},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("thead",[i("tr",[i("th",{attrs:{width:"50%"}},[t._v("方法名")]),t._v(" "),i("th",{attrs:{width:"25%"}},[t._v("执行时间(ms)")]),t._v(" "),i("th",{attrs:{width:"25%"}},[t._v("实例名")])])])}]}},644:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=function(){this.root=null,this.data={},this.nodes=null,this.links=null,this.col=0,this.row=0,this.hspace=250,this.vspace=50,this.type="",this.cell={width:100,height:100},this.offsetWidth=0,this.offsetHeight=0,this.rootWidth=0,this.rootHeight=0,this.map={}};a.prototype.init=function(){this.row=0,this.col=0,this.hspace=250,this.vspace=50,this.type="",this.cell={width:100,height:100},this.offsetWidth=0,this.offsetHeight=0,this.rootWidth=this.root.offsetWidth,this.rootHeight=this.root.offsetHeight},a.prototype.layout=function(t,e,i){t&&(this.root=t,this.data=e,this.nodes=e.nodes,this.links=e.links,this.type=i||"grid",this.init(),this.parseNodes(),this.adjust(),this.calNodesLocation(),this.calScale())},a.prototype.parseNodes=function(){if(this.root&&this.nodes){for(var t={},e=0;e<this.nodes.length;e++){var i=this.nodes[e];t[i.group]||(this.col++,t[i.group]=0),t[i.group]=t[i.group]+1,this.row<t[i.group]&&(this.row=t[i.group])}this.map=t}},a.prototype.calNodesLocation=function(){if(this.root&&this.nodes)for(var t=0;t<this.nodes.length;t++){var e=this.nodes[t],i=this.getGrid(e);e.x=i[0]*(this.hspace+this.cell.width),e.y=i[1]*(this.vspace+this.cell.height)+(e.innerRadius?e.innerRadius:0)}},a.prototype.calScale=function(){for(var t=1;;){var e=this.rootWidth-(this.col*this.cell.width+(this.col-1)*this.hspace)*t,i=this.rootHeight-(this.row*this.cell.height+(this.row-1)*this.vspace)*t;if(e>=0&&i>=0)break;t=.87;break}this.data.scale=t},a.prototype.adjust=function(){this.offsetWidth=this.rootWidth-this.col*this.cell.width-(this.col-1)*this.hspace,this.offsetHeight=this.rootHeight-this.row*this.cell.height-(this.row-1)*this.vspace,this.offsetWidth=this.offsetWidth<0?0:this.offsetWidth/3,this.offsetHeight=this.offsetHeight<0?0:this.offsetHeight/2,this.data.offsetLeft=this.offsetWidth,this.data.offsetTop=this.offsetHeight},a.prototype.getGrid=function(t){return[parseInt(t.domId.substr(5,2)),parseInt(t.domId.substr(8,2))]},e.default=a},661:function(t,e,i){t.exports={default:i(662),__esModule:!0}},662:function(t,e,i){i(210),i(95),i(145),i(669),i(670),i(671),t.exports=i(24).Promise},663:function(t,e){t.exports=function(t,e,i,a){if(!(t instanceof e)||void 0!==a&&a in t)throw TypeError(i+": incorrect invocation!");return t}},664:function(t,e,i){var a=i(141),r=i(208),s=i(207),n=i(55),o=i(143),l=i(144),h={},c={},e=t.exports=function(t,e,i,d,u){var p,f,g,v,m=u?function(){return t}:l(t),y=a(i,d,e?2:1),x=0;if("function"!=typeof m)throw TypeError(t+" is not iterable!");if(s(m)){for(p=o(t.length);p>x;x++)if((v=e?y(n(f=t[x])[0],f[1]):y(t[x]))===h||v===c)return v}else for(g=m.call(t);!(f=g.next()).done;)if((v=r(g,y,f.value,e))===h||v===c)return v};e.BREAK=h,e.RETURN=c},665:function(t,e){t.exports=function(t,e,i){var a=void 0===i;switch(e.length){case 0:return a?t():t.call(i);case 1:return a?t(e[0]):t.call(i,e[0]);case 2:return a?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return a?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return a?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}return t.apply(i,e)}},666:function(t,e,i){var a=i(36),r=i(635).set,s=a.MutationObserver||a.WebKitMutationObserver,n=a.process,o=a.Promise,l="process"==i(92)(n);t.exports=function(){var t,e,i,h=function(){var a,r;for(l&&(a=n.domain)&&a.exit();t;){r=t.fn,t=t.next;try{r()}catch(a){throw t?i():e=void 0,a}}e=void 0,a&&a.enter()};if(l)i=function(){n.nextTick(h)};else if(!s||a.navigator&&a.navigator.standalone)if(o&&o.resolve){var c=o.resolve();i=function(){c.then(h)}}else i=function(){r.call(a,h)};else{var d=!0,u=document.createTextNode("");new s(h).observe(u,{characterData:!0}),i=function(){u.data=d=!d}}return function(a){var r={fn:a,next:void 0};e&&(e.next=r),t||(t=r,i()),e=r}}},667:function(t,e,i){var a=i(57);t.exports=function(t,e,i){for(var r in e)i&&t[r]?t[r]=e[r]:a(t,r,e[r]);return t}},668:function(t,e,i){"use strict";var a=i(36),r=i(24),s=i(39),n=i(56),o=i(25)("species");t.exports=function(t){var e="function"==typeof r[t]?r[t]:a[t];n&&e&&!e[o]&&s.f(e,o,{configurable:!0,get:function(){return this}})}},669:function(t,e,i){"use strict";var a,r,s,n,o=i(93),l=i(36),h=i(141),c=i(205),d=i(65),u=i(66),p=i(203),f=i(663),g=i(664),v=i(634),m=i(635).set,y=i(666)(),x=i(612),w=i(632),b=i(633),_=l.TypeError,$=l.process,k=l.Promise,T="process"==c($),A=function(){},M=r=x.f,L=!!function(){try{var t=k.resolve(1),e=(t.constructor={})[i(25)("species")]=function(t){t(A,A)};return(T||"function"==typeof PromiseRejectionEvent)&&t.then(A)instanceof e}catch(t){}}(),P=function(t){var e;return!(!u(t)||"function"!=typeof(e=t.then))&&e},S=function(t,e){if(!t._n){t._n=!0;var i=t._c;y(function(){for(var a=t._v,r=1==t._s,s=0;i.length>s;)!function(e){var i,s,n=r?e.ok:e.fail,o=e.resolve,l=e.reject,h=e.domain;try{n?(r||(2==t._h&&N(t),t._h=1),!0===n?i=a:(h&&h.enter(),i=n(a),h&&h.exit()),i===e.promise?l(_("Promise-chain cycle")):(s=P(i))?s.call(i,o,l):o(i)):l(a)}catch(t){l(t)}}(i[s++]);t._c=[],t._n=!1,e&&!t._h&&C(t)})}},C=function(t){m.call(l,function(){var e,i,a,r=t._v,s=I(t);if(s&&(e=w(function(){T?$.emit("unhandledRejection",r,t):(i=l.onunhandledrejection)?i({promise:t,reason:r}):(a=l.console)&&a.error&&a.error("Unhandled promise rejection",r)}),t._h=T||I(t)?2:1),t._a=void 0,s&&e.e)throw e.v})},I=function(t){return 1!==t._h&&0===(t._a||t._c).length},N=function(t){m.call(l,function(){var e;T?$.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},F=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),S(e,!0))},z=function(t){var e,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw _("Promise can't be resolved itself");(e=P(t))?y(function(){var a={_w:i,_d:!1};try{e.call(t,h(z,a,1),h(F,a,1))}catch(t){F.call(a,t)}}):(i._v=t,i._s=1,S(i,!1))}catch(t){F.call({_w:i,_d:!1},t)}}};L||(k=function(t){f(this,k,"Promise","_h"),p(t),a.call(this);try{t(h(z,this,1),h(F,this,1))}catch(t){F.call(this,t)}},a=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},a.prototype=i(667)(k.prototype,{then:function(t,e){var i=M(v(this,k));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=T?$.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&S(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),s=function(){var t=new a;this.promise=t,this.resolve=h(z,t,1),this.reject=h(F,t,1)},x.f=M=function(t){return t===k||t===n?new s(t):r(t)}),d(d.G+d.W+d.F*!L,{Promise:k}),i(94)(k,"Promise"),i(668)("Promise"),n=i(24).Promise,d(d.S+d.F*!L,"Promise",{reject:function(t){var e=M(this);return(0,e.reject)(t),e.promise}}),d(d.S+d.F*(o||!L),"Promise",{resolve:function(t){return b(o&&this===n?k:this,t)}}),d(d.S+d.F*!(L&&i(209)(function(t){k.all(t).catch(A)})),"Promise",{all:function(t){var e=this,i=M(e),a=i.resolve,r=i.reject,s=w(function(){var i=[],s=0,n=1;g(t,!1,function(t){var o=s++,l=!1;i.push(void 0),n++,e.resolve(t).then(function(t){l||(l=!0,i[o]=t,--n||a(i))},r)}),--n||a(i)});return s.e&&r(s.v),i.promise},race:function(t){var e=this,i=M(e),a=i.reject,r=w(function(){g(t,!1,function(t){e.resolve(t).then(i.resolve,a)})});return r.e&&a(r.v),i.promise}})},670:function(t,e,i){"use strict";var a=i(65),r=i(24),s=i(36),n=i(634),o=i(633);a(a.P+a.R,"Promise",{finally:function(t){var e=n(this,r.Promise||s.Promise),i="function"==typeof t;return this.then(i?function(i){return o(e,t()).then(function(){return i})}:t,i?function(i){return o(e,t()).then(function(){throw i})}:t)}})},671:function(t,e,i){"use strict";var a=i(65),r=i(612),s=i(632);a(a.S,"Promise",{try:function(t){var e=r.f(this),i=s(t);return(i.e?e.reject:e.resolve)(i.v),e.promise}})},690:function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=i(91),s=a(r),n=i(204),o=a(n),l=i(661),h=a(l),c=i(202),d=i(616),u=a(d),p=i(644),f=a(p),g=i(606),v=a(g),m=i(607),y=a(m),x=i(35);e.default={mixins:[y.default,v.default],data:function(){var t=this;return{fullScreen:!1,transInfo:{apdex:"",transName:"",responseTime:0,startTime:""},dangers:[],topo:{layout:"grid",update:0,data:{},fullbtnDisplay:!1,nodeTip:{show:!1,left:0,top:0},attachmentSummary:{show:!0,formatter:function(e){return t.nodeSummary(e)},position:"left"}},transGridData:[],dialogTransTableVisible:!1,apdexIconClass:"",apdexTitle:"",totalElapsedTime:0}},components:{"el-table":x.Table,"el-table-column":x.TableColumn,"table-tree":i(628),"el-button":x.Button,"el-tag":x.Tag,"el-progress":x.Progress,"el-dialog":x.Dialog,Topo:u.default},watch:{"transInfo.apdex":function(t){if(t){var e=this.convertApdex(t);this.apdexIconClass=e.apdexIconClass,this.apdexTitle=e.apdexTitle}}},mounted:function(){this.reload()},methods:{setFullScreen:function(){this.fullScreen=!0},onFullScreenChange:function(t){this.fullScreen=t},reload:function(){this.transInfo.transName=this.options.queryStr,this.init()},init:function(){var t=this;t.loading=!0,h.default.all([t.getSingleTransInfo(),t.getSingleTransDangers(),t.getTopoData()]).then(function(){t.formatDangerData(arguments[0][1].data),t.formatTopoData(arguments[0][2].data),t.loading=!1})},formatDangerData:function(t){var e=this;t&&t.length>0&&t.forEach(function(t){t.per=Math.floor(t.componentTime/e.transInfo.responseTime*1e4)/100}),e.dangers=t},formatTopoData:function(t){var e=this;t.links&&t.links.length>0&&(e.totalElapsedTime=e.transInfo.responseTime,t.links.forEach(function(t){var i=Math.floor(t.elapsedTime/e.totalElapsedTime*1e4)/100;t.label=t.elapsedTime+"ms,"+i+"%",t.source&&"USER"===t.source.type&&(t.label="")}),t.nodes.forEach(function(t){t.drillDown="SERVER"===t.type,"SERVER"===t.type&&(t.status=[{value:1,name:e.convertApdex(t.apdex).apdexStatus}])})),e.topo.data=JSON.parse((0,o.default)(t)),(new f.default).layout(e.$refs.topoContainer,e.topo.data),setTimeout(function(){e.topo.update++},50)},nodeSummary:function(t){var e=[];switch(t.type){case"USER":t.elapsedTime&&e.push(t.elapsedTime+" ms(100%)"),t.error&&e.push(t.error+" errors");break;case"SERVER":t.elapsedTime&&e.push(t.elapsedTime+" ms("+Math.floor(t.elapsedTime/this.totalElapsedTime*1e4)/100+"%)");var i=t.callCount;e.push(i+" calls"),t.error&&e.push(t.error+" errors")}return e},openTab:function(t){var e={name:t.requestId,type:"single-component-snapshot",options:t};this.$root.eventBus.openTab(e)},componentUrlFormatter:function(t){return(0,s.default)({},t,{trans:encodeURIComponent((0,o.default)({name:this.$route.name,query:this.$route.query}))})},getTopoData:function(){var t=this;return this.api.getSingleTransTopoList({data:{condition:t.options}})},getSingleTransInfo:function(){var t=this;return t.api.getSingleTransInfo({data:{condition:{traceId:t.options.traceId}},success:function(e){0===e.code&&(t.transInfo=e.data)}})},getSingleTransDangers:function(){var t=this;return t.api.getSingleTransDangers({data:{condition:{traceId:t.options.traceId}}})},onMouseUpNode:function(t,e){var i=this;if(!("SERVER"!==t.type||t.callCount<=0))return i.api.getSingleTransTopoNodeList({data:{condition:{traceId:i.options.traceId,tierId:t.id}},success:function(e){0===e.code&&e.data&&e.data.length>0&&e.data&&e.data.length>0&&(e.data.forEach(function(e){e.traceId=i.options.traceId,e.tierId=t.id,e.tierName=t.showName}),1===e.data.length?i.openTab(e.data[0]):(i.transGridData=e.data,i.dialogTransTableVisible=!0))}})},convertApdex:function(t){return(0,c.apdexConverter)(t)},convertDanger:function(t){var e={};switch(t.type){case"SERVER":e.tag="缓慢组件",e.iconCls="icon-snapshot-server";break;case"DATABASE":e.tag="缓慢SQL请求",e.iconCls="icon-snapshot-database";break;case"ERROR":e.tag="错误摘要",e.iconCls="icon-snapshot-error";break;case"REMOTE":e.tag="缓慢远程调用",e.iconCls="icon-snapshot-component"}return e}}}},695:function(t,e,i){e=t.exports=i(566)(),e.push([t.i,".single-trans-overview .content[data-v-2525a2c1]{margin-bottom:16px;border-bottom:1px solid #dcdcdc}.single-trans-overview .content[data-v-2525a2c1]:last-child{border-bottom-width:0}.single-trans-overview .multiple[data-v-2525a2c1]{display:flex;border-bottom:1px solid #dcdcdc}.single-trans-overview .multiple .l[data-v-2525a2c1]{padding-top:15px;width:400px}.single-trans-overview .multiple .r[data-v-2525a2c1]{flex:1;border-left:1px solid #dcdcdc;padding-top:15px}.single-trans-overview .multiple .r .content[data-v-2525a2c1]{margin-bottom:0;position:relative;width:100%;height:100%;min-height:600px}.single-trans-overview .trans-info li[data-v-2525a2c1]{font-size:14px;padding:2px;width:100%}.single-trans-overview .trans-info li>ul[data-v-2525a2c1]{display:table;width:100%}.single-trans-overview .trans-info li>ul li[data-v-2525a2c1]{display:table-cell;vertical-align:middle;word-break:break-all}.single-trans-overview .trans-info li>ul>li[data-v-2525a2c1]{width:30%}.single-trans-overview .trans-info li>ul>li+li[data-v-2525a2c1]{width:70%}.single-trans-overview .panel[data-v-2525a2c1]{margin-bottom:12px;background-color:#f7f7f7;border:none;border-radius:5px;padding:10px}.single-trans-overview .panel .title[data-v-2525a2c1]{padding-left:5px;font-size:14px;color:#333}.single-trans-overview .panel .time[data-v-2525a2c1]{color:#ff812e;font-size:14px}.single-trans-overview .panel .arrow[data-v-2525a2c1]{float:right;margin-top:3px;color:#333;opacity:0;transition:.25s}.single-trans-overview .panel .panel-item-name[data-v-2525a2c1]{display:inline-block;width:100%;font-size:14px;line-height:26px;white-space:nowrap;text-overflow:ellipsis;word-break:break-all;overflow:hidden}.single-trans-overview .panel[data-v-2525a2c1]:hover{cursor:pointer}.single-trans-overview .panel:hover .arrow[data-v-2525a2c1]{opacity:1}.single-trans-overview .el-dialog__wrapper[data-v-2525a2c1]{background-color:#f7f7f7}",""])},708:function(t,e,i){var a=i(695);"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i(567)("6d38d509",a,!0)},724:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"loadingContainer",staticClass:"single-trans-overview common-container no-border"},[i("div",{staticClass:"multiple"},[i("div",{staticClass:"l"},[t._m(0),t._v(" "),i("div",{staticClass:"content"},[i("ul",{staticClass:"trans-info"},[i("li",[i("ul",[i("li",[t._v("用户体验：")]),t._v(" "),i("li",[t._v(t._s(t.apdexTitle)),i("i",{staticClass:"icon-apdex",class:t.apdexIconClass,attrs:{title:t.apdexTitle}})])])]),i("li",[i("ul",[i("li",[t._v("事务名称：")]),t._v(" "),i("li",[t._v(t._s(t.transInfo.transName))])])]),t._v(" "),i("li",[i("ul",[i("li",[t._v("响应时间：")]),t._v(" "),i("li",[t._v(t._s(t.transInfo.responseTime)+" ms")])])]),t._v(" "),i("li",[i("ul",[i("li",[t._v("发生时间：")]),t._v(" "),i("li",[t._v(t._s(t.transInfo.startTime))])])])])]),t._v(" "),t._m(1),t._v(" "),i("div",{staticClass:"content"},t._l(t.dangers,function(e,a){return i("div",{key:a,staticClass:"panel",on:{click:function(i){t.openTab(e)}}},[i("p",[i("i",{staticClass:"icon-snapshot",class:t.convertDanger(e).iconCls}),t._v(" "),i("small",{staticClass:"title"},[t._v(t._s(t.convertDanger(e).tag))]),t._v(" "),"ERROR"!==e.type?i("small",{staticClass:"time"},[t._v(t._s(e.componentTime)+" ms")]):t._e(),t._v(" "),t._m(2,!0)]),t._v(" "),i("a",{attrs:{href:"javascript:void(0);"}},[i("span",{staticClass:"panel-item-name"},[t._v(t._s(e.componentName))]),t._v(" "),"ERROR"!==e.type?i("el-progress",{attrs:{"text-inside":!0,"stroke-width":8,"show-text":!1,percentage:t.transInfo.responseTime>0?Math.floor(e.componentTime/t.transInfo.responseTime*1e4)/100:100}}):t._e()],1)])}))]),t._v(" "),i("div",{staticClass:"r"},[i("div",{staticClass:"header-title tabstyle"},[i("span",{staticClass:"title-name"},[t._v("拓扑图")]),t._v(" "),i("div",{staticClass:"right-info"},[i("a",{attrs:{href:"javascript:void(0)"},on:{click:t.setFullScreen}},[i("i",{staticClass:"icon ion-android-expand"})])])]),t._v(" "),i("div",{ref:"topoContainer",staticClass:"content"},[i("Topo",{key:"single-trans-overview",attrs:{fullbtnDisplay:t.topo.fullbtnDisplay,data:t.topo.data,update:t.topo.update,attachmentSummary:t.topo.attachmentSummary,setFullScreen:t.fullScreen},on:{onMouseUpNode:t.onMouseUpNode,onFullScreenChange:t.onFullScreenChange}})],1)])]),t._v(" "),i("el-dialog",{attrs:{size:"large",modal:!1,title:"事务列表",visible:t.dialogTransTableVisible},on:{"update:visible":function(e){t.dialogTransTableVisible=e}}},[i("el-table",{attrs:{data:t.transGridData}},[i("el-table-column",{attrs:{property:"apdex",label:"用户体验",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("i",{staticClass:"icon-health icon-row",class:t.convertApdex(e.row.apdex).apdexIconClass,attrs:{title:t.apdexTitle}}),t._v("\n          "+t._s(t.convertApdex(e.row.apdex).apdexTitle)+"\n        ")]}}])}),t._v(" "),i("el-table-column",{attrs:{property:"transName",label:"事务名称",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("a",{staticClass:"theme-font-color-primary",attrs:{href:"javascript:void(0);"},on:{click:function(i){t.openTab(e.row)}}},[t._v(t._s(e.row.transName))])]}}])}),t._v(" "),i("el-table-column",{attrs:{property:"agentName",label:"实例"}}),t._v(" "),i("el-table-column",{attrs:{property:"type",label:"类型"}}),t._v(" "),i("el-table-column",{attrs:{property:"startTime",label:"发生时间"}}),t._v(" "),i("el-table-column",{attrs:{property:"responseTime",label:"响应时间(ms)"}})],1)],1)],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"header-title tabstyle"},[i("span",{staticClass:"title-name"},[t._v("基本信息")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"header-title tabstyle"},[i("span",{staticClass:"title-name"},[t._v("潜在风险")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("small",{staticClass:"arrow"},[i("i",{staticClass:"theme-font-icon-color-weak ion-chevron-right"})])}]}}});