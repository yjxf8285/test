/**
 * 纷享模块逻辑
 * @Author: 纷享网页前端部
 * @Date: 2014-09-02
 */
define("modules/feed-list/feed-list-helper",["util","moment"],function(a,b,c){var d={},e=a("util"),f=a("moment");_.extend(d,{feedContentFormat_helper:function(a){var b,c=a.text,d=a.type;switch(d){case 1:b='<span class="highlight">'+c+"</span>";break;case 2:b='<a href="'+c+'" target="_blank">'+c+"</a>";break;case 3:b='<a href="#stream/showtopic/=/name-'+encodeURIComponent(a.dataTitle)+'">'+c+"</a>";break;case 4:b='<a href="#circles/atcircle/=/cid-'+a.dataID+'">'+c+"</a>";break;case 5:b='<a href="#profile/=/empid-'+a.dataID+'">'+c+"</a>";break;default:b=c}return b=b.replace(/[\n\r]/g,"<br/>")},feedContentFormat_:function(a,b){var c,e,f=b.feedType,g="",h="",i=0,j=function(b){var c=b.text,e=b.type;0!=e?(i+=c.length,a>=i?g+=d.feedContentFormat_helper(b):h+=d.feedContentFormat_helper(b)):_.each(c.split(""),function(b){i+=1,b=b.replace(/</g,"&lt;"),b=b.replace(/>/g,"&gt;"),b=b.replace(/[\n\r]/g,"<br/>"),b=b.replace(new RegExp(" ","g"),"&nbsp;"),a>=i?g+=b:h+=b})},k=function(a){var b;switch(a){case 1:b=["今日","明日"];break;case 2:b=["本周","下周"];break;case 3:b=["本月","下月"];default:b=["",""]}return b};return b.replyContent?_.each(b.replyContent,function(a){j(a)}):2==f?(c=b.plan.planType,e=k(c),g+='<span class="feed-content-title">'+e[0]+"工作总结</span><br/>",_.each(b.plan.reportContent,function(a){j(a)}),a>=i?g+='<br/><br/><span class="feed-content-title">'+e[1]+"工作计划</span><br/>":h+='<br/><br/><span class="feed-content-title">'+e[1]+"工作计划</span><br/>",_.each(b.plan.planContent,function(a){j(a)}),a>=i?g+='<br/><br/><span class="feed-content-title">工作心得体会</span><br/>':h+='<br/><br/><span class="feed-content-title">工作心得体会</span><br/>',_.each(b.feedContent,function(a){j(a)})):_.each(b.feedContent,function(a){j(a)}),{summaryHtml:g,leftHtml:h,feedWordNum:i}},feedContentFormat:function(a){var b="";return a=[].concat(a),_.each(a,function(a){var c=a.type,d="";switch(c){case 1:d+='<span class="highlight">'+a.text+"</span>";break;case 2:d+='<a href="'+a.text+'" target="_blank">'+a.text+"</a>";break;case 3:d+='<a href="#stream/showtopic/=/name-'+encodeURIComponent(a.dataTitle)+'">'+a.text+"</a>";break;case 4:d+='<a href="#circles/atcircle/=/cid-'+a.dataID+'">'+a.text+"</a>";break;case 5:d+='<a href="#profile/=/empid-'+a.dataID+'">'+a.text+"</a>";break;default:d+=a.text}d=d.replace(/[\n\r]/g,"<br/>"),b+=d}),b},picturesFormat:function(a){var b,c,d,f={},g="",a=[].concat(a);return a.length>0?(b=a.length,d=a[0],b>1?(c='<p class="pic-num">图集(共'+b+"张)</p>",f.feedPic=g+'<div class="feedpics-bor feed-img"><div class="fpt-group"><div class="img-warp" style="position: absolute;"><table><tr><td valign="middle" align="center"><img src="'+e.getDfLink(d.attachPath+"3",d.attachName,!1,"jpg")+'" alt=""/></td></tr></table></div></div></div>'+c):f.feedPic='<div class="feed-img"><div class="img-warp"><table><tr><td valign="middle" align="center"><img src="'+e.getDfLink(d.attachPath+"3",d.attachName,!1,"jpg")+'"/></td></tr></table></div></div>'):f.feedPic="",f},filesFormat:function(a){var b,c={},d="",f=!1,g="",h="",i="",j="";return a=[].concat(a),_.each(a,function(a){f=a.canPreview,a.name=a.attachName,b=f?'<a href="#" class="attach-preview-l v">预览</a>':"",a.feedFiles='<dl attachid="'+a.attachID+'"><dt><img src="'+FS.ASSETS_PATH+"/images/file/"+a.fileIcon+'.png" alt=""></dt><dd><p>'+a.attachName+"("+e.getFileSize(a.attachSize)+')</p><p><a href="'+e.getDfLink(a.attachPath,a.attachName,!0)+'" class="d" title="'+a.name+'" target="_blank">下载</a> '+b+"</p></dd></dl>",d+=a.feedFiles,g+=a.attachPath+"|",h+=encodeURIComponent(a.attachName)+"|"}),i=FS.API_PATH+"/df/GetBatchFiles?ids="+g+"&names="+h,j='<div class="downall-btn fn-clear"><a href="'+i+'" style="float:right;margin-bottom: 4px;">打包下载</a></div>',c.feedFiles=a.length>0?a.length>1?'<div class="feed-files feed-attach fn-clear">'+j+d+"</div>":'<div class="feed-files feed-attach fn-clear">'+d+"</div>":"",c},renderArchiveBar:function(a,b){var c,d,g,h,i=a,j="";return i?(c=i.archiveTime,d=e.getDateSummaryDesc(f.unix(c),f.unix(b.serviceTime),1),g="",_.each(i.tags,function(a){g+='<span class="ar-tip"><a href="javascript:void(0);">'+a.tagName+"</a></span>"}),h='<div class="archive-remind"><span class="ar-time">归档于：'+d+'</span><span class="ar-tit">标签：</span>'+g+'<span class="ar-modfiy"><a href="javascript:void(0);">修改</a></span></div>',j=h):j="",j}}),c.exports=d});