/**
 * 纷享页面逻辑
 * @Author: 纷享网页前端部
 * @Date: 2014-09-02
 */
define("tpls/approve/sentapproves/sentapproves",["util","tabs","modules/feed-list/feed-list","../approve-common","moment","dialog","modules/publish/publish","../approve-common.css","../approve-common.html"],function(a,b){var c=window,d=c.FS,e=d.tpl,f=(e.store,e.event),g=a("util"),h=a("tabs"),i=a("modules/feed-list/feed-list"),j=a("../approve-common");b.init=function(){var a,c=b.tplEl,d=b.tplName,e=$(".feed-tabs",c),k=$(".search-inp",c),l=$(".search-btn",c);j.init(c,d);var m=function(a){var b=$(a),c=b.data("feedList");c&&c.loadKill()},n=null,o=function(a){var b=g.getTplQueryParams(),c=b?b.approvestatus:0;c=parseInt(c),a.get("activeIndex")==c?a.trigger("switched",c,-1):a.switchTo(c)};a=new h({element:e,triggers:$(".ui-tab-item",e),panels:$(".ui-tab-panel",e),activeIndex:0,activeTriggerClass:"ui-tab-item-current",triggerType:"click"}).render(),a.on("switched",function(a){var b=this.get("panels").eq(a),c=$(".feed-list",b),d=$(".feed-list-pagination",b),e=b.data("feedList"),f=b.attr("approvestatus");e?e.reload():(e=new i({element:c,pagSelector:d,pagOpts:{pageSize:45,visiblePageNums:7},listPath:"/FeedApprove/GetFeedApproveOfISend",loadSize:15,defaultRequestData:function(){return{feedApproveStatus:f,keyword:_.str.trim(k.val())}},listEmptyText:"没有您发出的需要他人审批的事项",searchOpts:{inputSelector:k,btnSelector:l}}),e.load(),b.data("feedList",e)),n=e}).on("switch",function(a,b){m(this.get("panels").eq(b))}),l.click(function(a){n.reload(),a.preventDefault()});var p=function(){var b=a.get("panels");b.each(function(){var a=$(this),b=a.data("feedList");b&&b.destroy(),a.removeData()})};f.one("beforeremove",function(a){a==d&&p()}),o(a)}});