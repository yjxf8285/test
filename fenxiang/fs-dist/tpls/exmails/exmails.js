/**
 * 纷享页面逻辑
 * @Author: 纷享网页前端部
 * @Date: 2014-09-02
 */
define("tpls/exmails/exmails",["util"],function(a,b){var c=window,d=c.FS;d.tpl;var e=a("util"),f=e.showInputError;b.init=function(){b.tplName;var a=b.tplEl,c=$(".exmails-form",a),d=$(".j-emailtype",c),g=$(".j-comname",c),h=$(".j-appid",c),i=$(".j-appkey",c),j=function(a){e.api({url:"/Management/BindingEnterpriseMail",type:"post",dataType:"json",data:a,success:function(a){a.success&&l()}},{submitSelector:$(".j-button-submit",c)})},k=function(){e.api({url:"/Management/CancelEnterpriseMail",type:"post",data:null,dataType:"json",success:function(a){a.success&&m()}},{submitSelector:$(".j-button-unsubmit",c)})},l=function(){d.prop("disabled",!0),g.prop("disabled",!0),h.closest("dd").hide(),i.closest("dd").hide(),$(".j-button-submit",c).addClass("hide"),$(".j-button-unsubmit",c).show()},m=function(){d.prop("disabled",!1),g.prop("disabled",!1),h.closest("dd").show(),i.closest("dd").show(),$(".j-button-submit",c).removeClass("hide"),$(".j-button-unsubmit",c).addClass("hide")};c.on("click",".j-button-submit",function(){var a={exmailProviderID:d.val(),domainName:g.val(),appID:h.val(),appKey:i.val()};return g.val()==g.data("empty")?(f(g),!1):h.val()==h.data("empty")?(f(h),!1):i.val()==i.data("empty")?(f(i),!1):(j(a),void 0)}),c.on("click",".j-button-unsubmit",function(){e.confirm("确定要取消绑定企业邮箱吗","提示",function(){k()})}),$("body").on("focusin","[data-empty]",function(){var a=$(this),b=$.trim(a.val()),c=a.data("empty");b==c&&a.val("")}).on("focusout","[data-empty]",function(){var a=$(this),b=$.trim(a.val()),c=a.data("empty");0==b.length&&a.val(c)}),e.api({url:"/Management/GetExmailDomainName",type:"get",success:function(a){var b;a.success&&(b=a.value,b.length>0&&(g.val(b),l()))}})}});