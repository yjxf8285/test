/**
 * 纷享页面逻辑
 * @Author: 纷享网页前端部
 * @Date: 2014-09-02
 */
define("tpls/settings/boundexmail/boundexmail",["tabs","util","../settings-common","../settings-common.html"],function(a,b){var c=window,d=c.FS,e=d.tpl;e.event;var f=(a("tabs"),a("util")),g=a("../settings-common"),h=f.getContactData(),i=h.u;b.init=function(){var a=b.tplEl,c=b.tplName,d=$(".bemn-input",a),e=$(".bemb-code-btn",a),h=$(".bemn-code-input",a),j=$(".bemb-btn",a),k=$(".bemain",a),l=$("#email-bc",a),m=$(".email-wrapper",a),n="@"+i.exmailDomain;$(".exmail-domain",a).text(i.exmailDomain),e.click(function(){if(""==d.val())f.showInputError(d);else{var a="<time id='bebtn-time'>60</time>秒后可重新发送";f.api({type:"post",data:{exmail:d.val()+n},url:"/Account/GetBindingEmployeeExmailCode/",success:function(b){if(b.success){e.attr("disabled","disabled"),e.addClass("bebtn-disabled"),e.html(a),e.next("a").show();var c=$("#bebtn-time"),f=60,g=setInterval(function(){1>f?(clearInterval(g),e.removeAttr("disabled"),e.removeClass("bebtn-disabled"),e.html("获取验证码")):(c.text(f),f--)},1e3);m.html(d.val()+n)}}})}}),j.click(function(){""==h.val()?f.showInputError(h):f.api({type:"post",data:{code:h.val()},url:"/Account/BindingEmployeeExmail/",success:function(a){a.success&&(k.hide(),l.show())}})});var o=$("#edit-number",a),p=$("#cannel-bind",a);p.click(function(a){f.api({type:"post",data:{},url:"/Account/CancelBindingEmployeeExmail/",success:function(a){a.success&&(k.show(),l.hide(),d.val(""),h.val(""))}}),a.preventDefault()}),o.click(function(){k.show(),l.hide(),d.val(""),h.val("")}),i.boundEmployeeExmail?(k.hide(),l.show()):(k.show(),l.hide()),g.init(a,c)}});