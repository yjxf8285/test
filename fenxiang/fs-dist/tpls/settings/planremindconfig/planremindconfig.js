/**
 * 纷享页面逻辑
 * @Author: 纷享网页前端部
 * @Date: 2014-09-02
 */
define("tpls/settings/planremindconfig/planremindconfig",["tabs","util","../settings-common","../settings-common.html"],function(a,b){var c=window,d=c.FS,e=d.tpl;e.event;var f=(a("tabs"),a("util")),g=a("../settings-common"),h=d.getAppStore("contactData").feedPlanRemaidObject;b.init=function(){var a=b.tplEl,c=b.tplName,d=$("#weekIsRemaid",a),e=$("#dayOfWeek",a),i=$("#weekTime",a),j=$("#monthIsRemaid",a),k=$("#dayOfMonth",a),l=$("#monthTime",a),m=$(".chose-time-input",a),n=$(".chose-time-apv",a);j.prop("checked",h.monthIsRemaid),d.prop("checked",h.weekIsRemaid),h.weekIsRemaid&&(e.val(h.dayOfWeek),i.val(h.weekShow.split(" ")[1])),h.monthIsRemaid&&(k.val(h.dayOfMonth),l.val(h.monthShow.split(" ")[1])),m.click(function(a){var b=$(this);n.hide(),b.next().show(),a.stopPropagation()}),n.find("a").click(function(){var a=$(this),b=a.html(),c=a.parents(".planremindconfig-control").find(".chose-time-input");c.val(b),a.parents(".chose-time-apv").hide()}),$(document).click(function(){$(".chose-time-apv",a).hide()});var o=$(".chk-week",a),p=$(".sel-week-list",a);o.click(function(){var a=$(this);a.attr("checked")?(a.next().find("option").eq(1).prop("selected",!0),a.nextAll(".chose-time-input").val("08:00")):(a.next().val("0"),a.nextAll(".chose-time-input").val(""))}),p.change(function(){var a=$(this);"0"!==a.val()?(a.prev().prop("checked",!0),a.next().val("08:00")):(a.prev().prop("checked",!1),a.next().val(""))});var q=function(){var a={};return a.dayOfWeek=parseInt(e.val()),a.weekHour=parseInt(i.val().slice(0,2))||0,a.weekMinute=parseInt(i.val().slice(3,5))||0,a.weekIsRemaid=d.is(":checked")?!0:!1,a.monthRemaidType=-1==k.val()?1:-2==k.val()?2:3,a.dayOfMonth=parseInt(k.val()),a.MonthHour=parseInt(l.val().slice(0,2))||0,a.MonthMinute=parseInt(l.val().slice(3,5))||0,a.monthIsRemaid=j.is(":checked")?!0:!1,a},r=$(".save-success-btn",a);r.click(function(b){var d;d=q(),f.api({type:"post",data:d,url:"/FeedPlan/SetSmsRemaid/",success:function(b){b.success&&g.saveSuccessAnimated(a,c)}}),b.preventDefault()}),g.init(a,c)}});