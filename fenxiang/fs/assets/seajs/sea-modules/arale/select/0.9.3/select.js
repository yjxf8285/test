define("arale/select/0.9.3/select",["arale/overlay/1.0.1/overlay","$","arale/position/1.0.0/position","arale/iframe-shim/1.0.1/iframe-shim","arale/widget/1.0.3/widget","arale/base/1.0.1/base","arale/class/1.0.0/class","arale/events/1.0.0/events","arale/widget/1.0.3/templatable","gallery/handlebars/1.0.0/handlebars","./select.tpl"],function(e,t,s){function i(e,t){var s,i=[],l=e.options,a=l.length,r=!1;for(s=0;a>s;s++){var n,c={},d=l[s],h=["text","value","defaultSelected","selected"];for(n in h){var o=h[n];c[o]=d[o]}c.defaultSelected=d.defaultSelected?"true":"false",d.selected?(c.selected="true",r=!0):c.selected="false",i.push(c)}return r||(newModel[0].selected="true"),{select:i,classPrefix:t}}function l(e,t){var s,i,l,a,r=[],n=[];for(s=0,l=e.length;l>s;s++){var c=e[s];c.selected?(c.selected=c.defaultSelected="true",n.push(s)):c.selected=c.defaultSelected="false",r.push(c)}if(n.length>0)for(n.pop(),i=0,a=n.length;a>i;i++)r[i].selected="false";else r[0].selected="true";return{select:r,classPrefix:t}}function a(e,t){var s;return s=n.isNumeric(e)?e:"string"==typeof e?t.index(t.parent().find(e)):t.index(e)}var r=e("arale/overlay/1.0.1/overlay"),n=e("$"),c=e("arale/widget/1.0.3/templatable"),d=e("./select.tpl"),h=r.extend({Implements:c,attrs:{trigger:{value:null,getter:function(e){return n(e).eq(0)}},classPrefix:"ui-select",template:d,align:{baseXY:[0,"100%-1px"]},name:"",value:"",length:0,selectedIndex:-1,multiple:!1,disabled:!1,selectSource:null},events:{"click [data-role=item]":function(e){var t=n(e.currentTarget);this.select(t)},"mouseenter [data-role=item]":function(e){n(e.currentTarget).addClass(this.get("classPrefix")+"-hover")},"mouseleave [data-role=item]":function(e){n(e.currentTarget).removeClass(this.get("classPrefix")+"-hover")}},initAttrs:function(e,t){h.superclass.initAttrs.call(this,e,t);var s=this.get("trigger");if("select"==s[0].tagName.toLowerCase()){var a=s.attr("name");a&&this.set("name",a),this.set("selectSource",s);var r='<a href="#" class="'+this.get("classPrefix")+'-trigger"></a>',c=n(r);this.set("trigger",c),s.after(c).hide(),this.model=i(s[0],this.get("classPrefix"))}else{var a=this.get("name");if(a){var d=n("input[name="+a+"]").eq(0);d[0]||(d=n('<input type="hidden" id="select-'+a+'" name="'+a+'" />').insertBefore(s)),this.set("selectSource",d)}this.model=l(this.model,this.get("classPrefix"))}},setup:function(){var e=this,t=this.get("trigger").on("click",{self:this},this._trigger_click).on("mouseenter",function(){t.addClass(e.get("classPrefix")+"-trigger-hover")}).on("mouseleave",function(){t.removeClass(e.get("classPrefix")+"-trigger-hover")});this.options=this.$("[data-role=content]").children(),this.select("[data-selected=true]"),this.set("length",this.options.length),this._tweakAlignDefaultValue(),this._blurHide(t),h.superclass.setup.call(this)},render:function(){return h.superclass.render.call(this),this._setTriggerWidth(),this},show:function(){return h.superclass.show.call(this),this._setPosition(),this},_setTriggerWidth:function(){var e=this.get("trigger"),t=this.element.outerWidth(),s=parseInt(e.css("padding-left"),10),i=parseInt(e.css("padding-right"),10),l=parseInt(e.css("border-left-width"),10),a=parseInt(e.css("border-right-width"),10);e.css("width",t-s-i-l-a)},_tweakAlignDefaultValue:function(){var e=this.get("align");"VIEWPORT"===e.baseElement._id&&(e.baseElement=this.get("trigger")),this.set("align",e)},_trigger_click:function(e){var t=e.data.self;e.preventDefault(),t.get("disabled")||t.show()},destroy:function(){this.element.remove(),h.superclass.destroy.call(this)},select:function(e){var t=a(e,this.options),s=this.get("selectedIndex");if(this.set("selectedIndex",t),s!==t){var i=this.options.eq(t);this.trigger("change",i)}return this.hide(),this},syncModel:function(e){this.model=l(e,this.get("classPrefix")),this.renderPartial("[data-role=content]"),this.options=this.$("[data-role=content]").children(),this.set("length",this.options.length),this.set("selectedIndex",-1),this.set("value","");var t=a("[data-selected=true]",this.options);return this.get("selectedIndex"),this.set("selectedIndex",t),this._setTriggerWidth(),this},getOption:function(e){var t=a(e,this.options);return this.options.eq(t)},addOption:function(e){var t=this.model.select;return t.push(e),this.syncModel(t),this},removeOption:function(e){var t=a(e,this.options),s=this.get("selectedIndex"),i=this.options.eq(t);return i.remove(),this.options=this.$("[data-role=content]").children(),this.set("length",this.options.length),t===s?this.set("selectedIndex",0):s>t&&this.set("selectedIndex",s-1),this},_onRenderSelectedIndex:function(e){if(-1!=e){var t=this.options.eq(e),s=this.currentItem,i=t.attr("data-value");if(!s||t[0]!=s[0]){var l=this.get("selectSource");l&&(l[0].value=i),s&&s.attr("data-selected","false").removeClass(this.get("classPrefix")+"-selected"),t.attr("data-selected","true").addClass(this.get("classPrefix")+"-selected"),this.set("value",i);var a=this.get("trigger"),r=a.find("[data-role=trigger-content]");r.length?r.html(t.html()):a.html(t.html()),this.currentItem=t}}},_onRenderDisabled:function(e){var t=this.get("classPrefix")+"-disabled",s=this.get("trigger");s[e?"addClass":"removeClass"](t);var i=this.options.eq(this.get("selectedIndex"));this.trigger("disabledChange",i,e)}});s.exports=h}),define("arale/select/0.9.3/select.tpl",[],'<div class="{{classPrefix}}">\n    <ul class="{{classPrefix}}-content" data-role="content">\n        {{#each select}}\n        <li data-role="item" class="{{../classPrefix}}-item" data-value="{{value}}" data-defaultSelected="{{defaultSelected}}" data-selected="{{selected}}">{{{text}}}</li>\n        {{/each}}\n    </ul>\n</div>\n');
