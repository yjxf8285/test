/**
 * aralejs组件包装
 * @Author: 纷享网页前端部
 * @Date: 2014-11-03
 */
define("uilibs/audio-player",["swfobject","assets/html/helper.html"],function(a,b,c){var d=window,e=d.FS,f=a("swfobject"),g=a("assets/html/helper.html"),h=0,i=e.ASSETS_PATH+"/sound/notification.mp3";e.ASSETS_PATH+"/sound/test.mp3";var j,k,l,m=[],n=$(g).filter(".audio-player-tpl-1").html(),o=_.template(n,{blankImage:e.BLANK_IMG}),p=$(g).filter(".audio-player-tpl-2").html(),q=$(g).filter(".audio-player-tpl-3").html(),r=$(g).filter(".audio-player-tpl-4").html();if(document.createElement("audio").canPlayType)k=document.createElement("audio"),k.src=i,k.setAttribute("controls","controls"),$(k).addClass("fn-hide-abs").appendTo("body"),j={core:k,audioType:"h5"};else{var s={data:e.ASSETS_PATH+"/dewplayer/dewplayer-vol.swf"},t={flashvars:"mp3="+i+"&javascript=on",wmode:"transparent"};$('<span class="fn-hide-abs"><span id="fs-audio-flash-player" class="fn-hide-abs"></span></span>').appendTo("body"),f.hasFlashPlayerVersion("9.0.0")?j={core:f.createSWF(s,t,"fs-audio-flash-player"),audioType:"flash"}:$("#fs-audio-flash-player").html("对不起，您的浏览器不支持录音播放。")}var u=function(a,b){b?_.some(m,function(c){return c.id==a?(c[b](),!0):void 0}):(b=a,_.each(m,function(a){a[b]()}))},v=function(a){m=_.reject(m,function(b){return b.id==a})},w=function(a){a=_.extend({themeStyle:1,element:null,audioSrc:"",length:0,defaultVolume:50},a||{}),this.element=$(a.element),this.opts=a,this._status="stop",this._volume=a.defaultVolume,this.id="fs-audio-shadow-player-"+h,h++,this.init()};_.extend(w.prototype,{init:function(){var a=this.element,b=this.opts;j&&(a.addClass("fs-audio"),1==b.themeStyle?(a.addClass("fs-audio-1"),a.html(o)):2==b.themeStyle?(a.addClass("fs-audio-2"),a.html(p)):3==b.themeStyle?(a.addClass("fs-audio-3"),a.html(q)):4==b.themeStyle&&(a.addClass("fs-audio-4"),a.html(r)),m.push(this),this._bindEvents(),this.stop())},_bindEvents:function(){var a=this,b=j.core,c=this.element,d=$(".mic-vol",c);c.on("click",".mc-play",function(){a.play()}).on("click",".mc-pause",function(){a.pause()}).on("click",".mic-vol",function(b){var c=$(b.currentTarget),e=d.index(c);e>0&&a.setVolume(16.67*e)});var e=function(){"playing"==a._status&&a._updateStatus("pausing")};"h5"==j.audioType?b.addEventListener("ended",e,!0):"flash"==j.audioType,this._playHandler=e},_updateStatus:function(a){var b=this.opts,c=b.themeStyle;this["_updateStatus"+c](a)},_updateStatus1:function(a){var b=this.element,c=$(".mic-content",b),d=$(".ctr-btn",b),e=this.opts;"playing"==a?(this._status="playing",c.html("正在播放...时长："+this._getFormatLength(e.length)),d.removeClass("mc-play").addClass("mc-pause")):("pausing"==a||"stopping"==a)&&(this._status="pausing",c.html("已停止，时长："+this._getFormatLength(e.length)),d.removeClass("mc-pause").addClass("mc-play"))},_updateStatus2:function(a){var b=this.element,c=$(".voice-green-wrapper",b),d=$(".ctr-btn",b);"playing"==a?(this._status="playing",c.addClass("vg-on"),d.removeClass("mc-play").addClass("mc-pause")):("pausing"==a||"stopping"==a)&&(this._status="pausing",c.removeClass("vg-on"),d.removeClass("mc-pause").addClass("mc-play"))},_updateStatus3:function(a){var b=this.element,c=$(".voice-grey-wrapper",b),d=$(".ctr-btn",b);"playing"==a?(this._status="playing",c.addClass("vy-on"),d.removeClass("mc-play").addClass("mc-pause")):("pausing"==a||"stopping"==a)&&(this._status="pausing",c.removeClass("vy-on"),d.removeClass("mc-pause").addClass("mc-play"))},_updateStatus4:function(a){var b=this.element,c=$(".player-icon",b),d=$(".audio-length",b),e=this.opts;"playing"==a?(this._status="playing",c.removeClass("mc-play").addClass("mc-pause")):("pausing"==a||"stopping"==a)&&(this._status="pausing",c.removeClass("mc-pause").addClass("mc-play")),d.text(e.length)},_getFormatLength:function(a){return[parseInt(a/60/60),parseInt(a/60%60),parseInt(a%60)].join(":").replace(/\b(\d)\b/g,"0$1")},flashReadyCb:function(a){var b=[].slice.call(arguments,1),c=j.core,d=0,e=setInterval(function(){c[a]||d>16?(clearInterval(e),c[a]&&c[a].apply(c,b)):d++},60)},play:function(){var a=this,b=j.core,c=this.opts,d=c.audioSrc,e=0;u("pause"),this._updateStatus("playing"),this.setVolume(this._volume),"h5"==j.audioType?(b.src=d,b.play()):"flash"==j.audioType&&(this.flashReadyCb("dewset",d),this.flashReadyCb("dewplay"),clearInterval(l),l=setInterval(function(){var d=b.dewgetpos();return c.length<=1?(clearInterval(l),void 0):((d>=1e3*c.length||e>c.length)&&(clearInterval(l),a._updateStatus("pausing")),e++,void 0)},1e3))},stop:function(){var a=j.core;if("h5"==j.audioType)try{a.currentTime=0,a.pause()}catch(b){}else"flash"==j.audioType&&this.flashReadyCb("dewstop");this._updateStatus("stopping")},pause:function(){var a=j.core;"h5"==j.audioType?a.pause():"flash"==j.audioType&&this.flashReadyCb("dewpause"),this._updateStatus("pausing")},setVolume:function(a){var b=j.core,c=j.audioType,d=this.element,e=$(".mic-vol",d),f=Math.ceil(a/16.67);e.removeClass("mic-aon"),f>0&&e.slice(0,f+1).addClass("mic-aon"),"h5"==c?b.volume=parseFloat(a/100):"flash"==c&&this.flashReadyCb("dewvolume",a),this._volume=a},destroy:function(){var a=this.element,b=j.core;a.removeClass("fs-audio fs-audio-1 fs-audio-2 fs-audio-3 fs-audio-4").empty(),"h5"==j.audioType?(b.removeEventListener("playing",this._playHandler,!0),this._playHandler=null):"flash"==j.audioType,v(this.id),this.element=null}}),c.exports=w});
define("uilibs/autocomplete",["autocomplete_core","filter","json"],function(a,b,c){function d(a){return"[object String]"===Object.prototype.toString.call(a)}function e(a,b){if(!a)return b;if($.isFunction(a))return a.call(this,b);if(d(a)){for(var c=a.split("."),e=b;c.length;){var f=c.shift();if(!e[f])break;e=e[f]}return e}return b}var f=a("autocomplete_core"),g=a("filter"),h=a("json"),i="ui-autocomplete",j=f.extend({attrs:{matchModel:"global"},events:{"click .ui-autocomplete-init .ui-autocomplete-item":"_selectInitItem"},setup:function(){var a=j.superclass.setup.apply(this,arguments);return this.bindEvents(),a},_initFilter:function(){var a=j.superclass._initFilter.apply(this,arguments);return"global"==this.get("matchModel")&&this.set("filter",{name:"stringMatch",func:g.stringMatch,options:{key:"value"}}),a},bindEvents:function(){var a=this,b=this.element,c=$("."+i+"-init",b);c.length>0&&this.get("trigger").focus(function(){0==$(this).val().length&&a._onRenderInputValue("")})},render:function(){var a=this.element,b=$("."+i+"-init",a),c=$("."+i+"-empty",a),d=j.superclass.render.apply(this,arguments);return b.length>0&&b.hide(),c.length>0&&c.hide(),d},_selectInitItem:function(a){var b=$(a.currentTarget),c=b.closest("."+i+"-item"),d=c.data("parseData"),e=c.data("originData"),f=c.data("eqFields"),g=this.dataSource,j=this,k=d(e);_.each(k,function(a){var b,c=g.getData();"no"==a.validity?(b=h.parse(h.stringify(a)),j.trigger("itemSelect",b),j._clear()):c&&(b="all"===f?_.find(c,function(b){return _.isEqual(b,a)}):_.find(c,function(b){var c=!0;return _.find(f,function(d){return b[d]!=a[d]?(c=!1,!0):void 0}),c}),b&&(j.trigger("itemSelect",b),j._clear()))}),this.hide(),a.preventDefault()},_onRenderInputValue:function(a){if(this._start&&a){var b=this.queryValue;this.queryValue=this.get("inputFilter").call(this,a),this.queryValue&&this.queryValue!==b&&(this.dataSource.abort(),this.dataSource.getData(this.queryValue))}else this.queryValue="";""!==a&&this.queryValue||(this.set("data",[]),this.switchTpl([])),delete this._start},_filterData:function(a){var b=this.get("filter"),c=this.get("locator");a=e(c,a),a=b.func.call(this,a,this.queryValue,b.options),this.set("data",a),this.switchTpl(a)},_onRenderData:function(a){this._clear(),this.model.items=a,this.renderPartial("[data-role=items]"),this.items=this.$("[data-role=items]").children(),this.currentItem=null,this.get("selectFirst")&&this.set("selectedIndex",0)},_createInitDataPanel:function(a){var b,c=this,d=this.element,e=$("."+i+"-init",d);e.length>0&&(b=$("."+i+"-init-panel",e),b.empty(),_.each(a,function(a){var d=$('<ul class="'+i+'-list-block"></ul>'),e=a.parseData,f=a.createHtml,g=a.eqFields||"all",h=a.store,j=a.renderCb;_.each(h,function(a){var b;b=f(a),b.data("originData",a),b.data("parseData",e),b.data("createHtml",f),b.data("eqFields",g),b.appendTo(d)}),d.appendTo(b),0==d.text().length&&d.hide(),j&&j.call(c,h,d)}))},_onRenderInitDataSource:function(a){this._createInitDataPanel(a)},switchTpl:function(a){var b=this.element,c=$("."+i+"-init",b),d=$("."+i+"-query",b),e=$("."+i+"-empty",b);this.queryValue,d.length>0?(this.queryValue?0==a.length?(c.hide(),d.hide(),e.show()):(c.hide(),d.show(),e.hide()):(c.show(),d.hide(),e.hide()),this.show()):this.queryValue&&0!=a.length?this.show():this.hide()}});c.exports=j});
define("uilibs/calendar",["calendar_core","moment","$"],function(a,b,c){var d=a("calendar_core"),e=a("moment"),f=a("$"),g={Su:"日",Mo:"一",Tu:"二",We:"三",Th:"四",Fr:"五",Sa:"六",Jan:"一月",Feb:"二月",Mar:"三月",Apr:"四月",May:"五月",Jun:"六月",Jul:"七月",Aug:"八月",Sep:"九月",Oct:"十月",Nov:"十一月",Dec:"十二月",Today:"今天"},h=d.extend({attrs:{showTodayBtn:!0},templateHelpers:{_:function(a){return g[a]||a}},setup:function(){var a=this,b=this.element,c=h.superclass.setup.call(this),d=function(){a.get("showTodayBtn")||f(".ui-calendar-today",b).hide()};return d(),this.model.on("changeMonth changeYear changeStartday changeMode",function(){var c=f(".ui-calendar",b);c.length>0&&(c.find(".ui-calendar-navigation,.ui-calendar-control,.ui-calendar-data-container,.ui-calendar-footer").appendTo(a.element),c.remove()),a._setCustomDateClsHelper(),d()}),this._focusDate=e(),c},setFocus_:function(a){this._focusDate=e(a),this._setCustomDateClsHelper()},_setCustomDateClsHelper:function(){var a=this,b=this.element;f(".ui-calendar-data-container .ui-calendar-date-column li",b).removeClass("current-date focused-date-alias").each(function(){var b=f(this),c=b.data("value");c==e().format("YYYY-MM-DD")&&b.addClass("current-date"),c==a._focusDate.format("YYYY-MM-DD")&&b.addClass("focused-date-alias")})},destroy:function(){var a;return this.element.remove(),a=h.superclass.destroy.apply(this,arguments)}});c.exports=h});
define("uilibs/card-calendar",["moment","widget"],function(a,b,c){var d=window,e=d.FS,f=e.tpl,g=f.event,h=a("moment"),i=a("widget"),j=i.extend({attrs:{initFocusDate:{getter:function(a){return a||(a=h()),h(h(a).format("YYYY-MM-DD"),"YYYY-MM-DD")}},currentDate:{getter:function(a){return a?h(a,"YYYY-MM-DD"):this.get("initFocusDate")},setter:function(a){return a.format("YYYY-MM-DD")}},panelState:"",inputSelect:!0},events:{"click .card-calendar-nav-prev":"_clickNavPrev","click .card-calendar-nav-next":"_clickNavNext","click .card-calendar-title .label-year":"_clickLabelYear","click .card-calendar-title .label-month":"_clickLabelMonth","click .card-calendar-year-panel .year-nav-prev":"_clickYearNavPrev","click .card-calendar-year-panel .year-nav-next":"_clickYearNavNext","click .card-calendar-year-panel .year-item":"_clickYearItem","click .card-calendar-month-panel .month-item":"_clickMonthItem","click .card-calendar-date-panel .date-body .date-cell":"_clickDateCell"},setup:function(){var a,b=this;return a=j.superclass.setup.apply(this,arguments),this._stampStore={},this.get("inputSelect")&&this.on("dateclick",function(a){b.removeStamp("selected"),b.setStamp("selected",h(a,"YYYY-MM-DD")),b.updateDateView()}),a},render:function(){var a=j.superclass.render.apply(this,arguments),b=this;return this._renderSelf(),this._initFocusDate(),g.on("globalremind",function(a){var c=$(".current-month-date",b.element),d=h.unix(a.serviceTime).format("YYYY-MM-DD");c.each(function(){var a=$(this).attr("data-date");a==d&&(c.removeClass("is-init-focus-date"),$(this).addClass("is-init-focus-date"))})}),a},setStamp:function(a,b){var c=this._stampStore[a]||[];_.isUndefined(b)||(b=[].concat(b),b=_.map(b,function(a){return h(a)}),_.each(b,function(a){_.some(c,function(b){return b==a.format("YYYY-MM-DD")})||c.push(a.format("YYYY-MM-DD"))}),this._stampStore[a]=c)},getStamp:function(a){return _.isUndefined(a)?this._stampStore:this._stampStore[a]},removeStamp:function(a,b){var c=this;return _.isUndefined(a)?(this._stampStore={},void 0):_.isUndefined(b)?(this._stampStore[a]=[],void 0):(b=[].concat(b),b=_.map(b,function(a){return h(a)}),_.each(b,function(b){c._stampStore[a]=_.reject(c._stampStore[a],function(a){return b.format("YYYY-MM-DD")==a})}),void 0)},updateDateView:function(){var a=this.get("panelState"),b=this.element,c=$(".card-calendar-date-panel",b),d=$(".date-body td",c),e=this._stampStore,f=_.keys(e);"date"==a&&_.each(f,function(a){d.removeClass("stamp-"+a),_.each(e[a],function(b){d.filter('[data-date="'+b+'"]').addClass("stamp-"+a)})})},_initFocusDate:function(){var a=this.get("initFocusDate");this._renderDatePanel(a),this.set("currentDate",this.get("initFocusDate")),this.set("panelState","date")},_clickNavPrev:function(){var a=this.get("currentDate");a=a.subtract("months",1),this._renderDatePanel(a),this.set("currentDate",a),this.set("panelState","date")},_clickNavNext:function(){var a=this.get("currentDate");a=a.add("months",1),this._renderDatePanel(a),this.set("currentDate",a),this.set("panelState","date")},_clickLabelYear:function(){var a=this.get("currentDate"),b=this.get("panelState");"year"==b?(this._renderDatePanel(a),this.set("panelState","date")):(this._renderYearPanel(a.format("YYYY")),this.set("panelState","year"))},_clickLabelMonth:function(){var a=this.get("currentDate"),b=this.get("panelState");"month"==b?(this._renderDatePanel(a),this.set("panelState","date")):(this._renderMonthPanel(),this.set("panelState","month"))},_clickYearNavPrev:function(){var a=this.element,b=$(".card-calendar-year-panel",a),c=$("li.year-item",b).eq(0).data("year");this._renderYearPanel(c)},_clickYearNavNext:function(){var a=this.element,b=$(".card-calendar-year-panel",a),c=$("li.year-item",b).last().data("year");this._renderYearPanel(c)},_clickYearItem:function(a){var b=$(a.currentTarget),c=b.data("year");this.set("currentDate",h(c+"-"+this.get("currentDate").format("MM-DD"),"YYYY-MM-DD")),b.addClass("is-current-year").siblings(".year-item").removeClass("is-current-year")},_clickMonthItem:function(a){var b=$(a.currentTarget),c=this.get("currentDate"),d=b.data("month");this.set("currentDate",h(c.format("YYYY")+"-"+d+"-"+c.format("DD"),"YYYY-M-DD")),b.addClass("is-current-month").siblings(".month-item").removeClass("is-current-month")},_clickDateCell:function(a){var b=$(a.currentTarget),c=b.closest("td"),d=c.data("date");this.trigger("dateclick",d)},_renderSelf:function(){var a=this.element;a.addClass("card-calendar"),a.html('<div class="card-calendar-tbar"><div class="card-calendar-nav-prev">&#139;</div><div class="card-calendar-title"><span class="label-year">0000</span>年<span class="label-month">00</span>月</div><div class="card-calendar-nav-next">&#155;</div></div><div class="card-calendar-body"><div class="card-calendar-date-panel card-calendar-panel"></div><div class="card-calendar-year-panel card-calendar-panel"></div><div class="card-calendar-month-panel card-calendar-panel"></div></div>')},_renderDatePanel:function(a){var b,c,d=this.element,e=$(".card-calendar-date-panel",d),f=this.get("initFocusDate"),g=a.clone().startOf("month"),h=g.startOf("week"),i='<table cellpadding="0" cellspacing="0">',j=0;for(i+='<thead class="day-title"><tr><th><span class="date-cell">日</span></th><th><span class="date-cell">一</span></th><th><span class="date-cell">二</span></th><th><span class="date-cell">三</span></th><th><span class="date-cell">四</span></th><th><span class="date-cell">五</span></th><th><span class="date-cell">六</span></th></tr></thead>',i+='<tbody class="date-body">';42>j;)b=h.clone(),b.add("d",j),c=parseInt(b.format("M"))<parseInt(a.format("M"))?"prev-month-date state-inactive":parseInt(b.format("M"))>parseInt(a.format("M"))?"next-month-date state-inactive":"current-month-date state-active",b.isSame(f)&&(c+=" is-init-focus-date"),0==j%7&&(i+=0==j?"<tr>":"</tr><tr>"),i+='<td data-date="'+b.format("YYYY-MM-DD")+'" class="'+c+'"><span class="date-cell">'+b.format("D")+"</span></td>",j++;i+="</tr></tbody>",i+="</table>",e.html(i),this.updateDateView()},_renderYearPanel:function(a){var b,c=this.element,d=$(".card-calendar-year-panel",c),e=this.get("currentDate"),f="";for(a=parseInt(a),b=a-6;a-1>=b;b++)f+='<li data-year="'+b+'" class="year-item">'+b+"</li>";for(f+='<li data-year="'+a+'" class="year-item">'+a+"</li>",b=a+1;a+6>=b;b++)f+='<li data-year="'+b+'" class="year-item">'+b+"</li>";f='<ul class="fn-clear"><li class="year-nav-prev">&#8230;</li>'+f+'<li class="year-nav-next">&#8230;</li></ul>',d.html(f),$('[data-year="'+e.format("YYYY")+'"]',d).addClass("is-current-year")},_renderMonthPanel:function(){var a,b=this.element,c=$(".card-calendar-month-panel",b),d=this.get("currentDate"),e="",f=parseInt(d.format("M"));for(a=1;12>=a;a++)e+='<li class="month-item" data-month="'+a+'">'+(new Array(2-a.toString().length+1).join("0")+a)+"</li>";e='<ul class="fn-clear">'+e+"</ul>",c.html(e),$('[data-month="'+f+'"]',c).addClass("is-current-month")},_onChangeCurrentDate:function(a){var b=this.element,c=$(".card-calendar-tbar",b),d=$(".label-year",c),e=$(".label-month",c);a&&(a=h(a,"YYYY-MM-DD"),d.text(a.format("YYYY")),e.text(a.format("MM")))},_onChangePanelState:function(a){var b=this.element;$(".card-calendar-panel",b).hide(),$(".card-calendar-"+a+"-panel",b).show()},destroy:function(){var a;return this._stampStore=null,a=j.superclass.destroy.apply(this,arguments)}});c.exports=j});
define("uilibs/chart/bubblechart",["raphael","./chart-helper"],function(a){var b=a("raphael");a("./chart-helper");var c=function(){this._init_.apply(this,arguments)};return c.prototype={_init_:function(a){a=a||{},this.opts=a,this.element=$(a.element),a.autoRender&&this.render()},render:function(a){this.element;var a=this.info=a||this.opts.info,c=this.paper=b(this.element[0],this.info.width,this.info.height);this.svgelement={};var d=a.yAxis.max||100;d=Math.ceil(d/a.yAxis.linenum)*a.yAxis.linenum,a.yAxis.max=d;var e=a.fontsize=13,f=a.leftgutter=function(){var b=c.transNumber(d||100);b=a.yAxis.label?a.yAxis.label(b):b;var f=c.text(-1e4,-1e4,b).attr("font-size",e).hide(),g=f.getBBox().width;return f.remove(),g+10}(),g=a.X=(a.width-f-a.rightgutter)/a.xAxis.label.length,h=(a.mx=(a.width-f-a.rightgutter)/(a.xAxis.end-a.xAxis.start),a.my=(a.height-a.topgutter-a.bottomgutter)/d),i=a.ly=d/a.yAxis.linenum;a.Y=h*i,a.tip&&(a.tip=_.template(a.tip)),a.xline=f+(a.width-f-a.rightgutter)/2,a.yline=a.topgutter+(a.height-a.topgutter-a.bottomgutter)/2,c.drawCoord(a.leftgutter-1,a.height-a.bottomgutter-.5,a.width-a.leftgutter-a.rightgutter,a.height-a.topgutter-a.bottomgutter,a.xAxis.label.length,a.yAxis.linenum);for(var j=0;j<a.xAxis.label.length;j++)c.text(a.leftgutter+g*(j+.5),a.height-a.bottomgutter+14,a.xAxis.label[j]).attr({fill:"#444","font-size":a.fontsize});for(var k=0;k<a.yAxis.linenum+1;k++){var l=c.transNumber(Math.round(a.ly*k));l=a.yAxis.label?a.yAxis.label(l):l,c.text(a.leftgutter-9,a.height-a.bottomgutter-a.Y*k,l).attr({"text-anchor":"end",fill:"#444","font-size":a.fontsize})}this.update(a.series)},update:function(a){var b=this,c=this.paper,d=this.svgelement;d.eveEle=c.set();for(var e=0;e<a.length;e++)if(a[e]){var f,g,h={name:a[e].name};switch(a[e].type){case"normal":f=a[e].data;for(var i=0;i<f.length;i++)g=_.extend({},f[i][3],h),d.eveEle.push(b._drawbubble(f[i][0],f[i][1],a[e].color,f[i][2],!1,g));break;case"num":f=a[e].data;for(var i=0;i<f.length;i++)g=_.extend({},f[i][3],h),d.eveEle.push(b._drawbubble(f[i][0],f[i][1],a[e].color,!1,f[i][2],g))}}b._addEvent()},_drawbubble:function(a,b,c,d,e,f){c=c||"#ff9600",d=d||10;var g=this.paper,h=this.info;if(!(a<h.xAxis.start||a>h.xAxis.end)){var i=h.leftgutter+(a-h.xAxis.start)*h.mx,j=h.height-h.bottomgutter-b*h.my,k=g.circle(i,j,d).attr({fill:c,stroke:"none"}),l=k;if(e!==!1){g.text(i,j,e).attr({fill:"#fff"});var m=g.circle(i,j,d).attr({fill:"#fff",stroke:"none",opacity:0});m.toFront(),l=m,f.num=e,l.data("info",h.tip(f))}else f.num=0,l.data("info",h.tip(f));return l}},_addEvent:function(){var a=this,b=a.paper,c=a.svgelement.eveEle,d=this.info;a.svgelement.tip=b.popup(100,200,"hello i am popup\n this is secondline\n this is thirdline","left-top","start").hide(),c.forEach(function(b){b.hover(function(){clearTimeout(a.svgelement.tip.timeVector);var c=this.attr("cx"),e=this.attr("cy"),f=["left","top"];c<d.xline?f[0]="right":c==d.xline&&(f[0]="middle"),e<d.yline?f[1]="bottom":e==d.xline&&"middle"==f[1],f=f.join("-"),a.svgelement.tip.show().ltranslate(c,e,b.data("info"),f)},function(){a.svgelement.tip.timeVector=setTimeout(function(){a.svgelement.tip.hide()},200)})})},destory:function(){this.paper&&this.paper.remove()}},c});
define("uilibs/chart/chart-helper",["raphael"],function(a){var b=a("raphael");b.fn.transNumber=function(a,b){if(0==a||a){void 0==b&&(b=!0),b&&(a=Math.round(a));var c=parseInt(a).toString(),d=c.length;if(3>=d)return c;var e,f=d%3;return e=f>0?c.slice(0,f)+","+c.slice(f,d).match(/\d{3}/g).join(","):c.slice(f,d).match(/\d{3}/g).join(",")}},b.fn.transNum=function(a,b){var a=parseFloat(a),c=Math.round(a*Math.pow(10,b))/Math.pow(10,b),d=c.toString(),e=d.indexOf(".");for(0>e&&(e=d.length,d+=".");d.length<=e+2;)d+="0";var f=this.transNumber(d,!1);return d=f+d.slice(d.indexOf("."))},b.fn.drawGrid=function(a,b,c,d,e,f,g){g=g||"#000";for(var h=["M",Math.round(a)+.5,Math.round(b)+.5,"L",Math.round(a+c)+.5,Math.round(b)+.5,Math.round(a+c)+.5,Math.round(b+d)+.5,Math.round(a)+.5,Math.round(b+d)+.5,Math.round(a)+.5,Math.round(b)+.5],i=d/f,j=c/e,k=1;f>k;k++)h=h.concat(["M",Math.round(a)+.5,Math.round(b+k*i)+.5,"H",Math.round(a+c)+.5]);for(var l=1;e>l;l++)h=h.concat(["M",Math.round(a+l*j)+.5,Math.round(b)+.5,"V",Math.round(b+d)+.5]);return this.path(h.join(",")).attr({stroke:g})},b.fn.drawCoord=function(a,b,c,d,e,f,g,h){g=g||"#666",h=h||"#ccc";var i=6,j=d/f,k=c/e,l=[],m=[];l=l.concat(["M",Math.round(a)+.5,Math.round(b)+.5,"L",Math.round(a+c)+.5,Math.round(b)+.5]);for(var n=0;e>=n;n++)l=l.concat(["M",Math.round(a+n*k)+.5,Math.round(b)+.5,"V",Math.round(b+i)+.5]);l=l.concat(["M",Math.round(a)+.5,Math.round(b)+.5,"L",Math.round(a)+.5,Math.round(b-d)+.5]);for(var o=0;f>=o;o++)l=l.concat(["M",Math.round(a)+.5,Math.round(b-o*j)+.5,"H",Math.round(a-i)+.5]);for(n=1;f>=n;n++)m=m.concat(["M",Math.round(a)+.5,Math.round(b-n*j)+.5,"H",Math.round(a+c)+.5]);var p=this.rect(a,b-d,c,d).attr({fill:"#efefef",stroke:"none"}),q=this.path(m.join(",")).attr({stroke:h}),r=this.path(l.join(",")).attr({stroke:g});return this.set().push(p,q,r)},b.fn.line=function(a){a.length;for(var b,c=0;c<a.length;c++){var d=a[c][0],e=a[c][1];b=c?b.concat(["L",d,e]):["M",d,e]}return this.path(b)},b.fn.wave=function(a){function b(a,b,c,d,e,f){var g=(c-a)/2,h=(e-c)/2,i=Math.atan((c-a)/Math.abs(d-b)),j=Math.atan((e-c)/Math.abs(d-f)),i=d>b?Math.PI-i:i,j=d>f?Math.PI-j:j,k=Math.PI/2-(i+j)%(2*Math.PI)/2,l=g*Math.sin(k+i),m=g*Math.cos(k+i),n=h*Math.sin(k+j),o=h*Math.cos(k+j);return{x1:c-l,y1:d+m,x2:c+n,y2:d+o}}a.length;for(var c,d,e,f,g,h,i,j,k=0;k<a.length;k++)if(k)if(k!==a.length-1){f=a[k-1][0],g=a[k-1][1],d=a[k][0],e=a[k][1],h=a[k+1][0],i=a[k+1][1];var j=b(f,g,d,e,h,i);c=c.concat([j.x1,j.y1,d,e,j.x2,j.y2])}else d=a[k],c=c.concat([]);else d=a[k][0],e=a[k][1],c=["M",d,e,"C",d,e];return this.path(c)},b.fn.wavea=function(a,b,c){var d,e=a[0][0],f=a[0][1],g=a[1][0],h=a[1][1],i=e+(g-e)/2,j=f,k=g,l=h+(f-h)/2;if(b){c||(c=16);var m,n,o=c*Math.sin(1/3*Math.PI);return f>h?(n=this.path(["M",e,f,"C",i,j,k,l,g,h+o]),m=this.vectop([g,h+o],c)):(n=this.path(["M",e,f,"C",i,j,k,l,g,h-o]),m=this.vecbottom([g,h-o],c)),this.set().push(n,m)}return d=["M",e,f,"C",i,j,k,l,g,h],this.path(d)},b.fn.vec=function(a,b,c){var d=["M"],e=a[0],f=a[1],g=Math.sin(1/3*Math.PI)*b,h=[],i=[],j=[];switch(c){case"left":h[0]=e-g,h[1]=f,i[0]=e,i[1]=f+b/2,j[0]=e,j[1]=f-b/2;break;case"right":h[0]=e+g,h[1]=f,i[0]=e,i[1]=f+b/2,j[0]=e,j[1]=f-b/2;break;case"top":h[0]=e,h[1]=f-g,i[0]=e+b/2,i[1]=f,j[0]=e-g/2,j[1]=f;break;case"bottom":h[0]=e,h[1]=f+g,i[0]=e+b/2,i[1]=f,j[0]=e-g/2,j[1]=f}return d=d.concat(h,["L"],i,["L"],j,["Z"]),this.path(d)},b.fn.vecleft=function(a,b){return this.vec(a,b,"left")},b.fn.vecright=function(a,b){return this.vec(a,b,"right")},b.fn.vectop=function(a,b){return this.vec(a,b,"top")},b.fn.vecbottom=function(a,b){return this.vec(a,b,"bottom")},b.fn.popup=function(a,b,c,d,e){var f=this.set(),c=this.text(a,b,c).attr({fill:"#444","font-size":12}),g=c.getBBox(),h=g.width+12,i=g.height+10,j=this.rect(a,b,h,i,2).attr({fill:"#fff",stroke:"#ccc","stroke-width":1});d=d||"left-top",d=d.split("-");var k=[];switch(k[0]=d[0],k[1]=d[1],k[0]){case"left":c.attr("x",a-h/2),j.attr("x",a-h);break;case"right":c.attr("x",a+h/2),j.attr("x",a);break;case"middle":c.attr("x",a),j.attr("x",a-h/2)}switch(k[1]){case"top":c.attr("y",b-i/2),j.attr("y",b-i);break;case"bottom":c.attr("y",b+i/2),j.attr("y",b);break;case"middle":"middle"==k[0]?(c.attr("y",b-i/2),j.attr("y",b-i)):(c.attr("y",b),j.attr("y",b-i/2))}j.insertBefore(c);var e=e||"middle";switch(e){case"start":c.attr("text-anchor","start").translate(-h/2+6,0)}return f.push(j).push(c),f[0].data("vector",d.join("-")),f},b.st.lanimate=function(a,b,c,d){var e=this[1],f=this[0],c=c||e.attr("text"),d=d||260,g=f.paper,h=g.text(a,b,c).attr({fill:"#fff"}).hide(),i=h.getBBox(),j=i.width+12,k=i.height+10;f.animate({x:a,y:b,width:j,height:k},d),e.attr("text",c).animate({x:a+j/2,y:b+k/2},d)},b.st.ltranslate=function(a,b,c,d,e){var f=this[1],g=this[0],c=c||f.attr("text");f.attr({x:a,y:b,text:c});var h=f.getBBox(),i=h.width+12,j=h.height+10;g.attr({x:a,y:b,width:i,height:j,r:2}),d=d||this[0].data("vector"),d=d.split("-");var k=[];switch(k[0]=d[0],k[1]=d[1],k[0]){case"left":f.attr("x",a-i/2),g.attr("x",a-i);break;case"right":f.attr("x",a+i/2),g.attr("x",a);break;case"middle":f.attr("x",a),g.attr("x",a-i/2)}switch(k[1]){case"top":f.attr("y",b-j/2),g.attr("y",b-j);break;case"bottom":f.attr("y",b+j/2),g.attr("y",b);break;case"middle":"middle"==k[0]?(f.attr("y",b-j/2),g.attr("y",b-j)):(f.attr("y",b),g.attr("y",b-j/2))}var e=e||f.attr("text-anchor");switch(f.transform(""),e){case"start":f.attr("text-anchor","start").translate(-i/2+6,0)}return g.insertBefore(f),this}});
define("uilibs/chart/funnelchart",["raphael","./chart-helper"],function(a){var b=a("raphael");a("./chart-helper");var c=function(a){a=_.extend({element:null,autoRender:!0},a||{}),a.info={width:820,height:540,leftpadding:80,toppadding:60,bottompadding:60,rightpadding:60,title:"Sales funnel",series:{name:"Unique users",data:[["Website visits",400,"#1ed2dc"],["Downloads",332,"#277ebf"],["Requested price list",260,"#a434a6"],["Invoice sent",150,"#ee5582"],["Finalized",80,"#f3674c"]]}},this.opts=a,this.element=$(a.element),this.paper=b(this.element[0],a.info.width,a.info.height),this.init()};return _.extend(c.prototype,{init:function(){var a=this.opts;a.autoRender&&this.render()},render:function(a){this.element,this.info=a||this.opts.info,this.svgelement={};var a=this.info,b=this.paper,c=a.leftpadding,d=a.toppadding,e=(a.width-a.leftpadding-a.rightpadding)/2,f=e/a.series.data[0][1];a.funnelWidth=e,a.funnelUnit=f;for(var g,h=b.set(),i=a.series.data,j=0;j<i.length;j++)if(j!==i.length-1){var k=i[j][1]*a.funnelUnit,l=i[j+1][1]*a.funnelUnit,m=(k-l)/2,n=m*Math.tan(1/3*Math.PI);g=b.path(["M",c,d,"L",c+k,d,"L",c+k-m,d+n,"L",c+m,d+n,"L",c,d]).attr({stroke:"#fff",fill:i[j][2]}),h.push(g),c+=m,d+=n}else{var o=i[j][1]*a.funnelUnit;g=b.path(["M",c,d,"L",c+o,d,"L",c+o,d+o,"L",c,d+o,"L",c,d]).attr({stroke:"#fff",fill:i[j][2]}),h.push(g)}},destroy:function(){}}),c});
define("uilibs/chart/funnelchart_a",["raphael","./chart-helper"],function(a){var b=a("raphael");a("./chart-helper");var c=function(){this._init_.apply(this,arguments)};return c.prototype={_init_:function(a){this.opts=a,this.element=$(a.element),this.opts.autoRender&&this.render()},render:function(a){var c=this.element;this.svgelement={};var a=this.info=a||this.opts.info;a.fontsize=13;var d=this._trans(this.info.series),e=d.data,f=d.angle,g=a.width-a.rightpadding,h=g*Math.tan(f)/2;if(a.height){var i=a.toppadding+a.bottompadding+h;a.height<i?a.height=i:a.toppadding=a.toppadding+(a.height-i)/2}else a.height=a.toppadding+a.bottompadding+h;for(var j,k=0,l=a.toppadding,m=this.paper=b(c[0],a.width,a.height),n=g,o=0;o<e.length;o++)if(o!==e.length-1){var p=e[o][1]/d.total*h,q=p/Math.tan(f);j=m.path(["M",k,l,"L",k+n,l,"L",k+n-q,l+p,"L",k+q,l+p,"L",k,l]).attr({stroke:"#fff",fill:e[o][2]}),function(){var b=Math.round(k+n-q/2)+4.5,c=Math.round(l+p/2)+.5,d=1.06*g,e=c,f=m.transNum(a.series.data[o][1],2);f=a.series.label?a.series.label(f):f,m.path(["M",b,c,"L",d,e]).attr({stroke:"#888"}),m.text(d+4,e,a.series.data[o][0]).attr({"text-anchor":"start",fill:"#888","font-size":a.fontsize}),m.text(a.width-4,e,f).attr({"text-anchor":"end",fill:"#222","font-size":a.fontsize})}(),k+=q,l+=p,n-=2*q}else{var p=e[o][1]/d.total*h,j=m.path(["M",k,l,"L",k+n,l,"L",k+n,l+p,"L",k,l+p,"L",k,l]).attr({stroke:"#fff",fill:e[o][2]});!function(){var b=Math.round(k+n)+4.5,c=Math.round(l+p/2)+.5,d=1.06*g,e=c,f=m.transNum(a.series.data[o][1],2);f=a.series.label?a.series.label(f):f,m.path(["M",b,c,"L",d,e]).attr({stroke:"#888"}),m.text(d+4,e,a.series.data[o][0]).attr({"text-anchor":"start",fill:"#888","font-size":a.fontsize}),m.text(a.width,e,f).attr({"text-anchor":"end",fill:"#222","font-size":a.fontsize})}()}},_trans:function(a){var a=JSON.parse(JSON.stringify(a)),b=.1;if(0==a.data.length)throw new Error("漏斗数据为空");for(var c=0,d=0;d<a.data.length;d++)c+=a.data[d][1];0==c&&(c=100,b=1/a.data.length);for(var e=c*b,f=0,d=0;d<a.data.length;d++)a.data[d][1]<e&&(a.data[d][1]=e),f+=a.data[d][1];return a.total=f,a.angle=Math.atan(b/(e/f)*Math.sqrt(3)),a},destory:function(){this.paper&&this.paper.remove()}},c});
define("uilibs/chart/funnelchart_b",["raphael","./chart-helper"],function(a){var b=a("raphael");a("./chart-helper");var c=function(){this._init_.apply(this,arguments)};return c.prototype={_init_:function(a,b){this.opts=a,this.element=$(a.element),this.render(a.info,b)},render:function(a,c){var d=this.element,e=this.svgelement={};this.info=a,a.fontsize=13;var f=a.series,g=f.data,h=Math.PI/3,i=a.width-a.rightpadding,j=i*Math.tan(h)/2;if(a.height){var k=a.toppadding+a.bottompadding+j;a.height<k?a.height=k:a.toppadding=a.toppadding+(a.height-k)/2}else a.height=a.toppadding+a.bottompadding+j;var l,m=0,n=a.toppadding,o=this.paper=b(d[0],a.width,a.height),p=i;e.cube=o.set(),e.line=o.set(),e.labels=o.set();for(var q=0;q<g.length;q++)if(q!==g.length-1){var r=j/g.length,s=r/Math.tan(h);l=o.path(["M",m,n,"L",m+p,n,"L",m+p-s,n+r,"L",m+s,n+r,"L",m,n]).attr({stroke:"#fff",fill:"#bbbbbb"}),e.cube.push(l),function(){var b=Math.round(m+p-s/2)+4.5,c=Math.round(n+r/2)+.5,d=a.width-122,g=c,h=o.text(d,g,f.data[q][0]).attr({"text-anchor":"start",fill:"#bbbbbb","font-size":a.fontsize}),i=o.path(["M",b,c,"L",d-4.5,g]).attr({stroke:"#bbbbbb","font-size":a.fontsize});e.labels.push(h),e.line.push(i)}(),m+=s,n+=r,p-=2*s}else{var r=j/g.length,l=o.path(["M",m,n,"L",m+p,n,"L",m+p,n+r,"L",m,n+r,"L",m,n]).attr({stroke:"#fff",fill:"#bbbbbb"});e.cube.push(l),function(){var b=Math.round(m+p)+4.5,c=Math.round(n+r/2)+.5,d=a.width-120,f=c,g=o.path(["M",b,c,"L",d-4.5,f]).attr({stroke:"#bbbbbb","font-size":a.fontsize}),h=o.text(d,f,a.series.data[q][0]).attr({"text-anchor":"start",fill:"#bbbbbb","font-size":a.fontsize});e.labels.push(h),e.line.push(g)}()}this.activeStage(c)},activeStage:function(a){for(var b=this.svgelement,c=this.info,d="#d8d8d8",e=0;e<b.line.length;e++)d=e==a?c.series.data[e][1]:"#d8d8d8",b.labels[e].attr({fill:d}),b.line[e].attr({stroke:d}),b.cube[e].attr({fill:d})},destory:function(){this.paper&&this.paper.remove()}},c});
define("uilibs/chart/linechart",["raphael","./chart-helper"],function(a){var b=a("raphael");a("./chart-helper");var c=function(){this._init_.apply(this,arguments)};return c.prototype={_init_:function(a){a=a||{},this.opts=a,this.element=$(a.element),a.autoRender&&this.render()},render:function(a){this.element,this.info=a||this.opts.info,this.paper=b(this.element[0],a.width,a.height),this.svgelement={},this.svgelement.AXIS=this.paper.set(),this.svgelement.MAP=this.paper.set();var c=this.paper,d=this.svgelement,a=this.info,e=a.fontsize=13,f=a.yAxis.max||100;f=Math.ceil(f/a.yAxis.linenum)*a.yAxis.linenum;var g=a.leftgutter=function(){var a=c.transNumber(f||100),b=c.text(-1e4,-1e4,a).attr("font-size",e).hide(),d=b.getBBox().width;return b.remove(),d+10}(),h=a.X=(a.width-g)/a.xAxis.length,i=a.my=(a.height-a.topgutter-a.bottomgutter)/f,j=a.ly=f/a.yAxis.linenum;a.Y=i*j,a.max=f,a.template=_.template(a.template);var k=c.drawCoord(a.leftgutter-1,a.height-a.bottomgutter-.5,a.width-a.leftgutter,a.height-a.topgutter-a.bottomgutter,a.xAxis.length,a.yAxis.linenum);d.AXIS.push(k),d.AXIS.title=c.text(a.width/2,a.topgutter/2,a.title).attr({"text-anchor":"middle","font-size":e});for(var l=0;l<a.xAxis.length;l++)d.AXIS.push(c.text(a.leftgutter+h*(l+.5),a.height-a.bottomgutter+14,a.xAxis[l]).attr({fill:"#444","font-size":a.fontsize}));for(var m=0;m<a.yAxis.linenum+1;m++){var n=c.transNumber(a.ly*m);d.AXIS.push(c.text(a.leftgutter-9,a.height-a.bottomgutter-a.Y*m,n).attr({"text-anchor":"end",fill:"#444","font-size":a.fontsize}))}this.update(a.series)},update:function(a){for(var b=(this.paper,this.info),c=0;c<a.length;c++)switch(a[c].type){case"line":this._drawLine(a[c].data,a[c].color);break;case"cube":this._drawRect(a[c].data,a[c].color,a[c].width);break;case"dbcube":this._drawMrect(a[c].data,a[c].color,a[c].lcolor)}this._drawAlpha(),(1==b.legend||"undefined"==typeof b.legend)&&this._drawLegend(),this._addEvent()},_drawLine:function(a,b){b=b||"#00bde5";for(var c=this.paper,d=(this.svgelement,this.info),e=[],f=c.set(),g=0;g<d.xAxis.length;g++){var h=Math.round(d.height-d.bottomgutter-d.my*a[g]),i=Math.round(d.leftgutter+d.X*(g+.5));e.push([i,h]),f.push(c.circle(i,h,3).attr({fill:"#eee",stroke:b,"stroke-width":2}))}c.line(e).attr({stroke:b,"stroke-width":2}).toFront(),f.toFront()},_drawRect:function(a,b,c){var d=this.paper,e=(this.svgelement,this.info);b=b||"#ff9600",c=c||e.X/2;for(var f=d.set(),g=0;g<e.xAxis.length;g++)if(0!==a[g]){var h=e.leftgutter+e.X*g+(e.X-c)/2,i=Math.round(e.height-e.bottomgutter-e.my*a[g]),j=a[g]*e.my;f.push(d.rect(h,i,c,j).attr({stroke:"none",fill:b}))}f.toFront()},_drawMrect:function(a,b,c){b=b||"#ccc",c=c||"#ff9600";for(var d=this.paper,e=(this.svgelement,this.info),f=d.set(),g=d.set(),h=0;h<e.xAxis.length;h++){var i=Math.round(e.height-e.bottomgutter-e.my*a[h][0]);yb=Math.round(e.height-e.bottomgutter-e.my*a[h][1]);var j=d.rect(e.leftgutter+e.X*(h+.25),i,e.X/2,a[h][0]*e.my).attr({stroke:"none",fill:b}),k=d.rect(e.leftgutter+e.X*(h+.25),yb,e.X/2,a[h][1]*e.my).attr({stroke:"none",fill:c});f.push(j),g.push(k)}f.toFront(),g.toFront()},_drawAlpha:function(){var a=this,b=this.paper,c=this.svgelement,d=this.info;c.eveEle=b.set(),c.eveLine=b.set();var e=b.set();b.set(),this.svgelement.AXIS.title;for(var f=0;f<d.xAxis.length;f++){var g=Math.round(d.leftgutter+d.X*(f+.5));c.eveLine.push(b.line([[Math.round(g),d.height-d.bottomgutter],[Math.round(g),d.topgutter]]).attr({"stroke-width":1,stroke:"#888"}).hide()),c.eveEle.push(b.rect(d.leftgutter+d.X*f,d.topgutter,d.X,d.height-d.bottomgutter-d.topgutter).attr({stroke:"none",fill:"green",opacity:0}));var h=c.eveEle[c.eveEle.length-1];h.data("info",d.template(a._getTittle(f)))}e.toFront()},_drawLegend:function(){for(var a,b,c,d=this.paper,e=(this.svgelement,this.info),f=e.series,g=0,h=e.height-e.bottomgutter*(1/3),i=d.set(),j=0;j<f.length;j++){switch(f[j].type){case"line":a=d.path(["m",g,h,"l",10,0]).attr({stroke:f[j].color,"stroke-width":2}),b=d.text(g,h,f[j].name).attr({"font-size":e.fontsize}),c=b.getBBox().width,b.attr({x:g+c/2+14,y:h,fill:"#666"}),g=g+c+32;break;case"cube":a=d.rect(g,h-5,10,10).attr({fill:f[j].color,stroke:"none"}),b=d.text(g,h,f[j].name).attr({"font-size":e.fontsize}),c=b.getBBox().width,b.attr({x:g+c/2+14,y:h,fill:"#666"}),g=g+c+32;break;case"dbcube":}i.push(a).push(b)}var k=(e.width-e.leftgutter-i.getBBox().width)/2;i.transform("t"+(e.leftgutter+k)+",0")},_addEvent:function(){var a=this.info,b=this.svgelement.eveEle,c=this.svgelement.eveLine,d=this.svgelement.AXIS.title;b.forEach(function(b,e){b.hover(function(){d.attr("text",this.data("info")),c[e].show()},function(){d.attr("text",a.title),c[e].hide()})})},__addEvent:function(){this.info;var a=this.svgelement.eveEle;this.svgelement.AXIS.title,a.forEach()},_getTittle:function(a){var b=this.info,c=b.series,d={};d.num=a+1;for(var e=0;e<c.length;e++)d[c[e].mark]=c[e].data[a];return d},destory:function(){this.paper&&this.paper.remove()}},c});
define("uilibs/confirmbox",["confirmbox_core"],function(a,b,c){var d=a("confirmbox_core"),e=d.extend({events:{"click [data-role=confirm] a":function(a){a.preventDefault(),a.stopPropagation(),this.trigger("confirm",a)},"click [data-role=cancel] a":function(a){a.preventDefault(),a.stopPropagation(),this.trigger("cancel",a),this.hide()},"click [data-role=close]":function(a){a.preventDefault(),a.stopPropagation(),this.trigger("cancel",a),this.hide()}}});e.alert=function(a,b,c){var d={message:a,title:"",cancelTpl:"",closeTpl:"",onConfirm:function(a){b&&b(a),this.hide()},onCancel:function(a){b&&b(a)}};new e($.extend(null,d,c)).show().after("hide",function(){this.destroy()})},e.confirm=function(a,b,c,d){d=_.extend({autoHide:!0},d||{});var f={message:a,title:b,closeTpl:"",onConfirm:function(a){c&&c.call(this,a),d.autoHide&&this.hide()}};new e($.extend(null,f,d)).show().on("cancel",function(){d.onCancel&&d.onCancel()}).after("hide",function(){this.destroy()})},c.exports=e});
define("uilibs/crmdatatable",[],function(a,b,c){var d=Backbone.View.extend();c.exports=d});
define("uilibs/currency-input",["widget"],function(a,b,c){var d=a("widget"),e=d.extend({attrs:{element:null,name:"",id:"",required:!1,value:0},events:{"mousedown .crm-currency-mask":"_readyToInput","keyup .crm-currency-input":"_onKeyUp","keydown .crm-currency-input":"_onKeyDown","blur .crm-currency-input":"_onSubmit","focus .crm-currency-input":"_onFocus"},setup:function(){var a=e.superclass.setup.apply(this,arguments);return this._getHtml(),a},render:function(){var a=e.superclass.setup.apply(this,arguments);return a},destroy:function(){var a;return a=e.superclass.destroy.apply(this,arguments)},_readyToInput:function(){$(".crm-currency-mask",this.element).hide(),$(".crm-currency-input",this.element).show(),$(".crm-currency-input",this.element).val(),setTimeout(function(){$(".crm-currency-input",this.element).focus()},100)},_onKeyUp:function(){var a=$(".crm-currency-input",this.element).val();if(this.set("value",a),!a)return $(".crm-currency-display").hide(),void 0;var b=/^([0-9]\d{0,15})+\.{0,1}[0-9]{0,2}$/;if(!b.test(a))return $(".crm-currency-input",this.element).val(a.substr(0,a.length-1)),!1;var c=_.str.numberFormat(parseFloat(a),2);$(".crm-currency-display").text(c),this._showInfo()},_onKeyDown:function(a){if(a){var b=a.which,c=[110,96,97,98,99,100,101,102,103,104,105,48,49,50,51,52,53,54,55,56,57,190,8,37,39];if(!_.contains(c,b))return a.preventDefault(),void 0;var d=$(".crm-currency-input",this.element).val(),e=d.split(".")[0];if(e.length>=15&&8!=b&&39!=b&&37!=b)return a.preventDefault(),void 0}},_onFocus:function(){var a=$(".crm-currency-input",this.element).val();0==a&&$(".crm-currency-input",this.element).val("")},_showInfo:function(){var a=$(".crm-currency-input",this.element).offset(),b=$(".crm-currency-input",this.element).height();$(".crm-currency-display").css({left:a.left-11,top:a.top+b+11}),$(".crm-currency-display").show()},_onSubmit:function(){var a=$(".crm-currency-input",this.element).val()||0;if(this.isValid()){var b=_.str.numberFormat(parseFloat(a),2);$(".crm-currency-mask",this.element).text(b),$(".crm-currency-mask",this.element).hasClass("crm-currency-done")||$(".crm-currency-mask",this.element).addClass("crm-currency-done"),$(".crm-currency-mask",this.element).show(),$(".crm-currency-input",this.element).hide(),$(".crm-currency-display").hide()}},_getHtml:function(){var a="",b=this.get("name"),c=this.get("id");return a+=c?"<div class = 'crm-currency-input-container'><input value='0' placeholder = '请填写金额' name = '"+b+"' id = '"+c+"' class = 'crm-currency-input fn-hide' />":"<div class = 'crm-currency-input-container'><input value='0' placeholder = '请填写金额' name = '"+b+"' class = 'crm-currency-input fn-hide' />",a+="<div class = 'crm-currency-mask'>0.00</div></div>",this.element.html(a),$(".crm-currency-display").length<1&&$("body").append("<div class = 'crm-currency-display fn-hide'></div>"),a},val:function(){return this.isValid()?parseFloat($(".crm-currency-input",this.element).val()||0):-1},setValue:function(a){$(".crm-currency-input",this.element).val(a),this.set("value",a);var b=_.str.numberFormat(parseFloat(a),2);$(".crm-currency-display").text(b),$(".crm-currency-mask",this.element).text(b),$(".crm-currency-mask",this.element).hasClass("crm-currency-done")||$(".crm-currency-mask",this.element).addClass("crm-currency-done"),$(".crm-currency-mask",this.element).show(),$(".crm-currency-input",this.element).hide(),$(".crm-currency-display").hide()},reset:function(){$(".crm-currency-input",this.element).val("0"),this.set("value",0),$(".crm-currency-display").text("0.00"),$(".crm-currency-mask",this.element).text("0.00"),$(".crm-currency-mask",this.element).hasClass("crm-currency-done")&&$(".crm-currency-mask",this.element).removeClass("crm-currency-done"),$(".crm-currency-mask",this.element).show(),$(".crm-currency-input",this.element).hide(),$(".crm-currency-display").hide()},isValid:function(){var a=$(".crm-currency-input",this.element).val();if(""==a)return!0;if(!a&&this.get("required"))return $(".crm-currency-display").text("请填写金额"),!1;var b=/^(([1-9]\d{0,15})|0)(\.\d{1,2})?$/;return b.test(a)?!0:($(".crm-currency-display").text("请正确填写金额"),!1)}});c.exports=e});
define("uilibs/dialog",["dialog_core","dnd","mask","position"],function(a,b,c){var d=a("dialog_core"),e=a("dnd"),f=a("mask");a("position");var g,h=".dialog",i=[];$(function(){g=$('<div class="ui-dialog-drag-proxy"></div>'),g.css({position:"absolute",top:"-10000px",left:"-10000px"}).appendTo("body")});var j=d.extend({attrs:{enableDrag:!0,visibleWithAnimate:!1,hideWithEsc:!1},_onRenderVisible:function(a){var b=this.get("visibleWithAnimate");b?a?this.element.fadeIn(200):this.element.fadeOut(200):this.element[a?"show":"hide"]()},_onRenderZIndex:function(a){return this.get("hasMask")&&f.set("zIndex",parseInt(a,10)-1),d.superclass._onRenderZIndex.call(this,a)},_setupMask:function(){this.before("show",function(){this.get("hasMask")&&f.show()})},_setupKeyEvents:function(){var a=this,b=this.get("hideWithEsc");b&&$(document).on("keyup."+h+this.cid,function(b){27===b.keyCode&&a.get("visible")&&a.hide()})},_setPosition:function(a){var b=j.superclass._setPosition.apply(this,arguments);return a||(a=this.get("align")),"50%"==a.selfXY[0]&&"50%"==a.selfXY[1]&&"50%"==a.baseXY[0]&&"50%"==a.baseXY[1]&&this.element.position().top<0&&this.element.css("top",0),b},_setupFocus:function(){this.after("show",function(){var a=$(".auto-focus",this.element);a.length>0?a.get(0).focus():this.element.focus()}),this.after("hide",function(){this.activeTrigger&&this.activeTrigger.focus()})},render:function(){var a;return a=j.superclass.render.apply(this,arguments)},show:function(){var a,b,c=this.get("enableDrag"),d=this.element;return a=j.superclass.show.apply(this,arguments),i.push(this),this._setMaskStatus(),b=$(".ui-dialog-title",this.element),!this.dnd&&b.length>0&&c&&(this.dnd=new e(d,{drag:b,proxy:g,containment:"body"}),this.dnd.on("dragstart",function(a,c){c.width(d.width()),c.height(d.height()),b.click()})),$("textarea",this.element).each(function(){var a=$(this),b=_.str.trim(a.val()),c=a.attr("placeholder");b==c&&a.val("").trigger("autosize.resize")}),a},hide:function(){var a,b=this;return a=j.superclass.hide.apply(this,arguments),i=_.filter(i,function(a){return a!==b}),this._setMaskStatus(),a},_setMaskStatus:function(){var a=-1;_.each(i,function(b){b.get("hasMask")&&b.get("zIndex")>a&&(a=b.get("zIndex"))}),-1!=a?(f.set("zIndex",a-1),f.show()):f.hide()},destroy:function(){return this.get("trigger")&&this.get("trigger").off("click"+h+this.cid),$(document).off("keyup."+h+this.cid),this.dnd&&this.dnd.destroy(),this.element&&this.element.remove(),this._setMaskStatus(),clearInterval(this._interval),d.superclass.destroy.call(this)}});f.set("opacity",.1),j.hideAll=function(a){a?_.each(i,function(b){b.element.is(a)&&b.hide()}):_.each(i,function(a){a.hide()})},c.exports=j});
define("uilibs/dnd",["$","base"],function(a,b,c){function d(a){switch(a.type){case"mousedown":1===a.which&&(e({target:a.target,pageX:a.pageX,pageY:a.pageY}),q===!0&&a.preventDefault());break;case"mousemove":q===!0&&f(),null!==r&&(g({pageX:a.pageX,pageY:a.pageY}),h(),a.preventDefault());break;case"mouseup":null!==r?(r.css("cursor","default"),r.focus(),r=null,i(),j(),v.trigger("dragend",v.get("element"),s),v=null,s=null):q===!0&&(v.get("proxy").remove(),q=!1,v=null);break;case"keydown":null!==r&&27===a.which&&(r.css("cursor","default"),r.focus(),r=null,j(!0),v.trigger("dragend",v.get("element"),s),v=null,s=null)}}function e(a){var b,c=null,d=null,e=null,f=m(a.target).parents().toArray();f.unshift(a.target),m.each(f,function(a,b){if(void 0!==m(b).data("dnd")){if(e=m(b).data("dnd"),e===!0)e=new l(b,m(b).data("config"));else if(e===!1)e=null;else{if(!(isNaN(parseInt(e))===!1&&parseInt(e)>0))return!0;e=p[parseInt(e)]}return!1}}),null!==e&&e.get("disabled")!==!0&&(v=e,c=v.get("element"),b=v.get("drag"),(a.target===b[0]||0!=m(a.target).closest(".draggable").length)&&(d=v.get("proxy"),d.css({position:"absolute",margin:0,left:0,top:0,visibility:"hidden"}),d.appendTo(c.parent()),d.data("originx",d.offset().left),d.data("originy",d.offset().top),d.css({left:c.offset().left-d.data("originx"),top:c.offset().top-d.data("originy"),width:c.css("width")}),t=a.pageX-c.offset().left,u=a.pageY-c.offset().top,q=!0))}function f(){var a=v.get("element"),b=v.get("proxy"),c=v.get("visible"),d=v.get("dragCursor"),e=v.get("zIndex");c!==!0&&a.css("visibility","hidden"),b.css({"z-index":e,visibility:"visible",cursor:d}),b.focus(),w={},q=!1,r=b,v.trigger("dragstart",w,r,s)}function g(a){var b=v.get("containment"),c=v.get("axis"),d=a.pageX-t,e=a.pageY-u,f=r.data("originx"),g=r.data("originy"),h=b.offset();(void 0===h||null===h)&&(h={left:0,top:0}),"y"!==c&&(d>=h.left&&d+r.outerWidth()<=h.left+b.outerWidth()?r.css("left",d-f):d<=h.left?r.css("left",h.left-f):r.css("left",h.left+b.outerWidth()-r.outerWidth()-f)),"x"!==c&&(e>=h.top&&e+r.outerHeight()<=h.top+b.outerHeight()?r.css("top",e-g):e<=h.top?r.css("top",h.top-g):r.css("top",h.top+b.outerHeight()-r.outerHeight()-g)),v.trigger("drag",r,s)}function h(){var a=(v.get("element"),v.get("drop")),b=v.get("dragCursor"),c=v.get("dropCursor"),d=r.offset().left+t,e=r.offset().top+u;null!==a&&(null===s?m.each(a,function(a,b){return k(b,d,e)===!0?(r.css("cursor",c),r.focus(),s=m(b),v.trigger("dragenter",r,s),!1):void 0}):k(s,d,e)===!1?(r.css("cursor",b),r.focus(),v.trigger("dragleave",r,s),s=null):v.trigger("dragover",r,s))}function i(){var a=v.get("element"),b=v.get("proxy"),c=v.get("revert"),d=b.data("originx"),e=b.data("originy");null!==s&&(k(s,b)===!1&&c===!1&&(b.css("left",s.offset().left+(s.outerWidth()-b.outerWidth())/2-d),b.css("top",s.offset().top+(s.outerHeight()-b.outerHeight())/2-e)),v.trigger("drop",w,a,s))}function j(a){var b=v.get("element"),c=v.get("proxy"),d=v.get("drop"),e=v.get("revert"),f=v.get("revertDuration"),g=v.get("visible"),h=c.offset().left-b.offset().left,i=c.offset().top-b.offset().top,j=c.data("originx"),k=c.data("originy");e===!0||a===!0||null===s&&null!==d?(b.attr("style",b.data("style")),g===!1&&b.css("visibility","hidden"),c.animate({left:b.offset().left-j,top:b.offset().top-k},f,function(){b.css("visibility",""),c.remove()})):("relative"===b.css("position")?(h=(isNaN(parseInt(b.css("left")))?0:parseInt(b.css("left")))+h,i=(isNaN(parseInt(b.css("top")))?0:parseInt(b.css("top")))+i):"absolute"===b.css("position")?(h=c.offset().left,i=c.offset().top):b.css("position","relative"),g===!1?(b.css({left:h,top:i,visibility:""}),c.remove()):b.animate({left:h,top:i},f,function(){c.remove()}))}function k(a,b,c){var d=m(a).offset();return null===d&&(d={left:0,top:0}),2===arguments.length?d.left<=m(b).offset().left&&d.left+m(a).outerWidth()>=m(b).offset().left+m(b).outerWidth()&&d.top<=m(b).offset().top&&d.top+m(a).outerHeight()>=m(b).offset().top+m(b).outerHeight():3===arguments.length?d.left<=b&&d.left+m(a).outerWidth()>=b&&d.top<=c&&d.top+m(a).outerHeight()>=c:void 0}var l=null,m=a("$"),n=a("base"),o=0,p=[],q=!1,r=null,s=null,t=0,u=0,v=null,w={};l=n.extend({attrs:{element:{value:null,readOnly:!0,getter:function(a){return m(a).eq(0)}},containment:{value:document,getter:function(a){return m(a).eq(0)}},proxy:{value:null,getter:function(a){return null===a?null:m(a).eq(0)},setter:function(a){return null===a?this.get("element").clone():a}},drag:{value:null,getter:function(a){return null===a?null:m(a).eq(0)},setter:function(a){return null===a?this.get("element"):a}},drop:{value:null,getter:function(a){return null===a?null:m(a)}},disabled:!1,visible:!1,axis:!1,revert:!1,revertDuration:500,dragCursor:"move",dropCursor:"copy",zIndex:9999},initialize:function(a,b){var c,d=null;(0===m(a).length||1!==m(a).get(0).nodeType)&&m.error("element error!"),b=m.extend({element:a},b),l.superclass.initialize.call(this,b),d=this.get("element"),null===this.get("proxy")&&this.set("proxy",d.clone()),c=this.get("drag"),c.addClass("draggable"),d.data("style",d.attr("style")||""),d.data("dnd",++o),p[o]=this},destroy:function(){var a;return this.get("drag").removeClass("draggable"),a=l.superclass.destroy.apply(this,arguments)}}),l.open=function(){m(document).on("mousedown mousemove mouseup keydown",d)},l.close=function(){m(document).off("mousedown mousemove mouseup keydown",d)},l.open(),c.exports=l});
define("uilibs/filter",["$"],function(a,b,c){function d(a,b){if(g.isPlainObject(a)){var c=b&&b.key||"value";return a[c]||""}return a}function e(a,b){for(var c=[],d=a.split(""),e=0,f=b.split(""),g=0,h=d.length;h>g;g++){var i=d[g];if(i==f[e]){if(e===f.length-1){c.push([g-f.length+1,g+1]),e=0;continue}e++}else e=0}return c}function f(a){return(a||"").replace(i,"\\$1")}var g=a("$"),h={"default":function(a,b,c){var e=[];return g.each(a,function(a,b){var f={},h=d(b,c);g.isPlainObject(b)&&(f=g.extend({},b)),f.matchKey=h,e.push(f)}),e},startsWith:function(a,b,c){var e=[],h=b.length,i=new RegExp("^"+f(b));return h?(g.each(a,function(a,b){var f={},j=d(b,c);g.isPlainObject(b)&&(f=g.extend({},b)),i.test(j)&&(f.matchKey=j,h>0&&(f.highlightIndex=[[0,h]]),e.push(f))}),e):[]},stringMatch:function(a,b,c){b=b||"";var f=[],h=b.length;return h?(g.each(a,function(a,h){var i={},j=d(h,c);g.isPlainObject(h)&&(i=g.extend({},h)),j.indexOf(b)>-1&&(i.matchKey=j,i.highlightIndex=e(j,b),f.push(i))}),f):[]}};c.exports=h;var i=/(\[|\[|\]|\^|\$|\||\(|\)|\{|\}|\+|\*|\?)/g});
define("uilibs/fsupload",["swfupload"],function(a,b,c){function d(a,b,c){try{var d="error.gif",e="";if(b===o.errorCode_QUEUE_LIMIT_EXCEEDED&&(e="You have attempted to queue too many files."),""!==e)return alert(e),void 0;switch(b){case o.QUEUE_ERROR.ZERO_BYTE_FILE:d="zerobyte.gif";break;case o.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:d="toobig.gif";break;case o.QUEUE_ERROR.ZERO_BYTE_FILE:case o.QUEUE_ERROR.INVALID_FILETYPE:default:alert(c)}j("images/"+d)}catch(f){this.debug(f)}}function e(a,b){try{b>0&&this.startUpload()}catch(c){this.debug(c)}}function f(a,b){try{var c=Math.ceil(100*(b/a.size)),d=new l(a,this.customSettings.upload_target);d.setProgress(c),100===c?(d.setStatus("Creating thumbnail..."),d.toggleCancel(!1,this)):(d.setStatus("Uploading..."),d.toggleCancel(!0,this))}catch(e){this.debug(e)}}function g(a,b){try{var c=new l(a,this.customSettings.upload_target);"FILEID:"===b.substring(0,7)?(j("thumbnail.php?id="+b.substring(7)),c.setStatus("Thumbnail Created."),c.toggleCancel(!1)):(j("images/error.gif"),c.setStatus("Error."),c.toggleCancel(!1),alert(b))}catch(d){this.debug(d)}}function h(a){try{if(this.getStats().files_queued>0)this.startUpload();else{var b=new l(a,this.customSettings.upload_target);b.setComplete(),b.setStatus("All images received."),b.toggleCancel(!1)}}catch(c){this.debug(c)}}function i(a,b,c){var d,e="error.gif";try{switch(b){case o.UPLOAD_ERROR.FILE_CANCELLED:try{d=new l(a,this.customSettings.upload_target),d.setCancelled(),d.setStatus("Cancelled"),d.toggleCancel(!1)}catch(f){this.debug(f)}break;case o.UPLOAD_ERROR.UPLOAD_STOPPED:try{d=new l(a,this.customSettings.upload_target),d.setCancelled(),d.setStatus("Stopped"),d.toggleCancel(!0)}catch(g){this.debug(g)}case o.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:e="uploadlimit.gif";break;default:alert(c)}j("images/"+e)}catch(h){this.debug(h)}}function j(a){var b=document.createElement("img");if(b.style.margin="5px",document.getElementById("thumbnails").appendChild(b),b.filters)try{b.filters.item("DXImageTransform.Microsoft.Alpha").opacity=0}catch(c){b.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}else b.style.opacity=0;b.onload=function(){k(b,0)},b.src=a}function k(a,b){var c=5,d=30;if(100>b)if(b+=c,b>100&&(b=100),a.filters)try{a.filters.item("DXImageTransform.Microsoft.Alpha").opacity=b}catch(e){a.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+b+")"}else a.style.opacity=b/100;100>b&&setTimeout(function(){k(a,b)},d)}function l(a,b){if(this.fileProgressID="divFileProgress",this.fileProgressWrapper=document.getElementById(this.fileProgressID),this.fileProgressWrapper)this.fileProgressElement=this.fileProgressWrapper.firstChild,this.fileProgressElement.childNodes[1].firstChild.nodeValue=a.name;else{this.fileProgressWrapper=document.createElement("div"),this.fileProgressWrapper.className="progressWrapper",this.fileProgressWrapper.id=this.fileProgressID,this.fileProgressElement=document.createElement("div"),this.fileProgressElement.className="progressContainer";var c=document.createElement("a");c.className="progressCancel",c.href="#",c.style.visibility="hidden",c.appendChild(document.createTextNode(" "));var d=document.createElement("div");d.className="progressName",d.appendChild(document.createTextNode(a.name));var e=document.createElement("div");e.className="progressBarInProgress";var f=document.createElement("div");f.className="progressBarStatus",f.innerHTML="&nbsp;",this.fileProgressElement.appendChild(c),this.fileProgressElement.appendChild(d),this.fileProgressElement.appendChild(f),this.fileProgressElement.appendChild(e),this.fileProgressWrapper.appendChild(this.fileProgressElement),document.getElementById(b).appendChild(this.fileProgressWrapper),k(this.fileProgressWrapper,0)}this.height=this.fileProgressWrapper.offsetHeight}var m=window,n=m.FS,o=a("swfupload");l.prototype.setProgress=function(a){this.fileProgressElement.className="progressContainer green",this.fileProgressElement.childNodes[3].className="progressBarInProgress",this.fileProgressElement.childNodes[3].style.width=a+"%"},l.prototype.setComplete=function(){this.fileProgressElement.className="progressContainer blue",this.fileProgressElement.childNodes[3].className="progressBarComplete",this.fileProgressElement.childNodes[3].style.width=""},l.prototype.setError=function(){this.fileProgressElement.className="progressContainer red",this.fileProgressElement.childNodes[3].className="progressBarError",this.fileProgressElement.childNodes[3].style.width=""},l.prototype.setCancelled=function(){this.fileProgressElement.className="progressContainer",this.fileProgressElement.childNodes[3].className="progressBarError",this.fileProgressElement.childNodes[3].style.width=""},l.prototype.setStatus=function(a){this.fileProgressElement.childNodes[2].innerHTML=a},l.prototype.toggleCancel=function(a,b){if(this.fileProgressElement.childNodes[0].style.visibility=a?"visible":"hidden",b){var c=this.fileProgressID;this.fileProgressElement.childNodes[0].onclick=function(){return b.cancelUpload(c),!1}}};var p=function(a){var b=new o(_.extend({upload_url:"#",file_post_name:"file",post_params:{},file_size_limit:"21 MB",file_upload_limit:"0",file_queue_error_handler:d,file_dialog_complete_handler:e,upload_progress_handler:f,upload_error_handler:i,upload_success_handler:g,upload_complete_handler:h,button_width:180,button_height:18,button_text:'<span class="button">Select Images <span class="buttonSmall">(2 MB Max)</span></span>',button_text_style:".button { font-family: Helvetica, Arial, sans-serif; font-size: 12pt; } .buttonSmall { font-size: 10pt; }",button_text_top_padding:0,button_text_left_padding:18,button_window_mode:o.WINDOW_MODE.TRANSPARENT,button_cursor:o.CURSOR.HAND,flash_url:n.BASE_PATH+"/html/fs/assets/swfupload/swfupload.swf",custom_settings:{upload_target:"divFileProgressContainer"},debug:!1},a||{}));this.core=b};_.extend(p.prototype,{destroy:function(){this.core.destroy()}}),c.exports=p});
define("uilibs/innercalendar",["calendar"],function(a,b,c){var d=a("calendar"),e=d.extend({attrs:{align:{getter:function(){var a=this.get("trigger");return a?{selfXY:[0,0],baseElement:a,baseXY:[0,0]}:{selfXY:[0,0],baseXY:[0,0]}}},zIndex:10},setup:function(){var a=this;this.element;var b=e.superclass.setup.call(this);return this.model.on("changeMonth changeYear changeStartday changeMode",function(){a._adjustHeight()}),b},show:function(){var a=e.superclass.show.apply(this,arguments);return this.setFocus(this.get("focus")),a},_adjustHeight:function(){$(this.get("trigger")).height(this.element.outerHeight(!0))},render:function(){var a=e.superclass.render.call(this);return this._adjustHeight(),a}});c.exports=e});
define("uilibs/moment",["moment_core"],function(a,b,c){var d=a("moment_core");d.lang("zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"Ah点mm",L:"YYYY年MMMD日",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日LT",LLLL:"YYYY年MMMD日ddddLT",l:"YYYY年MMMD日",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日LT",llll:"YYYY年MMMD日ddddLT"},meridiem:function(a,b){return 9>a?"早上":11>a&&30>b?"上午":13>a&&30>b?"中午":18>a?"下午":"晚上"},calendar:{sameDay:"[今天]LT",nextDay:"[明天]LT",nextWeek:"[下]ddddLT",lastDay:"[昨天]LT",lastWeek:"[上]ddddLT",sameElse:"L"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1分钟",mm:"%d分钟",h:"1小时",hh:"%d小时",d:"1天",dd:"%d天",M:"1个月",MM:"%d个月",y:"1年",yy:"%d年"}}),c.exports=d});
define("uilibs/pagination",["widget"],function(a,b,c){var d=a("widget"),e=d.extend({attrs:{pageSize:45,totalSize:-1,visiblePageNums:7,activePageNumber:1,pageNums:{value:0,getter:function(){return this._pageNums}},style:"normal"},events:{"click .ui-pagination-num":"_numClick","click .ui-pagination-prev":"_prevClick","click .ui-pagination-next":"_nextClick"},setup:function(){var a=e.superclass.setup.apply(this,arguments);return this._setupPageNums(),a},render:function(){var a=e.superclass.render.apply(this,arguments);return this.element.addClass("ui-pagination fn-clear"),a},_prevClick:function(){var a=this.get("activePageNumber");a>1&&(a--,this.jump(a))},_nextClick:function(){var a=this.get("activePageNumber"),b=this._pageNums;b>a&&(a++,this.jump(a))},_numClick:function(a){var b=$(a.currentTarget),c=parseInt(b.text());b.hasClass("ui-pagination-active")||this.jump(c)},jump:function(a){this.set("activePageNumber",a),this.trigger("page",a)},show:function(){this.element.show()},hide:function(){this.element.hide()},destroy:function(){var a;return this.element.removeClass("ui-pagination"),a=e.superclass.destroy.apply(this,arguments)},_setupPageNums:function(){this._pageNums=Math.ceil(this.get("totalSize")/this.get("pageSize"))},_updateState:function(){var a=this.get("activePageNumber"),b=this.element,c=$(".ui-pagination-prev",b),d=$(".ui-pagination-next",b),e=$(".ui-pagination-num",b);e.removeClass("ui-pagination-active"),c.removeClass("ui-pagination-disabled"),d.removeClass("ui-pagination-disabled"),e.each(function(){var b=$(this);return parseInt(b.text())==a?(b.addClass("ui-pagination-active"),!1):void 0}),1==a&&c.addClass("ui-pagination-disabled"),a==this._pageNums&&d.addClass("ui-pagination-disabled"),e.length<=1?(c.hide(),d.hide(),e.addClass("ui-pagination-disabled")):(c.show(),d.show()),"simple"==this.get("style")&&$(".ui-pagination-num,.ui-pagination-ellipsis",b).hide()},_updateHtml:function(a){var b=$(this.element),c=this._pageNums,d=this.get("visiblePageNums"),e="",f=0,g=d-3,h=0,i=0,j=0;if(c>0){if(d>c)for(f=0;c>f;f++)e+='<li class="ui-pagination-item ui-pagination-num">'+(f+1)+"</li>";else{for(h=Math.floor(g/2),i=Math.ceil(g/2),a>1&&c>a&&(e='<li class="ui-pagination-item ui-pagination-num">'+a+"</li>"),j=a-h,2>j&&(j=2),f=a-1;f>=j;f--)e='<li class="ui-pagination-item ui-pagination-num">'+f+"</li>"+e;for(f++,f>2&&(e='<li class="ui-pagination-item ui-pagination-ellipsis">&#8230;</li>'+e),j=a+i,j>c-1&&(j=c-1),f=a+1;j>=f;f++)e=e+'<li class="ui-pagination-item ui-pagination-num">'+f+"</li>";f--,c-1>f&&(e+='<li class="ui-pagination-item ui-pagination-ellipsis">&#8230;</li>'),e='<li class="ui-pagination-item ui-pagination-num ui-pagination-first">1</li>'+e+'<li class="ui-pagination-item ui-pagination-num ui-pagination-last">'+c+"</li>"}e='<li class="ui-pagination-item ui-pagination-prev">上一页</li>'+e+'<li class="ui-pagination-item ui-pagination-next">下一页</li>',b.html('<ul class="ui-pagination-list fn-clear fn-right">'+e+"</ul>"),this._updateState()}else b.empty()},setTotalSize:function(a){var b=this.get("activePageNumber");this.set("totalSize",a),this._setupPageNums(),this.set("activePageNumber",0),this.set("activePageNumber",b)},reset:function(){var a=$(this.element);this.set("totalSize",-1),this.set("activePageNumber",1),a.empty()},_onRenderActivePageNumber:function(a){a>0&&this._updateHtml(a)},destroy:function(){var a;return this.element.empty(),a=e.superclass.destroy.apply(this,arguments)}});c.exports=e});
define("uilibs/pagination2",["widget","$"],function(a,b,c){var d=a("widget"),e=a("$"),f=d.extend({attrs:{pageSize:10,totalSize:-1,activePageNumber:1,pageNums:{value:0,getter:function(){return this._pageNums}}},events:{"click .fs-pagination-prev":"_prevClick","click .fs-pagination-next":"_nextClick","click .fs-pagination-select":"_showDropDown","mouseover .fs-pagination-select-option":"_onMouseover","mouseout .fs-pagination-select-option":"_onMouseout","click .fs-pagination-select-option":"_numClick"},setup:function(){var a=f.superclass.setup.apply(this,arguments);return this._setupPageNums(),this._setHtml(),this._setEvent(),a},render:function(){var a=f.superclass.render.apply(this,arguments);return this._setHtml(),a},_setupPageNums:function(){var a=this.get("totalSize"),b=this.get("pageSize"),c=this.get("activePageNumber");this._pageNums=Math.ceil(this.get("totalSize")/this.get("pageSize")),this.set("from",(c-1)*b+1),b*c>a?this.set("to",a):this.set("to",this.get("from")+b-1),this._updateStyle(c)},_prevClick:function(){var a=this.get("activePageNumber");a>1&&(a--,this.jump(a))},_nextClick:function(){var a=this.get("activePageNumber"),b=this._pageNums;b>a&&(a++,this.jump(a))},_numClick:function(a){var b=e(a.currentTarget),c=parseInt(b.val());this.jump(c)},_showDropDown:function(a){var b=e(".fs-pagination-option-container",this.element).height();if(Math.abs(e(window).scrollTop()+e(window).height()-e(a.target).offset().top)>=b)e(".fs-pagination-option-container",this.element).css("margin-top","1px");else{var c=b+35;e(".fs-pagination-option-container",this.element).css("margin-top","-"+c+"px")}e(".fs-pagination-option-container",this.element).length>0&&e(".fs-pagination-option-container",this.element).show()},_onMouseover:function(a){e(a.target).hasClass("fs-pagination-option-active")||e(a.target).addClass("fs-pagination-option-active")},_onMouseout:function(a){e(a.target).hasClass("fs-pagination-option-active")&&e(a.target).removeClass("fs-pagination-option-active")},jump:function(a,b){this.set("activePageNumber",a),this._updateStyle(a),b||this.trigger("page",a)},_updateStyle:function(a){var b=this.get("pageSize"),c=this.get("totalSize"),d=this.get("activePageNumber");this.set("from",(a-1)*b+1),b*d>c?this.set("to",c):this.set("to",this.get("from")+b-1),1>c?this.element.hide():this.element.show(),e(".fs-pagination-from",this.element).text(this.get("from")),e(".fs-pagination-to",this.element).text(this.get("to")),e(".fs-pagination-select-title",this.element).text("第"+a+"页"),1!=a||e(".fs-pagination-prev",this.element).hasClass("fs-pagination-button-disable")||e(".fs-pagination-prev",this.element).addClass("fs-pagination-button-disable"),1!=a&&e(".fs-pagination-prev",this.element).hasClass("fs-pagination-button-disable")&&e(".fs-pagination-prev",this.element).removeClass("fs-pagination-button-disable"),a!=this._pageNums||e(".fs-pagination-next",this.element).hasClass("fs-pagination-button-disable")||e(".fs-pagination-next",this.element).addClass("fs-pagination-button-disable"),a!=this._pageNums&&e(".fs-pagination-next",this.element).hasClass("fs-pagination-button-disable")&&e(".fs-pagination-next",this.element).removeClass("fs-pagination-button-disable"),e(".fs-pagination-option-selected",this.element).removeClass("fs-pagination-option-selected"),e("[value="+a+"]",this.element).addClass("fs-pagination-option-selected")},show:function(){this.element.show()},hide:function(){this.element.hide()},_setHtml:function(){var a=e(this.element),b=this._pageNums,c="",d="",f=this.get("from"),g=this.get("to"),h=this.get("activePageNumber"),i=this.get("totalSize");this.get("pageSize"),c+="<span>第</span><span class = 'fs-pagination-from'>"+f+"</span><span>-</span><span class = 'fs-pagination-to'>"+g+"</span><span>项</span>",c+="，<span>共</span><span class = 'fs-pagination-total'>"+i+"</span><span>项</span>&nbsp;&nbsp;",c+=1==h?"<span class = 'fs-pagination-prev fs-pagination-button-disable' title='上一页'><</span>":"<span class = 'fs-pagination-prev' title='上一页'><</span>",d=this._setOptions(b),c+="&nbsp;&nbsp;<span class = 'fs-pagination-select'><span class = 'fs-pagination-select-title-container'><span class = 'fs-pagination-select-title'>第"+h+"页</span>&nbsp;&nbsp;<span class = 'fs-pagination-select-drop'>&nbsp;</span></span>",c+="<div class = 'fn-hide fs-pagination-option-container'><ul>"+d+"</ul></div></span>&nbsp;&nbsp;",c+=h==b?"<span class = 'fs-pagination-next fs-pagination-button-disable' title='下一页'>></span>":"<span class = 'fs-pagination-next' title='下一页'>></span>",a.html(c)},_setEvent:function(){e(document).on("click",function(a){e(a.target).is(".fs-pagination-select-title-container")||e(a.target).is(".fs-pagination-select-title")||e(a.target).is(".fs-pagination-select-drop")||e(".fs-pagination-option-container",this.element).hide()})},_setOptions:function(a){for(var b="",c=this.get("activePageNumber"),d=1;a>=d;d++)b+=d==c?"<li class = 'fs-pagination-select-option fs-pagination-option-selected' value = "+d+">第"+d+"页</li>":"<li class = 'fs-pagination-select-option' value = "+d+">第"+d+"页</li>";return b},setTotalSize:function(a,b){var c=e(this.element);this.set("totalSize",a),1>a?c.hide():c.show(),this._setupPageNums(),e(".fs-pagination-total",this.element).text(a);var d=this._setOptions(this._pageNums);e(".fs-pagination-option-container ul").html(d);var f=this.get("activePageNumber");b&&f!=b&&(this.set("activePageNumber",b),f>this._pageNums&&this.set("activePageNumber",this._pageNums),1>f&&this.set("activePageNumber",1),f=this.get("activePageNumber"),this._updateStyle(f)),f>this._pageNums&&(this.set("activePageNumber",this._pageNums),f=this.get("activePageNumber"),this._updateStyle(f)),1>f&&(this.set("activePageNumber",1),f=this.get("activePageNumber"),this._updateStyle(f))},reset:function(){this.set("activePageNumber",1),this.set("totalSize",0),this._setupPageNums()},getCurrentPageNum:function(){return this.get("activePageNumber")||1},destroy:function(){var a;return a=f.superclass.destroy.apply(this,arguments),this.element&&this.element.empty(),e(document).unbind(),a}});c.exports=f});
!function(a){"use strict";function b(a,b,c){return a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):void 0}function c(a,b){var c,d;for(c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1}function d(a,b){var c;a.createTextRange?(c=a.createTextRange(),c.move("character",b),c.select()):a.selectionStart&&(a.focus(),a.setSelectionRange(b,b))}function e(a,b){try{return a.type=b,!0}catch(c){return!1}}a.Placeholders={Utils:{addEventListener:b,inArray:c,moveCaret:d,changeType:e}}}(this),function(a){"use strict";function b(){}function c(){try{return document.activeElement}catch(a){}}function d(a,b){var c,d,e=!!b&&a.value!==b,f=a.value===a.getAttribute(H);return(e||f)&&"true"===a.getAttribute(I)?(a.removeAttribute(I),a.value=a.value.replace(a.getAttribute(H),""),a.className=a.className.replace(G,""),d=a.getAttribute(O),parseInt(d,10)>=0&&(a.setAttribute("maxLength",d),a.removeAttribute(O)),c=a.getAttribute(J),c&&(a.type=c),!0):!1}function e(a){var b,c,d=a.getAttribute(H);return""===a.value&&d?(a.setAttribute(I,"true"),a.value=d,a.className+=" "+F,c=a.getAttribute(O),c||(a.setAttribute(O,a.maxLength),a.removeAttribute("maxLength")),b=a.getAttribute(J),b?a.type="text":"password"===a.type&&T.changeType(a,"text")&&a.setAttribute(J,"password"),!0):!1}function f(a,b){var c,d,e,f,g,h,i;if(a&&a.getAttribute(H))b(a);else for(e=a?a.getElementsByTagName("input"):p,f=a?a.getElementsByTagName("textarea"):q,c=e?e.length:0,d=f?f.length:0,i=0,h=c+d;h>i;i++)g=c>i?e[i]:f[i-c],b(g)}function g(a){f(a,d)}function h(a){f(a,e)}function i(a){return function(){r&&a.value===a.getAttribute(H)&&"true"===a.getAttribute(I)?T.moveCaret(a,0):d(a)}}function j(a){return function(){e(a)}}function k(a){return function(b){return t=a.value,"true"===a.getAttribute(I)&&t===a.getAttribute(H)&&T.inArray(D,b.keyCode)?(b.preventDefault&&b.preventDefault(),!1):void 0}}function l(a){return function(){d(a,t),""===a.value&&(a.blur(),T.moveCaret(a,0))}}function m(a){return function(){a===c()&&a.value===a.getAttribute(H)&&"true"===a.getAttribute(I)&&T.moveCaret(a,0)}}function n(a){return function(){g(a)}}function o(a){a.form&&(y=a.form,"string"==typeof y&&(y=document.getElementById(y)),y.getAttribute(K)||(T.addEventListener(y,"submit",n(y)),y.setAttribute(K,"true"))),T.addEventListener(a,"focus",i(a)),T.addEventListener(a,"blur",j(a)),r&&(T.addEventListener(a,"keydown",k(a)),T.addEventListener(a,"keyup",l(a)),T.addEventListener(a,"click",m(a))),a.setAttribute(L,"true"),a.setAttribute(H,w),(r||a!==c())&&e(a)}var p,q,r,s,t,u,v,w,x,y,z,A,B,C=["text","search","url","tel","email","password","number","textarea"],D=[27,33,34,35,36,37,38,39,40,8,46],E="#ccc",F="placeholdersjs",G=new RegExp("(?:^|\\s)"+F+"(?!\\S)"),H="data-placeholder-value",I="data-placeholder-active",J="data-placeholder-type",K="data-placeholder-submit",L="data-placeholder-bound",M="data-placeholder-focus",N="data-placeholder-live",O="data-placeholder-maxlength",P=document.createElement("input"),Q=document.getElementsByTagName("head")[0],R=document.documentElement,S=a.Placeholders,T=S.Utils;if(S.nativeSupport=void 0!==P.placeholder,!S.nativeSupport){for(p=document.getElementsByTagName("input"),q=document.getElementsByTagName("textarea"),r="false"===R.getAttribute(M),s="false"!==R.getAttribute(N),u=document.createElement("style"),u.type="text/css",v=document.createTextNode("."+F+" { color:"+E+"; }"),u.styleSheet?u.styleSheet.cssText=v.nodeValue:u.appendChild(v),Q.insertBefore(u,Q.firstChild),B=0,A=p.length+q.length;A>B;B++)z=B<p.length?p[B]:q[B-p.length],w=z.attributes.placeholder,w&&(w=w.nodeValue,w&&T.inArray(C,z.type)&&o(z));x=setInterval(function(){for(B=0,A=p.length+q.length;A>B;B++)z=B<p.length?p[B]:q[B-p.length],w=z.attributes.placeholder,w?(w=w.nodeValue,w&&T.inArray(C,z.type)&&(z.getAttribute(L)||o(z),(w!==z.getAttribute(H)||"password"===z.type&&!z.getAttribute(J))&&("password"===z.type&&!z.getAttribute(J)&&T.changeType(z,"text")&&z.setAttribute(J,"password"),z.value===z.getAttribute(H)&&(z.value=w),z.setAttribute(H,w)))):z.getAttribute(I)&&(d(z),z.removeAttribute(H));s||clearInterval(x)},100)}T.addEventListener(a,"beforeunload",function(){S.disable()}),S.disable=S.nativeSupport?b:g,S.enable=S.nativeSupport?b:h}(this),define("uilibs/placeholder",["$"],function(a,b,c){var d=a("$"),e=d.fn.val,f=d.fn.prop;Placeholders.nativeSupport||(d.fn.val=function(a){var b=e.apply(this,arguments),c=this.eq(0).data("placeholder-value");return void 0===a&&this.eq(0).data("placeholder-active")&&b===c?"":(this.removeClass("placeholdersjs"),b)},d.fn.prop=function(a,b){return void 0===b&&this.eq(0).data("placeholder-active")&&"value"===a?"":f.apply(this,arguments)}),c.exports=function(){}});
define("uilibs/preview",["$","overlay","position","moment","util","swfobject","uilibs/audio-player","modules/fs-attach/fs-attach-file-preview"],function(a,b,c){var d=a("$"),e=a("overlay"),f=a("position"),g=a("moment"),h=a("util"),i=a("swfobject"),j=a("uilibs/audio-player"),k=a("modules/fs-attach/fs-attach-file-preview"),l=(d.browser||0).msie&&6==d.browser.version,m=d(document.body),n=(d("html"),d(document),d(window)),o=k.FileReader,p=0,q=0,r=0,s=new o,t=e.extend({attrs:{width:l?n.width():"100%",height:l?n.height():"100%",className:"ui-preview fs-float-win",opacity:1,backgroundColor:"#000",style:{position:l?"absolute":"fixed",top:0,left:0},align:{baseElement:l?m:void 0},type:"img",data:[],refId:0,activeIndex:-1,zIndex:100},events:{"click .ui-preview-close-btn":"_clickCloseBtn","click .ui-preview-img-panel .ui-preview-nav-item":"previewImg","click .ui-preview-img-panel .ui-preview-img-tools .rotate-l":"rotateLeft","click .ui-preview-img-panel .ui-preview-img-tools .rotate-r":"rotateRight","click .ui-preview-img-panel .ui-preview-img-tools .view-origin":"viewOrigin","click .ui-preview-img-panel .ui-preview-img-tools .download-origin":"downloadOrigin","click .ui-preview-switch-l,.ui-preview-switch-r":"switchItem","click .ui-preview-img-panel .ui-preview-img":"clickPreviewImg","click .ui-preview-attach-wrapper .attach-preview-l":"clickPreviewAttach","click .ui-preview-audio-wrapper .audio-player-wrapper":"clickAudioPlayer"},show:function(){return l&&(this.set("width",n.width()),this.set("height",n.height()),this.element.css({top:n.scrollTop(),left:n.scrollLeft()})),t.superclass.show.call(this)},hide:function(){return this.audioPlayer&&this.audioPlayer.stop(),t.superclass.hide.call(this)},_clickCloseBtn:function(a){this.hide(),a.preventDefault(),a.stopPropagation()},previewImg:function(a){var b=this.element,c=d(".ui-preview-nav-item",b),e=d(a.currentTarget),f=c.index(e);this.set("activeIndex",f),a.stopPropagation()},switchItem:function(a){var b=this.element,c=d(".ui-preview-nav-item",b),e=d(a.currentTarget),f=c.length,g=this.get("activeIndex");e.hasClass("ui-preview-switch-r")?g==f-1?g=0:g++:0==g?g=f-1:g--,this.set("activeIndex",g),a.stopPropagation()},clickPreviewImg:function(a){var b=this.element,c=d(".ui-preview-switch-r",b),e=this.get("activeIndex"),f=this.get("data");e+1==f.length?this.set("activeIndex",0):c.click(),a.stopPropagation()},clickPreviewAttach:function(a){var b=this.get("activeIndex"),c=this.get("data"),d=c[b];s.readFile({fileId:d.fileId,fileName:d.fileName,filePath:d.originPath}),a.preventDefault(),a.stopPropagation()},rotateLeft:function(b){var c=this.element,e=d(".ui-preview-box",c),f=d(".ui-preview-img",e);a.async("jslibs/jquery-rotate-2.2.js",function(){p-=90,f.rotate(p)}),b.stopPropagation()},rotateRight:function(b){var c=this.element,e=d(".ui-preview-box",c),f=d(".ui-preview-img",e);a.async("jslibs/jquery-rotate-2.2.js",function(){p+=90,f.rotate(p)}),b.stopPropagation()},viewOrigin:function(a){a.stopPropagation()},downloadOrigin:function(a){a.stopPropagation()},clickAudioPlayer:function(a){a.stopPropagation()},setup:function(){var a=this;return this._imgSizeStore=[],this._createEl(),this.before("show",function(){h.setFullScreen(!0)}),this.after("show",function(){a._adjustPanel()}),this.after("hide",function(){a._resetPanel(),h.setFullScreen(!1)}),this.element.on("click",function(b){a.hide(),b.stopPropagation()}),this.after("_setPosition",function(){this._adjustPanel(),l&&(this.element.css({top:n.scrollTop(),left:n.scrollLeft()}),this.set("width",n.width()),this.set("height",n.height()))}),l&&n.scroll(function(){var b=a.element;b.is(":visible")&&b.css({top:n.scrollTop(),left:n.scrollLeft()})}),t.superclass.setup.call(this)},_createEl:function(){var a=this.element,b=this.get("type");a.html('<span class="ui-preview-close-btn">&#10005;</span><div class="ui-preview-info"></div><div class="ui-preview-panel ui-preview-'+b+'-panel"><div class="ui-preview-panel-inner"><div class="ui-preview-port"><div class="ui-preview-switch-l"><a href="javascript:;">&#139;</a></div><div class="ui-preview-switch-r"><a href="javascript:;">&#155;</a></div><div class="ui-preview-box"></div></div><div class="ui-preview-action-panel"></div></div></div>'),"img"==b||"qximg"==b?this._createImgEl():"attach"==b?this._createAttachEl():"audio"==b&&this._createAudio(),this._createNavEl(),d(".ui-preview-nav-item",a).length>1?(d(".ui-preview-switch-l,.ui-preview-switch-r",a).show(),d(".ui-preview-action-panel",a).show()):(d(".ui-preview-switch-l,.ui-preview-switch-r",a).hide(),d(".ui-preview-action-panel",a).hide(),d(".batch-download-origin",a).hide()),d(".ui-preview-info",a).click(function(a){a.stopPropagation()})},_createAttachEl:function(){var a=this.element,b=d(".ui-preview-box",a);b.html('<div class="ui-preview-attach-wrapper fn-clear"><div class="ui-preview-attach-icon"><img src="'+FS.BLANK_IMG+'" alt="loading" class="icon-file" /></div><div class="ui-preview-attach-content"><h3 class="ui-preview-attach-name"></h3><p class="ui-preview-attach-size"></p><p class="ui-preview-attach-create-time"></p><p class="ui-preview-attach-actions"></p></div></div>')},_createImgEl:function(){var a,b,c=this.element,e=d(".ui-preview-box",c),f=this.get("data"),g=[],h=[];_.each(f,function(a){g.push(a.originPath+".jpg"),h.push(encodeURIComponent(a.fileName))}),g=g.join("|"),h=h.join("|"),f.length>0&&(b=f[0].refId,a=f[0].source||1);var i=FS.API_PATH+"/df/GetBatchFiles1?dataID="+(b&&b)+"&source="+a+"&attachType=2",j=_.map(f,function(a){return a.attachPath+"1.jpg"}).join("|")+"&names="+_.map(f,function(a){return encodeURIComponent(a.fileName)}).join("|");"noid"==b&&(i=FS.API_PATH+"/df/GetBatchGlobalFiles?ids="+j),e.html('<div class="ui-preview-img-wrapper"><img src="'+FS.BLANK_IMG+'" alt="loading" class="ui-preview-img" /></div><div class="ui-preview-img-tools"><span class="rotate-l">&#8630;向左旋转</span>&nbsp;&nbsp;&nbsp;<span class="rotate-r">&#8631;向右旋转</span>&nbsp;&nbsp;&nbsp;<a class="view-origin" href="#" target="_blank">查看原图</a>&nbsp;&nbsp;&nbsp;<a class="download-origin" href="#" target="_blank">下载原图</a>&nbsp;&nbsp;&nbsp;<a class="batch-download-origin" href="'+i+'" target="_blank">打包下载</a></div>')},_createAudio:function(){var a=this.element,b=d(".ui-preview-box",a);b.html('<div class="ui-preview-audio-wrapper"><div class="audio-player-wrapper" id="preview-audio-player-'+r+'"></div><div class="audio-info"><p class="ui-preview-attach-name"></p><p class="audio-duration">时长：<span class="duration-value">0秒</span></p><p class="upload-info"></p></div></div>'),r++},_createNavEl:function(){var a=this,b=this.element,c=d(".ui-preview-action-panel",b),e=d('<div class="ui-preview-nav-indicator fn-hide"></div>'),f=d('<div class="ui-preview-nav-wrapper"></div>'),g="",h=this.get("data"),i=this.get("type");"img"==i?(c.show(),_.each(h,function(b){g+='<li class="ui-preview-nav-item" originpath="'+b.originPath+'" thumbpath="'+b.thumbPath+'" previewpath="'+b.previewPath+'"><div class="img-center-wrapper"><img src="'+a._getFileLink(b.thumbPath,b.fileName,!1,"jpg")+'" alt="loading" width="50" /></div></li>'})):(c.hide(),_.each(h,function(){g+='<li class="ui-preview-nav-item"><div class="img-center-wrapper"><img src="'+FS.BLANK_IMG+'" alt="loading" /></div></li>'})),f.html('<ul class="ui-preview-nav-list fn-clear">'+g+'</ul><div class="ui-preview-thumb-box"></div>'),e.appendTo(c),f.appendTo(c)},_adjustPanel:function(){var a=this.get("type");_.str.trim(this.element.text()).length>0&&(this._setPortHeight(),this._setInfoHeight(),this._setSwitchPosition(),this._setNavPosition(),"img"==a?(this._adjustImgPanel(),this._adjustImg()):"attach"==a?this._adjustAttachPanel():"audio"==a&&this._adjustAudioPanel())},_adjustAudioPanel:function(){var a=this.element,b=d(".ui-preview-box",a),c=d(".ui-preview-audio-wrapper",b);f.center(c,b)},_adjustAttachPanel:function(){var a=this.element,b=d(".ui-preview-box",a),c=d(".ui-preview-attach-wrapper",b);f.center(c,b)},_adjustImgPanel:function(){this._setImgBoxSize(),this._setImgBoxPosition()},_setImgBoxSize:function(){var a=this.element,b=d(".ui-preview-box",a),c=d(".ui-preview-img-wrapper",b),e=b.height(),f=b.width();c.height(1*e-50).css({"line-height":1*e-50+"px"}),c.width(1*f-2)},_setImgBoxPosition:function(){var a=this.element,b=d(".ui-preview-box",a);d(".ui-preview-img-wrapper",b)},_getPreviewImgSize:function(a){var b=this._imgSizeStore,c=null;return _.some(b,function(b){return b.src==a?(c=b.size,!0):void 0}),c},_isInPreviewImgStore:function(a){var b=this._imgSizeStore;return _.some(b,function(b){return b.src==a})},_adjustImg:function(){var a=this.element,b=d(".ui-preview-box",a),c=d(".ui-preview-img-wrapper",b),e=d(".ui-preview-img",c),f=e.data("size"),g=this._getPreviewImgSize(e.attr("src")),h={};f&&(f.width/f.height>=g.width/g.height?f.width>g.width?(h.width=g.width,h.height=f.height*g.width/f.width):(h.width=f.width,h.height=f.height):f.height>g.height?(h.height=g.height,h.width=f.width*g.height/f.height):(h.width=f.width,h.height=f.height),e.width(h.width),e.height(h.height))},_setSwitchPosition:function(){var a=this.element,b=d(".ui-preview-port",a),c=d(".ui-preview-switch-l",a),e=d(".ui-preview-switch-r",a);f.pin({element:c,x:0,y:60},{element:b,x:0,y:"50%"}),f.pin({element:e,x:60,y:60},{element:b,x:"100%",y:"50%"})},_setNavPosition:function(a){var b=this.element,c=d(".ui-preview-nav-wrapper",b),e=d(".ui-preview-nav-list",b),g=d(".ui-preview-thumb-box",b),h=a?f.pinWithAnimate:f.pin;h({element:e,x:d(".ui-preview-nav-item",e).outerWidth(!0)/2+q,y:0},{element:c,x:"50%",y:0}),f.pin({element:g,x:"50%",y:0},{element:c,x:"50%",y:0})},_setNavListWidth:function(){var a=this.element,b=d(".ui-preview-nav-list",a),c=d(".ui-preview-nav-item",a),e=0;c.each(function(){e+=d(this).outerWidth(!0)}),b.width(e)},_setPortHeight:function(){var a,b=this.element,c=d(".ui-preview-port",b),e=d(".ui-preview-action-panel",b),f=b.height();e.is(":visible")?(a=e.outerHeight(!0),c.height(f-a)):c.height(f)},_setInfoHeight:function(){var a=this.element,b=d(".ui-preview-info",a);b.height(a.height())},_onRenderActiveIndex:function(a){var b,c,e,f,i,k,l,m,n,o,r,s,t,u,v,w,x,y,z=this,A=this.element,B=d(".ui-preview-nav-indicator",A),C=d(".ui-preview-nav-item",A),D=C.eq(a),E=d(".ui-preview-box",A),F=this.get("data"),G=F[a],H=this.get("type");C.removeClass("state-active"),D.addClass("state-active"),G&&(b=G.serverTime?g.unix(G.serverTime):g(),"img"==H?(e=d(".ui-preview-img-wrapper",E),f=d(".ui-preview-img",E),r=d('<img class="ui-preview-img" />'),u=D.attr("previewpath"),v=D.attr("originpath"),w=0,a>-1&&(p=0,w=C.eq(0).outerWidth(!0),q=w*a,e.html('<img src="'+FS.ASSETS_PATH+"/"+"images/loading.gif"+'" /><span style="inline-block;"> </span>'),y=this._getFileLink(u,G.fileName,!1,"jpg"),this._isInPreviewImgStore(y)?(e.html('<img src="'+y+'" alt="loaded" class="ui-preview-img" /><span style="inline-block;"> </span>'),z._adjustImg()):r.load(function(){var a=d(this),b=a.get(0),c=b.width,f=b.height,g=a.attr("src");e.empty(),e.html('<img src="'+g+'" alt="loaded" class="ui-preview-img" /><span style="inline-block;"> </span>'),z._imgSizeStore.push({src:g,size:{width:c,height:f}}),z._adjustImg(),r.unbind("load").remove(),r=null}).attr("src",y).addClass("fn-hide-abs").appendTo("body"),A.is(":visible")&&this._setNavPosition(!0),B.html("第&nbsp;"+(a+1)+"&nbsp;个（共&nbsp;"+C.length+"&nbsp;个）"),d(".view-origin",E).attr("href",this._getFileLink(v,G.fileName,!1,"jpg")),d(".download-origin",E).attr("href",this._getFileLink(v,G.fileName,!0,"jpg")))):"attach"==H?(i=d(".ui-preview-attach-wrapper",E),l=d(".ui-preview-attach-icon img",i),n=d(".ui-preview-attach-name",i),m=d(".ui-preview-attach-size",i),k=d(".ui-preview-attach-create-time",i),o=d(".ui-preview-attach-actions",i),l.addClass("icon-file-"+h.getFileType({name:G.fileName},!0)),n.text(G.fileName),m.text(h.getFileSize(G.fileSize)),k.text((G.employeeName||"")+"上传于"+h.getDateSummaryDesc(g.unix(G.createTime),b,1)),c='<a href="'+this._getFileLink(G.originPath,G.fileName,!0)+'" target="_blank">下载</a>',G.canPreview&&(c+='&nbsp;&nbsp;&nbsp;<a href="#" title="预览" class="attach-preview-l">预览</a>'),o.html(c)):"audio"==H&&(s=d(".ui-preview-audio-wrapper",E),t=d(".audio-player-wrapper",s),x=h.getFileNamePath(G.originPath)+".mp3",x=this._getFileLink(x,G.fileName,!1),this.audioPlayer||(this.audioPlayer=new j({element:t,audioSrc:x,length:G.fileSize,themeStyle:4})),this.audioPlayer.play(),d(".ui-preview-attach-name",s).text(h.getFileNamePath(G.fileName)+".mp3"),d(".duration-value",s).text(G.fileSize+"秒"),d(".upload-info",s).text((G.employeeName||"")+"上传于"+h.getDateSummaryDesc(g.unix(G.createTime),b,1))))},_getFileLink:function(){var a=this.get("belongToType"),b=Array.prototype.slice.call(arguments);return"qx"==a?h.getFileUrl(this,b):h.getDfLink.apply(this,b)},_resetPanel:function(){this.set("activeIndex",-1)},_onRenderData:function(a){this._clear(),a.length>0?(this._createEl(),this._adjustPanel()):this.element.empty()},_onRenderType:function(){this._clear(),this._createEl(),this._adjustPanel()},_onRenderBackgroundColor:function(a){this.element.css("backgroundColor",a)},_onRenderOpacity:function(a){this.element.css("opacity",a)},_clear:function(){this.audioPlayer&&this.audioPlayer.destroy(),this.audioPlayer=null},destroy:function(){var a;return this._imgSizeStore=null,this.audioFlashRendered&&i.removeSWF("preview-audio-player-"+r),this.element.empty(),a=t.superclass.destroy.apply(this,arguments)}});c.exports=t});
define("uilibs/scrollbar/scrollbar",["tinyscrollbar"],function(a,b,c){var d=window;d.FS,a("tinyscrollbar");var e=function(a){a=_.extend({element:null},a||{}),this.element=$(a.element),this.opts=a,this._originOffset="overflow",this._wrapperEl=null,this.init()};_.extend(e.prototype,{init:function(){var a=this.element,b=$('<div class="fs-scrollbar"></div>'),c=$('<div class="fs-scrollbar-inner viewport"></div>');b.html('<div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div></div></div></div>'),b.insertAfter(a),c.css({overflow:"hidden",height:a.outerHeight()}).appendTo(b),a.addClass("fs-scrollbar-box overview"),this._originOffset=a.css("overflow"),a.css("overflow","visible").css({height:"auto"}).appendTo(c),b.tinyscrollbar(),a.data("ins",this),this._wrapperEl=b},update:function(a){this._wrapperEl.tinyscrollbar_update(a)},hide:function(){this._wrapperEl.hide()},show:function(){this._wrapperEl.show()},destroy:function(){var a=this._wrapperEl;$(".fs-scrollbar-box",a).removeData().insertAfter(a).removeClass("fs-scrollbar-box").css("overflow",this._originOffset),a.remove(),this._wrapperEl=null}}),c.exports=e});
define("uilibs/search-box",["util","events"],function(a,b,c){var d=window,e=d.FS;e.tpl;var f=a("util"),g=a("events"),h=function(a){a=_.extend({element:null,placeholder:"",autoRender:!0},a||{}),this.opts=a,this.element=$(a.element),this.init()};_.extend(h.prototype,{init:function(){var a=this.opts;this.element,a.autoRender&&this.render(),this.bindEvent()},render:function(){var a=this.element,b=this.opts,c=b.placeholder;a.addClass("ui-search-box"),a.html('<span class="ui-search-box-inner"><input type="text" class="ui-search-field crm-textfield" placeholder="'+c+'" /><button type="button" class="button-submit">搜索</button></span>'),f.placeholder($(".ui-search-field",a))},bindEvent:function(){var a=this,b=this.element;b.on("click",".button-submit",function(){a.trigger("search",a.getValue())}).on("keydown",".ui-search-field",function(b){13==b.keyCode&&(a.trigger("search",a.getValue()),b.preventDefault())})},getValue:function(){return _.str.trim($(".ui-search-field",this.element).val())},clear:function(){$(".ui-search-field",this.element).val("")},destroy:function(){var a=this.element;a.removeClass("ui-search-box"),a.off(),a.empty()}}),g.mixTo(h),c.exports=h});
define("uilibs/select-colleague",["dialog","util","uilibs/pagination2"],function(a,b,c){var d=a("dialog"),e=a("util"),f=a("uilibs/pagination2"),g=d.extend({attrs:{title:"选择同事",content:"",multiSelect:!1,hasDeptTree:!1,width:1050,height:675,condition:{},defaultCondition:{queryType:0,isFirstChar:!1,keyword:"",circleID:-1,exceptEmployeeIDs:[],isStop:!1,pageSize:20,pageNumber:1},result:[]},setup:function(){var a=g.superclass.setup.apply(this,arguments);this.set("content",this._getTemplate());var b=_.extend(this.get("condition"),this.get("defaultCondition"));return this.set("condition",b),a},render:function(){var a=g.superclass.render.apply(this,arguments);return this._initOthers(),a},hide:function(){var a=g.superclass.hide.apply(this,arguments);return a},show:function(){var a=g.superclass.show.apply(this,arguments);return this._getData(),a},events:{"click .fs-col-select-search-button":"_onButtonClick","click .fs-col-select-button-group1":"_onWorkingButtonClick","mouseover .fs-col-select-button-group1":"_onButtonGroupMouseOver","mouseout .fs-col-select-button-group1":"_onButtonGroupMouseOut","click .fs-col-select-button-group2":"_onLeaveButtonClick","mouseover .fs-col-select-button-group2":"_onButtonGroupMouseOver","mouseout .fs-col-select-button-group2":"_onButtonGroupMouseOut","click .fs-col-select-colleague":"_onColleageClick","mouseover .fs-col-select-colleague":"_onColleageMouseOver","mouseout .fs-col-select-colleague":"_onColleageMouseOut"},_initOthers:function(){var a=this;a.pagination=new f({element:$(".fs-col-select-result-pagination",a.element),pageSize:a.get("condition").pageSize,totalSize:0,activePageNumber:1}),a.pagination.on("page",function(b){var c=a.get("condition");c.pageNumber=b,a.set("condition",c),a._getData(c)})},_getData:function(a){var b=this.get("defaultCondition");a&&(b=_.extend(b,a));var c=this;e.api({url:"/Employee/GetEmployeesForSearch",type:"get",data:b,success:function(a){a.success&&c._getColleagueHtml(a.value.employees,a.value.totalCount)}})},_getTemplate:function(){var a="",b=this.get("title");return a+="<div class = 'fs-col-select-title'>"+b+"</div>",a+="<div class = 'fs-col-select-content'>"+this._getContent()+"</div>",a+="<div class = 'fs-col-select-footer'>footer</div>"},_getContent:function(){var a="";return a+="<div class ='fs-col-select-tree-container fn-left'>"+this._getTreeHtml()+"</div>",a+="<div class = 'fs-col-select-search-container fn-right fn-clear'>"+this._getSearchHtml()+"</div>"},_getTreeHtml:function(){var a="";return this.get("hasDeptTree"),a},_getSearchHtml:function(){var a="<div class = 'fs-col-select-search-title-container fn-clear'><div class = 'fs-col-select-display-all fn-left'><button class='button-blue'>显示全部</button></div>";return a+="<div class = 'fs-col-select-search-box fn-left'><input class = 'fs-col-select-search-input' placeholder='按姓名搜索'/><div class = 'fs-col-select-search-button fn-right'><div class = 'fs-col-select-search-icon'></div></div></div>",a+="<div class = 'fn-right fn-clear'><button class = 'fs-col-select-button-group1'>在职</button><button class = 'fs-col-select-button-group2'>离职</button></div></div>",a+="<div class = 'fs-col-select-result-container fn-clear'></div><div class = 'fs-col-select-result-pagination fn-right fn-clear'></div>"},_getColleagueHtml:function(a,b){var c="";return a?(this.pagination.get("totalSize")!=b&&this.pagination.setTotalSize(b),$(".fs-col-select-result-container",this.element).empty(),_.each(a,function(a){c+="<div class = 'fs-col-select-colleague fn-left fn-clear' data-value = '"+a.employeeID+"' data-name ='"+a.name+"'><img src ='"+e.getAvatarLink(a.profileIamge,"4")+"' class = 'fs-col-select-colleague-img' data-value = '"+a.employeeID+"' data-name ='"+a.name+"' />&nbsp;&nbsp;"+a.name+"</div>"}),$(".fs-col-select-result-container",this.element).html(c),void 0):c},_onButtonClick:function(){var a=this.get("condition");a.keyword=$(".fs-col-select-search-input",this.element).val(),this.set("condition",a),this._getData(a)},_onWorkingButtonClick:function(a){var b=this.get("condition");b.isStop&&(b.isStop=!1,$(a.currentTarget).hasClass("fs-col-select-button-group-selected")||$(a.currentTarget).addClass("fs-col-select-button-group-selected"),$(".fs-col-select-button-group2",this.element).hasClass("fs-col-select-button-group-selected")&&$(".fs-col-select-button-group2").removeClass("fs-col-select-button-group-selected"),this.set("condition",b),this._getData(b))},_onLeaveButtonClick:function(a){var b=this.get("condition");b.isStop||(b.isStop=!0,$(a.currentTarget).hasClass("fs-col-select-button-group-selected")||$(a.currentTarget).addClass("fs-col-select-button-group-selected"),$(".fs-col-select-button-group1",this.element).hasClass("fs-col-select-button-group-selected")&&$(".fs-col-select-button-group1").removeClass("fs-col-select-button-group-selected"),this.set("condition",b),this._getData(b))},_onButtonGroupMouseOver:function(a){$(a.currentTarget).hasClass("fs-col-select-button-group-active")||$(a.currentTarget).addClass("fs-col-select-button-group-active")},_onButtonGroupMouseOut:function(a){$(a.currentTarget).hasClass("fs-col-select-button-group-active")&&$(a.currentTarget).removeClass("fs-col-select-button-group-active")},_onColleageClick:function(){this.get("multiSelect")},_onColleageMouseOver:function(a){!$(a.currentTarget).hasClass("fs-col-select-colleague-active")&&$(a.currentTarget).hasClass("fs-col-select-colleague")&&$(a.currentTarget).addClass("fs-col-select-colleague-active")},_onColleageMouseOut:function(a){$(a.currentTarget).hasClass("fs-col-select-colleague-active")&&$(a.currentTarget).removeClass("fs-col-select-colleague-active")}});c.exports=g});
define("uilibs/select",["select_core"],function(a,b,c){function d(a,b){var c,d,e,f,g=[],h=[];for(c=0,e=a.length;e>c;c++){var i=a[c];i.selected?(i.selected=i.defaultSelected="true",h.push(c)):i.selected=i.defaultSelected="false",g.push(i)}if(h.length>0)for(h.pop(),d=0,f=h.length;f>d;d++)g[d].selected="false";return{select:g,classPrefix:b}}function e(a,b){var c;return c=$.isNumeric(a)?a:"string"==typeof a?b.index(b.parent().find(a)):b.index(a)}var f=window,g=f.FS;g.tpl;var h=a("select_core"),i=h.extend({attrs:{autoWidth:!0},initAttrs:function(a,b){h.superclass.initAttrs.call(this,a,b);var c=this.get("trigger");if("select"==c[0].tagName.toLowerCase()){var e=c.attr("name");e&&this.set("name",e),this.set("selectSource",c);var f='<a href="#" class="'+this.get("classPrefix")+'-trigger"></a>',g=$(f);this.set("trigger",g),c.after(g).hide(),this.model=convertSelect(c[0],this.get("classPrefix"))}else{var e=this.get("name");if(e){var i=$("input[name="+e+"]").eq(0);i[0]||(i=$('<input type="hidden" id="select-'+e+'" name="'+e+'" />').insertBefore(c)),this.set("selectSource",i)}this.model=d(this.model,this.get("classPrefix"))}},removeOption:function(a){var b=i.superclass.removeOption.apply(this,arguments),c=e(a,this.options),d=this.model.select;return d.splice(c,1),b},addOption:function(){i.superclass.removeOption.apply(this,["[data-value=temp]"]),i.superclass.addOption.apply(this,arguments)},render:function(){var a=this.get("autoWidth");return h.superclass.render.call(this),a&&this._setTriggerWidth(),this},_onRenderSelectedIndex:function(a){if(-1!=a){var b=this.options.eq(a),c=this.currentItem,d=b.attr("data-value");if(!c||b[0]!=c[0]){var e=this.get("selectSource");e&&(e[0].value=d),c&&c.attr("data-selected","false").removeClass(this.get("classPrefix")+"-selected"),b.attr("data-selected","true").addClass(this.get("classPrefix")+"-selected"),this.set("value",d);var f=this.get("trigger"),g=f.find("[data-role=trigger-content]");g.length?g.html(b.html()):f.is(":text,textarea,select")?f.val(b.text()):f.html(b.html()),this.currentItem=b}}}});c.exports=i});
define("uilibs/select2",["util","events","$"],function(a,b,c){var d=window,e=d.FS;e.tpl;var f=(a("util"),a("events")),g=a("$"),h=function(a){a=_.extend({element:null,options:[],defaultOption:null,autoRender:!0},a||{}),this.opts=a,this.element=g(a.element),this.options=a.options,this.init()};_.extend(h.prototype,{init:function(){var a=this.opts;a.defaultOption?this.selected=a.defaultOption:this.options&&(this.selected=this.options[0]),a.autoRender&&this.render()},_bindEvents:function(){var a=this;this.element.on("click",".fs-select",function(){g(".fs-select-option-container",this.element).length>0&&g(".fs-select-option-container",this.element).toggle()}),this.element.on("click","ul li",function(){var b={value:g(this).val(),text:g(this).text()};a.change(b)}),this.element.on("mouseover","ul li",function(){g(this).hasClass("fs-select-active")||g(this).addClass("fs-select-active")}),this.element.on("mouseout","ul li",function(){g(this).hasClass("fs-select-active")&&g(this).removeClass("fs-select-active")}),g(document).on("click",function(a){g(a.target).is(".fs-select")||g(a.target).is(".fs-select-text")||g(a.target).is(".fs-select-drop")||g(".fs-select-option-container",this.element).hide()})},change:function(a){this.lastSelected=this.selected,this.selected=a,this._changeSelectedStyle(this.lastSelected,this.selected),g(".fs-select-option-container",this.element).hide(),this.trigger("selected",a)},_changeSelectedStyle:function(a,b){g("[value="+a.value+"]",this.element).hasClass("fs-select-selected")&&g("[value="+a.value+"]",this.element).removeClass("fs-select-selected"),g("[value="+b.value+"]",this.element).hasClass("fs-select-selected")||g("[value="+b.value+"]",this.element).addClass("fs-select-selected")},render:function(){var a=this.element,b="",c=this;_.each(this.options,function(a){b+=c.selected.value==a.value?"<li class = 'fs-select-option fs-select-selected' value = "+a.value+">"+a.text+"</li>":"<li class = 'fs-select-option' value = "+a.value+">"+a.text+"</li>"}),a.html("<div class = 'fs-select-container'><div class = 'fn-right fn-clear fs-select'><div class = 'fn-left fs-select-text'>更多操作</div><div class = 'fn-right fn-clear fs-select-drop'>&nbsp;</div></div></div><div class = 'fn-hide fs-select-option-container'><ul>"+b+"</ui></div>"),this._bindEvents()},destroy:function(){this.element.off(),this.element.empty(),this.options=[],this.selected=null,this.lastSelected=null}}),f.mixTo(h),c.exports=h});
define("uilibs/tabs",["tabs_core"],function(a,b,c){var d=a("tabs_core"),e=d.extend({attrs:{withTabEffect:!0,triggerBgTop:0,triggerBgLeft:0,triggerBgCls:""},setup:function(){var a;return this._setupTabEffect(),a=e.superclass.setup.apply(this,arguments)},render:function(){var a=e.superclass.render.apply(this,arguments);return a},_setupTabEffect:function(){var a,b=this.get("withTabEffect"),c=this.get("triggers").parent();b&&(a=$('<div class="ui-tab-trigger-bg"></div>'),c.wrap('<div class="'+this.get("triggerBgCls")+' ui-tab-trigger-wrapper"></div>'),a.insertAfter(c),this._adjustTriggerBg())},_adjustTriggerBg:function(){var a=this.get("activeIndex"),b=this.get("triggers").eq(a),c=b.closest(".ui-tab-trigger-wrapper").find(".ui-tab-trigger-bg"),d=b.position(),e=this.get("triggerBgTop"),f=this.get("triggerBgLeft");c.width(b.outerWidth()),c.css({left:d.left+f,top:e?e:d.top-2})},adjustTriggerBg:function(){this._adjustTriggerBg()},addTabs:function(a){var b=this,c=this.triggers.length;a=[].concat(a),_.each(a,function(a,d){var e=$(a.trigger),f=$(a.panel);e.addClass(this.CONST.TRIGGER_CLASS),e.data("value",c+d),b._bindTriggersFormArgs(e),f.addClass(b.CONST.PANEL_CLASS),b.set("triggers",b.get("triggers").add(e)),b.set("panels",b.get("panels").add(f))})},_bindTriggers:function(){function a(a){var b=$(this),h=b.position();g?(c=d.get("triggers").closest(".ui-tab-trigger-wrapper").find(".ui-tab-trigger-bg"),c.stop(!0,!0).animate({left:h.left+f,top:e?e:h.top-2},300,"swing",function(){d._onFocusTrigger(a.type,b.data("value")),d._adjustTriggerBg()})):d._onFocusTrigger(a.type,b.data("value"))}function b(){clearTimeout(d._switchTimer)}var c,d=this,e=this.get("triggerBgTop"),f=this.get("triggerBgLeft"),g=this.get("withTabEffect");"click"===this.get("triggerType")?this.triggers.click(a):this.triggers.hover(a,b)},_switchTrigger:function(){var a=e.superclass._switchTrigger.apply(this,arguments),b=this.get("triggers").closest(".ui-tab-trigger-wrapper").find(".ui-tab-trigger-bg"),c=this.get("triggers").eq(this.get("activeIndex")),d=c.position(),f=this.get("triggerBgTop"),g=this.get("triggerBgLeft");return b.css({left:d.left+g,top:f?f:d.top-2}),a},_bindTriggersFormArgs:function(a){function b(a){d._onFocusTrigger(a.type,$(this).data("value"))}function c(){clearTimeout(d._switchTimer)}var d=this,e=$(a);"click"===this.get("triggerType")?e.click(b):e.hover(b,c)}});c.exports=e});
define("uilibs/tabs2",["widget"],function(a,b,c){var d=a("widget"),e=d.extend({attrs:{element:null,container:null,items:[],defaultItem:{},active:""},events:{"click .crm-tab-btn":"_select","mouseover .crm-tab-btn":"_onMouseover","mouseout .crm-tab-btn":"_onMouseout"},setup:function(){var a=e.superclass.render.apply(this,arguments);return this._generateHtml(),a},render:function(){var a=e.superclass.render.apply(this,arguments);return a},_select:function(a){var b=$(a.currentTarget);this.select(b.attr("data-value"))},select:function(a){var b=this.get("active"),c=this.get("element"),d=this.get("container");if(a&&a!=b){var e=$(".crm-tab-selected",this.element);if(e){var f=e.attr("data-value");$("."+f+"-box",d).hide(),$("."+f+"-icon",c).hide(),e.removeClass("crm-tab-selected")}this.trigger("change",b,a),this.set("active",a),$("[data-value="+a+"]",c).hasClass("crm-tab-selected")||$("[data-value="+a+"]",c).addClass("crm-tab-selected"),$("."+a+"-icon",c).show(),$("."+a+"-box",d).show()}},_onMouseover:function(a){var b=$(a.currentTarget);$(b).hasClass("crm-tab-hover")||$(b).addClass("crm-tab-hover")},_onMouseout:function(a){var b=$(a.currentTarget);$(b).hasClass("crm-tab-hover")&&$(b).removeClass("crm-tab-hover")},_generateHtml:function(){var a="",b=(this.get("element"),this.get("container")),c=this.get("defaultItem"),d=this.get("items");c.value||(c=d[0]),b||(b=$("body")),a+="<ul class = 'crm-tab-menu'>",_.each(d,function(d){d.value==c.value?(a+="<li class = 'crm-tab-btn fn-left crm-tab-selected' data-value = '"+d.value+"'>"+d.text+"<div class = 'crm-tab-selected-icon "+d.value+"-icon'>&nbsp;</div></li>",$("."+d.value+"-box",b).show()):(a+="<li class = 'crm-tab-btn fn-left' data-value = '"+d.value+"'>"+d.text+"<div class = 'crm-tab-selected-icon fn-hide "+d.value+"-icon'>&nbsp;</div></li>",$("."+d.value+"-box",b).hide())}),a+="<div class = 'fn-clear'></div></ul>",this.set("active",c.value),this.element.html(a)},destroy:function(){var a=e.superclass.render.apply(this,arguments);return a}});c.exports=e});
define("uilibs/uploader/flashuploader",["swfupload"],function(a,b,c){function d(a,b,c){try{var d="error.gif",e="";if(b===o.errorCode_QUEUE_LIMIT_EXCEEDED&&(e="You have attempted to queue too many files."),""!==e)return alert(e),void 0;switch(b){case o.QUEUE_ERROR.ZERO_BYTE_FILE:d="zerobyte.gif";break;case o.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:d="toobig.gif";break;case o.QUEUE_ERROR.ZERO_BYTE_FILE:case o.QUEUE_ERROR.INVALID_FILETYPE:default:alert(c)}j("images/"+d)}catch(f){this.debug(f)}}function e(a,b){try{b>0&&this.startUpload()}catch(c){this.debug(c)}}function f(a,b){try{var c=Math.ceil(100*(b/a.size)),d=new l(a,this.customSettings.upload_target);d.setProgress(c),100===c?(d.setStatus("Creating thumbnail..."),d.toggleCancel(!1,this)):(d.setStatus("Uploading..."),d.toggleCancel(!0,this))}catch(e){this.debug(e)}}function g(a,b){try{var c=new l(a,this.customSettings.upload_target);"FILEID:"===b.substring(0,7)?(j("thumbnail.php?id="+b.substring(7)),c.setStatus("Thumbnail Created."),c.toggleCancel(!1)):(j("images/error.gif"),c.setStatus("Error."),c.toggleCancel(!1),alert(b))}catch(d){this.debug(d)}}function h(a){try{if(this.getStats().files_queued>0)this.startUpload();else{var b=new l(a,this.customSettings.upload_target);b.setComplete(),b.setStatus("All images received."),b.toggleCancel(!1)}}catch(c){this.debug(c)}}function i(a,b,c){var d,e="error.gif";try{switch(b){case o.UPLOAD_ERROR.FILE_CANCELLED:try{d=new l(a,this.customSettings.upload_target),d.setCancelled(),d.setStatus("Cancelled"),d.toggleCancel(!1)}catch(f){this.debug(f)}break;case o.UPLOAD_ERROR.UPLOAD_STOPPED:try{d=new l(a,this.customSettings.upload_target),d.setCancelled(),d.setStatus("Stopped"),d.toggleCancel(!0)}catch(g){this.debug(g)}case o.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:e="uploadlimit.gif";break;default:alert(c)}j("images/"+e)}catch(h){this.debug(h)}}function j(a){var b=document.createElement("img");if(b.style.margin="5px",document.getElementById("thumbnails").appendChild(b),b.filters)try{b.filters.item("DXImageTransform.Microsoft.Alpha").opacity=0}catch(c){b.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}else b.style.opacity=0;b.onload=function(){k(b,0)},b.src=a}function k(a,b){var c=5,d=30;if(100>b)if(b+=c,b>100&&(b=100),a.filters)try{a.filters.item("DXImageTransform.Microsoft.Alpha").opacity=b}catch(e){a.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+b+")"}else a.style.opacity=b/100;100>b&&setTimeout(function(){k(a,b)},d)}function l(a,b){if(this.fileProgressID="divFileProgress",this.fileProgressWrapper=document.getElementById(this.fileProgressID),this.fileProgressWrapper)this.fileProgressElement=this.fileProgressWrapper.firstChild,this.fileProgressElement.childNodes[1].firstChild.nodeValue=a.name;else{this.fileProgressWrapper=document.createElement("div"),this.fileProgressWrapper.className="progressWrapper",this.fileProgressWrapper.id=this.fileProgressID,this.fileProgressElement=document.createElement("div"),this.fileProgressElement.className="progressContainer";var c=document.createElement("a");c.className="progressCancel",c.href="#",c.style.visibility="hidden",c.appendChild(document.createTextNode(" "));var d=document.createElement("div");d.className="progressName",d.appendChild(document.createTextNode(a.name));var e=document.createElement("div");e.className="progressBarInProgress";var f=document.createElement("div");f.className="progressBarStatus",f.innerHTML="&nbsp;",this.fileProgressElement.appendChild(c),this.fileProgressElement.appendChild(d),this.fileProgressElement.appendChild(f),this.fileProgressElement.appendChild(e),this.fileProgressWrapper.appendChild(this.fileProgressElement),document.getElementById(b).appendChild(this.fileProgressWrapper),k(this.fileProgressWrapper,0)}this.height=this.fileProgressWrapper.offsetHeight}var m=window,n=m.FS,o=a("swfupload");o.prototype.cleanUp=function(a){try{if(this.movieElement&&"unknown"==typeof a.CallFunction){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(var b in a)try{"function"==typeof a[b]&&b[0]<="Z"&&(a[b]=null)}catch(c){}}}catch(d){}window.__flash__removeCallback=function(a,b){try{a&&(a[b]=null)}catch(c){}}},l.prototype.setProgress=function(a){this.fileProgressElement.className="progressContainer green",this.fileProgressElement.childNodes[3].className="progressBarInProgress",this.fileProgressElement.childNodes[3].style.width=a+"%"},l.prototype.setComplete=function(){this.fileProgressElement.className="progressContainer blue",this.fileProgressElement.childNodes[3].className="progressBarComplete",this.fileProgressElement.childNodes[3].style.width=""},l.prototype.setError=function(){this.fileProgressElement.className="progressContainer red",this.fileProgressElement.childNodes[3].className="progressBarError",this.fileProgressElement.childNodes[3].style.width=""},l.prototype.setCancelled=function(){this.fileProgressElement.className="progressContainer",this.fileProgressElement.childNodes[3].className="progressBarError",this.fileProgressElement.childNodes[3].style.width=""},l.prototype.setStatus=function(a){this.fileProgressElement.childNodes[2].innerHTML=a},l.prototype.toggleCancel=function(a,b){if(this.fileProgressElement.childNodes[0].style.visibility=a?"visible":"hidden",b){var c=this.fileProgressID;this.fileProgressElement.childNodes[0].onclick=function(){return b.cancelUpload(c),!1}}};var p=function(a){var b,c,j,k,l=this;a=_.extend({upload_url:"#",file_post_name:"file",post_params:{},file_size_limit:0,file_upload_limit:0,file_queue_error_handler:d,file_dialog_complete_handler:e,upload_progress_handler:f,upload_total_progress_handler:n.EMPTY_FN,upload_error_handler:i,upload_success_handler:g,upload_complete_handler:h,upload_all_complete_handler:n.EMPTY_FN,button_width:18,button_height:18,button_text:'<span class="button">Select Images <span class="buttonSmall">(2 MB Max)</span></span>',button_text_style:".button { font-family: Helvetica, Arial, sans-serif; font-size: 12pt; } .buttonSmall { font-size: 10pt; }",button_text_top_padding:0,button_text_left_padding:18,button_window_mode:o.WINDOW_MODE.TRANSPARENT,button_cursor:o.CURSOR.HAND,flash_url:n.BASE_PATH+"/html/fs/assets/swfupload/swfupload.swf",custom_settings:{upload_target:"divFileProgressContainer"},debug:!1},a||{}),k=a.upload_start_handler,a.upload_start_handler=function(a){return l._updateFileStore(a),l._updateFileStore({id:a.id,uploaded:!1,uploadedSize:0}),k&&k.apply(this,arguments)},b=a.upload_progress_handler,a.upload_progress_handler=function(c,d){l._updateFileStore({id:c.id,uploadedSize:d}),b&&b.apply(this,arguments),a.upload_total_progress_handler.call(this,l.getTotalUploadedSize(),l.getTotalUploadSize())},j=a.upload_success_handler,a.upload_success_handler=function(a){return l._updateFileStore({id:a.id,uploaded:!0}),j&&j.apply(this,arguments)},c=a.upload_complete_handler,a.upload_complete_handler=function(){for(var b,d=0,e=!0;b=this.getFile(d);)(b.filestatus==o.FILE_STATUS.IN_PROGRESS||b.filestatus==o.FILE_STATUS.QUEUED)&&(e=!1),d++;c&&c.apply(this,arguments),e&&a.upload_all_complete_handler.call(this),l.totalUploadedSize=0};var m=new o(a);this.type="flash",this._files=[],this.core=m};_.extend(p.prototype,{startUpload:function(){var a=this.core;return a.startUpload.apply(a,arguments)},cancelUpload:function(){var a=this.core;return a.cancelUpload.apply(a,arguments)},removeFile:function(){return this.cancelUpload.apply(this,arguments)},removeAllFile:function(a){for(var b,c=this.core,d=0;b=c.getFile(d);)this.removeFile(b.id,a),d++},getFiles:function(a){for(var b,c=this.core,d=0,e=[];b=c.getFile(d);)a?(b.filestatus==o.FILE_STATUS.QUEUED||b.filestatus==o.FILE_STATUS.IN_PROGRESS)&&e.push(b):e.push(b),d++;return e},_updateFileStore:function(a){var b=this._files,c=!1;_.some(b,function(b){b.id==a.id&&(c=!0,_.extend(b,a))}),c||this._files.push(_.extend({},a))},_getFileFullData:function(a){var b=this._files;return _.find(b,function(b){return b.id==a})},getTotalUploadSize:function(){var a=0,b=this.getFiles();b=_.filter(b,function(a){return a.filestatus!=o.FILE_STATUS.CANCELLED});for(var c,d=0;c=b[d];d++)a+=c.size;return a},getTotalUploadedSize:function(){var a,b=0,c=this.getFiles();c=_.filter(c,function(a){return a.filestatus!=o.FILE_STATUS.CANCELLED});for(var d,e=0;d=c[e];e++)a=this._getFileFullData(d.id),a&&a.uploadedSize&&(b+=a.uploadedSize);return b},setDisable:function(a){var b=this.core;b.setButtonDisabled(a)},destroy:function(){this._files=null,this.core.destroy()}}),c.exports=p});
define("uilibs/uploader/h5uploader",["util"],function(a,b,c){var d=window,e=d.FS,f=a("util"),g=function(a){var b;if(!this.isSupport())return this;if(!(this instanceof g))return new g(a);if(a===Object(a)){for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);return this.init(),this}};_.extend(g.prototype,{multiple:!1,accept:"*.*",fileInput:null,dragDrop:null,upButton:null,url:"",fileFilter:[],timeout:120,filter:function(a){return a},onSelect:function(){},onDelete:function(){},onDragOver:function(){},onDragLeave:function(){},onProgress:function(){},onTotalProgress:function(){},onSuccess:function(){},onFailure:function(){},onComplete:function(){},onFileNotFound:function(){},funDragHover:function(a){return a.stopPropagation(),a.preventDefault(),this["dragover"===a.type?"onDragOver":"onDragLeave"].call(a.target),this},funGetFiles:function(a){this.funDragHover(a);var b=a.target.files||a.dataTransfer.files;return b=Array.prototype.slice.call(b),b=this.filter(b),this.addFile(b),this},addFile:function(a){for(var b,c=0;b=a[c];c++)b.id="h5-upload-file-"+g.fileIndex,g.fileIndex++;return this.fileFilter=this.fileFilter.concat(a),this.onSelect(a),this},removeFile:function(a){for(var b,c=[],d=0;b=this.fileFilter[d];d++)b.id!=a?c.push(b):this.onDelete(b);return this.fileFilter=c,this},removeAllFile:function(){return this.fileFilter=[],this},getFiles:function(){return this.fileFilter},startUpload:function(){var a=this,b=a.getTotalUploadSize();if(!(location.host.indexOf("sitepointstatic")>=0)){var c=this.fileFilter,d=0;c.length>0&&!function g(h){var i,j=new XMLHttpRequest,k=!1;j.upload&&(j.upload.addEventListener("progress",function(c){a.onProgress(h,c.loaded,c.total),h.uploadedSize=c.loaded,a.onTotalProgress(a.getTotalUploadedSize(),b)},!1),j.onreadystatechange=function(){if(4==j.readyState){if(200==j.status)a.onSuccess(h,j.responseText),h.uploaded=!0,d++,c[d]&&g(c[d]),a.isAllUploaded()&&a.onComplete();else if(0!==j.status||k){a.onFailure(h,j.responseText);try{window.store.set("uploaderror","xhr.status:"+j.status+";abort:"+k+";responsetext:"+j.responseText)}catch(b){}}else a.onFileNotFound(h);clearTimeout(i)}},j.open("POST",e.API_PATH+a.url,!0),j.setRequestHeader("Content-Type","multipart/form-data"),j.setRequestHeader("totalLength",h.size),j.setRequestHeader("startIndex","0"),j.setRequestHeader("storagePath",""),j.setRequestHeader("extension",f.getFileExtText(h.name)),j.send(h),a.timeout>0&&(i=setTimeout(function(){k=!0,j.abort(),a.onFailure(h,"上传超时，请重试")},1e3*a.timeout)))}(c[0])}},getTotalUploadSize:function(){for(var a,b=0,c=0;a=this.fileFilter[c];c++)b+=a.size;return b},getTotalUploadedSize:function(){for(var a,b=0,c=0;a=this.fileFilter[c];c++)a.uploadedSize&&(b+=a.uploadedSize);return b},isAllUploaded:function(){for(var a,b=!0,c=0;a=this.fileFilter[c];c++)if(!a.uploaded){b=!1;break}return b},init:function(){var a=this;this.type="h5",this.multiple&&(this.fileInput.multiple="multiple"),this.fileInput.accept=this.accept,this.dragDrop&&(this.dragDrop.addEventListener("dragover",function(b){a.funDragHover(b)},!1),this.dragDrop.addEventListener("dragleave",function(b){a.funDragHover(b)},!1),this.dragDrop.addEventListener("drop",function(b){a.funGetFiles(b)},!1)),this.fileInput&&this.fileInput.addEventListener("change",function(b){a.funGetFiles(b),$(a.fileInput).wrap("<form>").closest("form").get(0).reset(),$(a.fileInput).unwrap()},!1),this.upButton&&this.upButton.addEventListener("click",function(b){a.funUploadFile(b)},!1)},setDisable:function(a){var b=$(this.fileInput);a?b.addClass("state-disabled").prop("disabled",!0):b.removeClass("state-disabled").prop("disabled",!1)},isSupport:function(){return g.isSupport()},destroy:function(){}}),g.fileIndex=0,g.isSupport=function(){var a,b=!0;return d.XMLHttpRequest?(a=new XMLHttpRequest,b=!(!a.upload||!a.addEventListener)):b=!1,b},c.exports=g});
define("uilibs/validator",["validator_core","widget"],function(a,b,c){var d=a("validator_core"),e=a("widget"),f=[],g=d.extend({setup:function(){var a=this;this.items=[],isForm="form"==this.element.get(0).tagName.toLowerCase(),isForm&&(novalidate_old=this.element.attr("novalidate"),"noValidate"in document.createElement("form")&&this.element.attr("novalidate","novalidate"),this.get("checkOnSubmit")&&this.element.submit(function(b){b.preventDefault(),a.execute(function(b){b||a.get("autoSubmit")&&a.element.get(0).submit()})})),this.on("formValidate",function(){var a=this;$.each(this.items,function(b,c){a.query(c.element).get("hideMessage").call(a,null,c.element)})}),this.on("itemValidated",function(a,b,c){a?this.query(c).get("showMessage").call(this,b,c):this.query(c).get("hideMessage").call(this,b,c)}),this.get("autoFocus")&&this.on("formValidated",function(b,c){if(b){var d=null;$.each(c,function(a,b){var c=b[0],e=b[2];return c?(d=e,!1):void 0}),a.trigger("autoFocus",d),d.focus()}}),f.push(this)},destroy:function(){isForm&&(void 0==novalidate_old?this.element.removeAttr("novalidate"):this.element.attr("novalidate",novalidate_old),this.element.unbind("submit"));var a=this;$.each(this.items,function(b,c){a.removeItem(c)});var b;$.each(f,function(a,c){return c==this?(b=a,!1):void 0}),f.splice(b,1),e.prototype.destroy.call(this)}});c.exports=g});