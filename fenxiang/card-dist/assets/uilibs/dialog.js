define("uilibs/dialog",["dialog_core","dnd","mask","position"],function(a,b,c){var d=a("dialog_core"),e=a("dnd"),f=a("mask");a("position");var g,h=".dialog",i=[];$(function(){g=$('<div class="ui-dialog-drag-proxy"></div>'),g.css({position:"absolute",top:"-10000px",left:"-10000px"}).appendTo("body")});var j=d.extend({attrs:{enableDrag:!0,visibleWithAnimate:!1,hideWithEsc:!1},_onRenderVisible:function(a){var b=this.get("visibleWithAnimate");b?a?this.element.fadeIn(200):this.element.fadeOut(200):this.element[a?"show":"hide"]()},_onRenderZIndex:function(a){return this.get("hasMask")&&f.set("zIndex",parseInt(a,10)-1),d.superclass._onRenderZIndex.call(this,a)},_setupMask:function(){this.before("show",function(){this.get("hasMask")&&f.show()})},_setupKeyEvents:function(){var a=this,b=this.get("hideWithEsc");b&&$(document).on("keyup."+h+this.cid,function(b){27===b.keyCode&&a.get("visible")&&a.hide()})},_setPosition:function(a){var b=j.superclass._setPosition.apply(this,arguments);return a||(a=this.get("align")),"50%"==a.selfXY[0]&&"50%"==a.selfXY[1]&&"50%"==a.baseXY[0]&&"50%"==a.baseXY[1]&&this.element.position().top<0&&this.element.css("top",0),b},_setupFocus:function(){this.after("show",function(){var a=$(".auto-focus",this.element);a.length>0?a.get(0).focus():this.element.focus()}),this.after("hide",function(){this.activeTrigger&&this.activeTrigger.focus()})},render:function(){var a;return a=j.superclass.render.apply(this,arguments)},show:function(){var a,b,c=this.get("enableDrag"),d=this.element;return a=j.superclass.show.apply(this,arguments),i.push(this),this._setMaskStatus(),b=$(".ui-dialog-title",this.element),!this.dnd&&b.length>0&&c&&(this.dnd=new e(d,{drag:b,proxy:g,containment:"body"}),this.dnd.on("dragstart",function(a,c){c.width(d.width()),c.height(d.height()),b.click()})),$("textarea",this.element).each(function(){var a=$(this),b=_.str.trim(a.val()),c=a.attr("placeholder");b==c&&a.val("").trigger("autosize.resize")}),a},hide:function(){var a,b=this;return a=j.superclass.hide.apply(this,arguments),i=_.filter(i,function(a){return a!==b}),this._setMaskStatus(),a},_setMaskStatus:function(){var a=-1;_.each(i,function(b){b.get("hasMask")&&b.get("zIndex")>a&&(a=b.get("zIndex"))}),-1!=a?(f.set("zIndex",a-1),f.show()):f.hide()},destroy:function(){return this.get("trigger")&&this.get("trigger").off("click"+h+this.cid),$(document).off("keyup."+h+this.cid),this.dnd&&this.dnd.destroy(),this.element&&this.element.remove(),this._setMaskStatus(),clearInterval(this._interval),d.superclass.destroy.call(this)}});f.set("opacity",.1),j.hideAll=function(a){a?_.each(i,function(b){b.element.is(a)&&b.hide()}):_.each(i,function(a){a.hide()})},c.exports=j});