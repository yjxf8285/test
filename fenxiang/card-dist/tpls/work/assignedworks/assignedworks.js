/**
 * 纷享页面逻辑
 * @Author: 纷享网页前端部
 * @Date: 2014-11-03
 */
define("tpls/work/assignedworks/assignedworks",["util","tabs","modules/feed-list/feed-list","../work-common","moment","../work-common.html"],function(a,b){var c=window,d=c.FS,e=d.tpl,f=(e.store,e.event),g=a("util"),h=a("tabs"),i=a("modules/feed-list/feed-list"),j=a("../work-common");b.init=function(){var a,c=b.tplEl,d=b.tplName,e=$(".feed-tabs",c),k=$(".search-inp",c),l=$(".search-btn",c);j.init(c,d);var m=function(a){var b=$(a),c=b.data("feedList");c&&c.loadKill()},n=function(a,b){b=b||0,a.get("activeIndex")==b?a.trigger("switched",b,-1):a.switchTo(b)},o=null;a=new h({element:e,triggers:$(".ui-tab-item",e),panels:$(".ui-tab-panel",e),activeIndex:0,activeTriggerClass:"ui-tab-item-current",triggerType:"click"}).render(),a.on("switched",function(a){var b=this.get("panels").eq(a),c=$(".feed-list",b),d=$(".feed-list-pagination",b),e=b.data("feedList"),f=b.attr("feedworkstatus");e?e.reload():(e=new i({element:c,pagSelector:d,pagOpts:{pageSize:10,visiblePageNums:7},listPath:"/FeedWork/GetFeedWorkOfIAssigned",defaultRequestData:function(){return{feedWorkStatus:f,keyword:_.str.trim(k.val())}},searchOpts:{inputSelector:k,btnSelector:l}}),e.load(),b.data("feedList",e)),o=e}).on("switch",function(a,b){m(this.get("panels").eq(b))}),l.click(function(a){o.reload(),a.preventDefault()});var p=function(){var b=a.get("panels");b.each(function(){var a=$(this),b=a.data("feedList");b&&b.destroy(),a.removeData()})};f.one("beforeremove",function(a){a==d&&p()});var q,r;q=g.getTplQueryParams(),r=q?q.tabindex:0,n(a,r)}});