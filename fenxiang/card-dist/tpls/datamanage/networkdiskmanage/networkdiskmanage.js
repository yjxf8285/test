/**
 * 纷享页面逻辑
 * @Author: 纷享网页前端部
 * @Date: 2014-11-03
 */
define("tpls/datamanage/networkdiskmanage/networkdiskmanage",["util","moment"],function(a,b){var c=window,d=c.FS;d.tpl;var e=a("util"),f=a("moment");b.init=function(){b.tplName;var a=b.tplEl,c=$(".networkdiskmanage-liketable .liketable-body",a),d=$(".networkdiskmanage-liketable .liketable-footer",a),g=function(a){var b="",c="",d=a.directorys||[];return _.each(d,function(a){a.isPublic;var d=a.isReadOnly,g=a.name,h=a.nDDirectoryID,i=e.getFileSize(a.directorySpace)||"0 B",j=a.creator.name,k=a.createTime;c=d?"lock":"";var l=f.unix(k).format("YYYY年MMMDD日 HH:mm");b+='<div class="liketable-tr fn-clear" data-dirid="'+h+'"><div class="liketable-td first">&nbsp;</div><div class="liketable-td font-hgray file-name"><span class="ico '+c+'"></span>'+g+'</div><div class="liketable-td size">'+i+'</div><div class="liketable-td name" >'+j+'</div><div class="liketable-td data">'+l+'</div><div class="liketable-td del"> <a href="javascript:;" class="j-del">删除</a></div></div>'}),b},h=function(){e.api({url:"/Management/GetNDDirectoryInfos",type:"get",dataType:"json",data:{},success:function(a){var b=a.value||{},e=b.directorys.length||0;a.success&&(c.html(g(b)),d.text("状态：文件夹总数"+e+"个"))}})};h(),$(".j-del",c),c.on("click",".j-del",function(){var a=$(this).closest(".liketable-tr"),b=a.data("dirid");e.confirm("是否确定删除该文件夹？删除文件夹同时删除文件夹下所有内容。","提示",function(){e.api({url:"/Management/DeleteNDDirectory",type:"post",dataType:"json",data:{directoryID:b},success:function(b){b.success&&a.remove()}})})});var i=$(".networkdiskmanage-liketable",a);i.on("click",".liketable-body .liketable-tr",function(){var a=$(this);$(".liketable-body .liketable-tr",i).removeClass("cur"),a.addClass("cur")}),e.regTplNav($(".tpl-l .flag-left-list a",a),"fl-item-on")}});