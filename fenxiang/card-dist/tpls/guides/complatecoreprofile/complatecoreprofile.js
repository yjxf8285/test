/**
 * 纷享页面逻辑
 * @Author: 纷享网页前端部
 * @Date: 2014-11-03
 */
define("tpls/guides/complatecoreprofile/complatecoreprofile",["tabs","util","../guides-common"],function(a,b){var c=window,d=c.FS,e=d.tpl;e.event;var f=(a("tabs"),a("util")),g=a("../guides-common");b.init=function(){var a=b.tplEl,c=b.tplName,d=$(".settings-input",a),e=$(".resetpassword-form",a),h=$(".settings-input",e);e.on("click",".settings-input",function(a){var b=$(this);h.each(function(){var a=$(this);a.removeClass("settings-input-on"),a.next().hide()}),b.removeClass("settings-input-onerror"),b.nextAll(".settings-input-error").hide(),b.addClass("settings-input-on"),b.next().show(),b.next(".settings-input-prompt").show(),a.stopPropagation()}),f.regGlobalClick(h,function(){h.each(function(){var a=$(this);a.removeClass("settings-input-on"),a.next().hide()})});var i=$("#user-fullname",a);i.blur(function(){var a=$(this);""==_.str.trim(a.val())?(d.next(".settings-input-prompt").hide(),a.addClass("settings-input-onerror"),a.nextAll(".settings-input-error").show()):(a.removeClass("settings-input-onerror"),a.nextAll(".settings-input-error").hide())});var j=$(".pwd-save-btn",a);j.click(function(b){var d=_.str.trim($("#user-fullname",a).val()),e=_.str.trim($("#user-department",a).val()),h=_.str.trim($("#user-post",a).val()),i=$("#s-sex-male"),j=$("#s-sex-female"),k="";i.is(":checked")?k="M":j.is(":checked")&&(k="F");var l=!0;$(".settings-input",a).blur(),$(".settings-input",a).each(function(){return $(this).hasClass("settings-input-onerror")?(l=!1,!1):void 0}),l&&f.api({type:"post",data:{fullName:d,name:d,department:e,post:h,gender:k},url:"/account/UpdateCurrentUser",success:function(b){b.success&&(g.saveSuccessAnimated(a,c),location.reload())}}),b.preventDefault()}),g.init(a,c)}});