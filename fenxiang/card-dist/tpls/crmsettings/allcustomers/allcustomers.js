/**
 * 纷享页面逻辑
 * @Author: 纷享网页前端部
 * @Date: 2014-11-03
 */
define("tpls/crmsettings/allcustomers/allcustomers",["util","../settings-common","dialog","modules/crm-high-seas/crm-high-seas","../settings-common.html","../settings-common.css","modules/crm-list-header/crm-list-header","modules/crm-customer-list-all/crm-customer-list-all","modules/crm-customer-add/crm-customer-add","modules/crm-object-import/crm-object-import","modules/crm-customer-export/crm-customer-export","modules/crm-select-colleague/crm-select-colleague"],function(a,b){var c=window,d=c.FS,e=d.tpl;e.event,a("util");var f=a("../settings-common"),g=a("modules/crm-list-header/crm-list-header"),h=a("modules/crm-customer-list-all/crm-customer-list-all"),i=a("modules/crm-customer-add/crm-customer-add"),j=a("modules/crm-object-import/crm-object-import"),k=a("modules/crm-customer-export/crm-customer-export"),l=a("modules/crm-select-colleague/crm-select-colleague");b.init=function(){var a,c,d=b.tplEl,e=b.tplName,m=null,n=null,o=null,p=null,q=$(".crm-crmsettings-filterinfo",d),r={employeeID:-1,keyword:"",isFirstChar:!1,pageNumber:1,pageSize:15,queryType:1};f.createCrmSettingLeftNav(d,e);var s=function(){c=new g({element:$(".crm-list-hd",d),title:"全部客户",searchPlaceholder:"搜索客户、客户编号"}),c.on("search",function(b){a.refresh({keyword:b})})},t=function(){a=new h({element:$(".list-warp",d)}),a.on("refreshed",function(a){c&&c.setCount(a)}),a.refresh(r)},u=function(){m||(m=new i({inSetting:!0}),m.on("success",function(){a.refresh(r)}))},v=function(){o||(o=new j({title:"客户导入",downloadApi:"GetAllFCustomerExcelTemplate",importApi:"/FCustomer/ImportAllFCustomers",downloadText:"客户导入模板"}),o.on("uploaded",function(){a.refresh(r)}))},w=function(){n||(n=new k({title:"全部客户导出",hasBelongTo:!0,isMulti:!0,exportApi:"/FCustomer/ExportAllFCustomersExcel"}))},x=function(){p||(p=new l({isMultiSelect:!1,hasWorkLeaveBtn:!0,title:"选择员工"}),p.on("selected",function(b){r.employeeID=b.employeeID,q.find("span").text(b.name),q.show(),a.refresh(r)}))},y=function(){$(".create-customer-btn",d).on("click",function(){m.show()}),$(".customer-import",d).on("click",function(){o.show()}),$(".customer-export",d).on("click",function(){n.show()}),$(".crm-allcustomers-fliter",d).on("click",function(){p.show()}),q.find("a").on("click",function(){r.employeeID=-1,a.refresh(r),q.hide()})};!function(){s(),t(),u(),v(),w(),x(),y()}()}});