/**
 * 纷享页面逻辑
 * @Author: 纷享网页前端部
 * @Date: 2014-11-03
 */
define("tpls/crmsettings/allcontacts/allcontacts",["util","../settings-common","dialog","modules/crm-high-seas/crm-high-seas","../settings-common.html","../settings-common.css","modules/crm-list-header/crm-list-header","modules/crm-contact-list/crm-contact-list","modules/crm-object-import/crm-object-import","modules/crm-contact-export/crm-contact-export","modules/crm-select-colleague/crm-select-colleague","modules/crm-contact-view/crm-contact-view"],function(a,b){var c=window,d=c.FS,e=d.tpl;e.event,a("util");var f=a("../settings-common"),g=a("modules/crm-list-header/crm-list-header"),h=a("modules/crm-contact-list/crm-contact-list"),i=a("modules/crm-object-import/crm-object-import"),j=a("modules/crm-contact-export/crm-contact-export"),k=a("modules/crm-select-colleague/crm-select-colleague"),l=a("modules/crm-contact-view/crm-contact-view");b.init=function(){var a=b.tplEl,c=b.tplName,d=null,e=null,m=null,n=null,o=null,p=$(".crm-crmsettings-filterinfo",a),q={employeeID:0,keyword:"",isFirstChar:!1,isDeleted:0,createCustomer:-1,sortType:12,isContainSubordinate:-1,pageSize:25,pageNumber:1},r=function(){var b=new g({element:$(".crm-list-hd",a),title:"全部联系人",searchPlaceholder:"搜索联系人"});b.on("search",function(a){o.refresh({keyword:a})})},s=function(){o=new h({data:q,warpEl:$(".list-warp",a),url:"/Contact/GetAllContacts",overwriteRowClick:!0,isSetting:!0}),o.on("rowClick",function(a){m&&m.show({contactID:a})}),o.load(),o.refresh(),$(".top-fn-btns",a).hide()},t=function(){e||(e=new i({title:"联系人导入",downloadApi:"GetAllContactExcelTemplate",importApi:"/Contact/ImportAllContact",downloadText:"联系人导入模板"}),e.on("uploaded",function(){o.refresh(q)}))},u=function(){d||(d=new j({title:"全部联系人导出",isAll:!0}))},v=function(){n||(n=new k({isMultiSelect:!1,hasWorkLeaveBtn:!0,title:"选择员工"}),n.on("selected",function(a){q.employeeID=a.employeeID,p.find("span").text(a.name),p.show(),o.refresh(q)}))},w=function(){m=new l},x=function(){$(".contacts-import",a).on("click",function(){e.show()}),$(".contacts-export",a).on("click",function(){d.show()}),$(".crm-allcontacts-fliter",a).on("click",function(){n.show()}),p.find("a").on("click",function(){q.employeeID=-1,o.refresh(q),p.hide()})};f.createCrmSettingLeftNav(a,c),!function(){r(),s(),t(),u(),v(),w(),x()}()}});