/**
 * 纷享模块逻辑
 * @Author: 纷享网页前端部
 * @Date: 2014-11-03
 */
define("modules/crm-subordinate-select/crm-subordinate-select",["util","widget","modules/crm-subordinate-select/crm-subordinate-select.html","modules/crm-select-colleague/crm-select-colleague"],function(a,b,c){var d=window,e=(d.FS,a("util")),f=a("widget"),g=a("modules/crm-subordinate-select/crm-subordinate-select.html"),h=a("modules/crm-select-colleague/crm-select-colleague"),i=f.extend({attrs:{element:null,imageSrc:"",employeeName:"",employeeID:e.getCrmData().currentEmp.employeeID,selectColleague:null,canSelect:!0,selectedEmployeeID:0},events:{"click .crm-subordinate-select-container":"_showSelecter"},setup:function(){var a=i.superclass.render.apply(this,arguments);return this._init(),a},_init:function(){this.element.html(g),this.set("selectedEmployeeID",this.get("employeeID")),this._setHtml(),this._initSelectColleague()},reset:function(a){this.set("imageSrc",e.getAvatarLink(a.profileImage,"2")),this.set("employeeName",a.employeeName),this._setHtml()},_initSelectColleague:function(){var a=this,b=new h({isMultiSelect:!1,hasWorkLeaveBtn:!1,defaultCondition:{queryType:5},title:"选择我或下属"});b.on("selected",function(b){a.set("imageSrc",e.getAvatarLink(b.profileImage,"2")),a.set("employeeName",b.name),a.set("selectedEmployeeID",b.employeeID),a._setHtml(),a.trigger("selected",b)}),a.set("selectColleague",b)},_setHtml:function(){var a=this.get("imageSrc"),b=this.get("employeeName");this.get("employeeID"),$(".crm-subordinate-select-image",this.element).attr("src",a),$(".crm-subordinate-select-name",this.element).text(b),$(".crm-subordinate-select-name",this.element).attr("title",b),this.get("canSelect")||($(".crm-subordinate-select-guide",this.element).hide(),$(".crm-subordinate-select-container",this.element).addClass("crm-subordinate-select-disable"))},_showSelecter:function(){if(this.get("canSelect")){var a=this.get("selectColleague");this.get("employeeID")==this.get("selectedEmployeeID")?a.set("condition",{queryType:2,exceptEmployeeIDs:this.get("selectedEmployeeID")}):a.set("condition",{queryType:5,exceptEmployeeIDs:this.get("selectedEmployeeID")}),a.show()}}});c.exports=i});